# خطة تعديلات الوضع الفاتح — منظمّة (سينيور فرونت إند)

## تشخيص الخلل من الصور والكود

### 1. عدم اتساق الثيم (أكبر خلل)
- **الترويسة:** تبقى بخلفية داكنة ونص أبيض حتى في الوضع الفاتح (الـ `.glass` يُطبَّق لكن المحتوى الداخلي يستخدم `text-white`).
- **جدول الملخص الرئيسي:** الحاوية `section` تستخدم `bg-gradient-to-br from-slate-900/80 via-slate-800/60 to-slate-900/80` — ثابتة داكنة.
- **رؤوس الجدول:** كل `<th>` وصفوف الرؤوس تستخدم `bg-slate-900/60` و`text-slate-400` / `text-cyan-400` — لا أوفرايد للوضع الفاتح.
- **شريط الفلاتر (الكل / الكورنيش / الأندلس):** إن وُجد بخلفية داكنة ثابتة فيجب ربطها بالثيم.
- **النوافذ المنبثقة (Modals):** كلها تستخدم `bg-slate-900/98` و`border-slate-700/60` و`bg-slate-800/50` و`bg-slate-800` للحقول — لا تتبدل في الوضع الفاتح.

### 2. تباين منخفض في الوضع الفاتح
- **نصوص ثانوية:** `text-slate-400`, `text-slate-500`, `text-slate-300` على خلفية فاتحة تصبح غير مقروءة.
- **تبويبات غير نشطة:** "الفترات المغلقة"، "الإحصائيات" في Rewards — لون باهت على خلفية فاتحة.
- **أزرار ثانوية:** "نسخ"، "اختبار"، "إعادة توليد" في modal إدارة الإداريين — خلفيات وألوان باهتة.
- **Placeholders وحقول الإدخال:** لون النص والحدود في الـ modals مبني على ألوان داكنة فقط.
- **تسميات/شارات (Badges) داخل الجدول:** أخضر فاتح، أحمر فاتح، أزرق فاتح — تباين ضعيف على خلفية فاتحة.

### 3. ألوان ثابتة (Hardcoded) غير مربوطة بالثيم
- **React (App.tsx وغيرها):**
  - `bg-slate-900/98`, `bg-slate-900/95`, `border-slate-700/60`, `bg-slate-800`, `bg-slate-800/50`, `bg-slate-800/40`
  - `text-white`, `text-slate-200`, `text-slate-300`, `text-slate-400`, `text-slate-500`, `text-cyan-400`, `text-cyan-300`
  - `border-white/20`, `border-white/15`, `border-white/10`, `border-white/[0.06]`
  - Section الجدول: `from-slate-900/80 via-slate-800/60 to-slate-900/80`
  - رؤوس الجدول: `bg-slate-900/60`, `border-white/[0.06]`
- **Rewards (app.js + styles.css):**
  - عشرات الاستخدامات لـ `bg-slate-900`, `text-white`, `border-white` في الـ HTML المُنشأ والـ CSS.

### 4. الـ Scrollbar
- في الوضع الفاتح الـ scrollbar يبقى بلون داكن في بعض الصفحات — التأكد من أن جميع المسارات (React + Rewards) تستخدم `var(--adora-scrollbar-*)`.

### 5. الـ Glassmorphism في الوضع الفاتح
- `.glass` له أوفرايد في `[data-theme="light"]` — جيد.
- حدود `border-white/20` على حاويات إضافية (modals، بطاقات) تبقى بيضاء شفافة فتفقد الوضوح على خلفية فاتحة — يجب استبدالها بـ `var(--adora-border)` أو أوفرايدات صريحة للوضع الفاتح.

---

## خطة التنفيذ المرحلية

### المرحلة 0: تحضير متغيرات إضافية (اختياري لكن مفيد)
- **الملف:** `app/src/index.css` و `app/Rewards/src/styles.css`
- إضافة متغيرات إن لزم:
  - `--adora-modal-bg`، `--adora-modal-header-bg`، `--adora-input-bg`، `--adora-table-header-bg`
- تعريفها في `:root` و`[data-theme="light"]` حتى نستبدل كل الخلفيات الثابتة للـ modals والجدول والحقول.

### المرحلة 1: الخلفيات والنصوص العامة (أولوية عالية)
| # | المهمة | الملف | الإجراء |
|---|--------|-------|---------|
| 1.1 | حاوية جدول الملخص (section) | App.tsx | استبدال `bg-gradient-to-br from-slate-900/80 via-slate-800/60 to-slate-900/80` بكلاسات تستخدم متغيرات ثيم أو إضافة أوفرايد في index.css لـ `.app-summary-table` أو حاوية معينة (مثلاً class مثل `summary-section`) بحيث في `[data-theme="light"]` الخلفية فاتحة. |
| 1.2 | رؤوس الجدول (thead th) | App.tsx | استبدال `bg-slate-900/60` بـ خلفية من متغير (مثلاً `bg-[var(--adora-table-header-bg)]`) وتعريف `--adora-table-header-bg` في الثيم الفاتح بلون فاتح. |
| 1.3 | نصوص الرؤوس والصفوف | App.tsx | استبدال `text-white/90`, `text-slate-400`, `text-slate-500` في منطقة الجدول بـ `text-[var(--adora-text)]` و `text-[var(--adora-text-secondary)]` حيث مناسب. |
| 1.4 | حدود الجدول | App.tsx + index.css | استبدال `border-white/[0.06]` بـ `border-[var(--adora-border)]` وإضافة أوفرايدات لـ `[data-theme="light"]` إن لزم. |

### المرحلة 2: النوافذ المنبثقة (Modals)
| # | المهمة | الملف | الإجراء |
|---|--------|-------|---------|
| 2.1 | إعدادات التحليل | App.tsx | الحاوية: استبدال `bg-slate-900/98 border border-slate-700/60` بـ خلفية وحد من متغيرات (مثلاً `bg-[var(--adora-modal-bg)] border-[var(--adora-border)]`). الهيدر: استبدال `bg-slate-800/50 border-slate-700/50` و `text-white` بمتغيرات. |
| 2.2 | حقول الإدخال داخل الإعدادات | App.tsx | استبدال `bg-slate-800 border border-slate-700 text-slate-200` بـ `bg-[var(--adora-input-bg)] border-[var(--adora-border)] text-[var(--adora-text)]` وتعريف المتغيرات للوضع الفاتح. |
| 2.3 | نصوص تفسيرية (labels، توضيحات) | App.tsx | استبدال `text-slate-400`, `text-slate-500`, `text-slate-600` بـ `var(--adora-text-secondary)` أو لون مناسب للوضع الفاتح. |
| 2.4 | باقي الـ Modals | App.tsx | نفس المنطق لـ: منهجية التحليل، شروط المكافآت، كيفية حساب التقييم، إدارة الخصومات، إدارة الإداريين، أي modal آخر يستخدم `bg-slate-900/98` أو `bg-slate-800`. |
| 2.5 | زر الإلغاء وروابط "استعادة الافتراضي" | App.tsx | ضمان استخدام لون واضح في الوضع الفاتح (مثلاً `text-[var(--adora-text-secondary)]` مع hover أوفرايد). |

### المرحلة 3: البطاقات وشريط الإحصائيات
| # | المهمة | الملف | الإجراء |
|---|--------|-------|---------|
| 3.1 | بطاقات الملخص (الأكثر حجوزات، إلخ) | App.tsx | التأكد أن الخلفية من `.glass` أو متغير؛ النصوص والعناوين الصغيرة استخدام `var(--adora-text)` و `var(--adora-text-secondary)` مع تباين كافٍ في الوضع الفاتح. |
| 3.2 | أيقونات وأرقام ملونة داخل البطاقات | App.tsx | مراجعة ألوان التمييز (تركواز، أحمر، برتقالي) واستخدام `--adora-success`, `--adora-warning`, `--adora-error` أو أوفرايدات للوضع الفاتح لضمان وضوح دون "عمى". |

### المرحلة 4: التسميات والشارات (Badges/Tags) داخل الجدول
| # | المهمة | الملف | الإجراء |
|---|--------|-------|---------|
| 4.1 | ألوان الخلفية والنص للشارات | App.tsx | استبدال خلفيات مثل `bg-cyan-500/10`, `bg-red-500/10`, `bg-amber-500/10` ونصوص مثل `text-cyan-400`, `text-red-400` بألوان من متغيرات ثيم أو أوفرايدات `[data-theme="light"]` (خلفية أغمق قليلاً أو نص أوضح) لتحسين التباين. |
| 4.2 | حدود الشارات | App.tsx | توحيد الحدود مع `var(--adora-border)` أو لون دلالي مناسب للوضع الفاتح. |

### المرحلة 5: الترويسة (Header)
| # | المهمة | الملف | الإجراء |
|---|--------|-------|---------|
| 5.1 | عنوان الترويسة ونص الفترة | App.tsx | استبدال `text-white` و `text-gray-300` بـ `text-[var(--adora-text)]` و `text-[var(--adora-text-secondary)]` حتى تتبدل في الوضع الفاتح. |
| 5.2 | أزرار الترويسة | action-header-buttons.css | تم جزئياً؛ مراجعة أي بقايا ألوان ثابتة وضمان أوفرايدات كاملة لـ `[data-theme="light"]`. |

### المرحلة 6: تطبيق Rewards
| # | المهمة | الملف | الإجراء |
|---|--------|-------|---------|
| 6.1 | خلفية الصفحة والـ glass | Rewards/styles.css | التأكد أن `body` و `.glass` يستخدمان المتغيرات وأن أوفرايدات `[data-theme="light"]` مطبّقة على كل المسارات. |
| 6.2 | التبويبات (التقارير الحالية، الفترات المغلقة، الإحصائيات) | Rewards (HTML/JS) | ربط لون التبويب النشط وغير النشط بـ `--adora-accent` و `--adora-text-secondary` مع تباين كافٍ. |
| 6.3 | جدول الإحصائيات ورؤوس الجدول | Rewards | استبدال خلفيات ورؤوس الجدول الداكنة بمتغيرات ثيم. |
| 6.4 | حقول البحث والأزرار الثانوية | Rewards | placeholder ولون أيقونة البحث وأزرار "نسخ"/"اختبار" بـ متغيرات ثيم. |
| 6.5 | الـ Scrollbar | Rewards/styles.css | التأكد أن تعريف الـ scrollbar يستخدم `var(--adora-scrollbar-*)` في كل الثيمات. |
| 6.6 | مراجعة شاملة لألوان ثابتة | app.js + app-extensions.js | بحث عن `bg-slate-900`, `text-white`, `border-white` واستبدالها بمتغيرات أو كلاسات مخصّصة للثيم. |

### المرحلة 7: التحقق النهائي
| # | المهمة | الإجراء |
|---|--------|---------|
| 7.1 | عدم وميض (FOUC) | التأكد أن سكربت الـ head يطبّق الثيم قبل أول رسم. |
| 7.2 | عدم اهتزاز (layout shift) | ثبات `border-width` وألوان الـ scrollbar؛ عدم إزالة الحدود بل تغيير اللون فقط. |
| 7.3 | استمرار الثيم بعد الدخول | عدم إعادة تعيين الثيم عند الانتقال بين التحليل والمكافآت. |
| 7.4 | البناء والـ Lint | تشغيل `npm run sync:rewards` و `npm run build` و `read_lints` على الملفات المعدّلة. |

---

## ملخص الملفات المتوقّع المساس بها

| الملف | التعديلات المتوقّعة |
|-------|----------------------|
| `app/src/index.css` | إضافة متغيرات اختيارية (modal, table header, input bg)؛ أوفرايدات إضافية لـ `[data-theme="light"]` للجدول والـ modals إن استخدمت كلاسات مشتركة. |
| `app/src/App.tsx` | استبدال كل الخلفيات والنصوص الثابتة في: حاوية جدول الملخص، thead، الـ modals (إعدادات، منهجية، شروط، تقييم، خصومات، إداريين)، الترويسة، البطاقات. |
| `app/shared/action-header-buttons.css` | مراجعة أوفرايدات الوضع الفاتح. |
| `app/Rewards/src/styles.css` | متغيرات إضافية إن لزم؛ أوفرايدات للتبويبات والجدول والـ inputs. |
| `app/Rewards/src/app.js` | استبدال ألوان ثابتة في الـ HTML المُنشأ بمتغيرات أو كلاسات ثيم. |
| `app/Rewards/src/app-extensions.js` | نفس المراجعة لألوان ثابتة. |

---

## ترتيب التنفيذ المقترح

1. **المرحلة 0 + 1** — متغيرات إضافية + جدول الملخص الرئيسي (أكبر منطقة مرئية).
2. **المرحلة 2** — كل الـ Modals (إعدادات، منهجية، شروط، تقييم، خصومات، إداريين).
3. **المرحلة 3 + 4** — البطاقات والشارات داخل الجدول.
4. **المرحلة 5** — الترويسة.
5. **المرحلة 6** — Rewards بالكامل.
6. **المرحلة 7** — التحقق والبناء.

لا تنفيذ لأي مرحلة قبل الموافقة إن رغبت بذلك. يمكن تنفيذ مرحلة واحدة في كل مرة والتحقق بعدها.
