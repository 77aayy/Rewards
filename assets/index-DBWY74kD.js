const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/firebase-cj8VFPmH.js","assets/firebase-9IY3dGcQ.js","assets/vendor-react-B6Cri9UH.js","assets/react-table-d7gCnYCw.js"])))=>i.map(i=>d[i]);
import{r as y,j as e,a as wr,c as kr}from"./vendor-react-B6Cri9UH.js";import{o as Sr,s as Cr,b as Mr,a as Dr,c as jt,d as Er,g as Rr,e as Tr,i as _r,f as Ir}from"./firebase-9IY3dGcQ.js";import{c as Ar,u as Pr,f as ia,g as $r,a as Lr,b as Fr,d as Br}from"./react-table-d7gCnYCw.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const Or="modulepreload",Vr=function(a){return"/Rewards/"+a},ca={},Le=function(t,n,l){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),b=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=Vr(u),u in ca)return;ca[u]=!0;const h=u.endsWith(".css"),g=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const N=document.createElement("link");if(N.rel=h?"stylesheet":Or,h||(N.as="script"),N.crossOrigin="",N.href=u,b&&N.setAttribute("nonce",b),document.head.appendChild(N),h)return new Promise((M,_)=>{N.addEventListener("load",M),N.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(c){const b=new Event("vite:preloadError",{cancelable:!0});if(b.payload=c,window.dispatchEvent(b),!b.defaultPrevented)throw c}return s.then(c=>{for(const b of c||[])b.status==="rejected"&&i(b.reason);return t().catch(i)})};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=(...a)=>a.filter((t,n,l)=>!!t&&t.trim()!==""&&l.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,l)=>l?l.toUpperCase():n.toLowerCase());/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=a=>{const t=Ur(a);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=a=>{for(const t in a)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=y.forwardRef(({color:a="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:s="",children:i,iconNode:c,...b},u)=>y.createElement("svg",{ref:u,...qr,width:t,height:t,stroke:a,strokeWidth:l?Number(n)*24/Number(t):n,className:Da("lucide",s),...!i&&!Hr(b)&&{"aria-hidden":"true"},...b},[...c.map(([h,g])=>y.createElement(h,g)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=(a,t)=>{const n=y.forwardRef(({className:l,...s},i)=>y.createElement(Gr,{ref:i,iconNode:t,className:Da(`lucide-${zr(da(a))}`,`lucide-${a}`,l),...s}));return n.displayName=da(a),n};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],Wr=V("arrow-up-down",Kr);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ct=V("chart-column",Yr);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ee=V("chevron-down",Jr);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Zr=V("chevron-left",Xr);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],es=V("chevron-right",Qr);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],dt=V("chevron-up",ts);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Mt=V("circle-check",as);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.721a10 10 0 0 1 2.69 2.7",key:"1iw5b2"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.279 17.609a10 10 0 0 1-2.7 2.69",key:"1ruxm7"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"M6.391 20.279a10 10 0 0 1-2.69-2.7",key:"1fvljs"}]],ss=V("circle-dashed",rs);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Dt=V("crown",ns);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],xa=V("file-spreadsheet",os);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ea=V("file-text",ls);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],cs=V("folder-up",is);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ra=V("info",ds);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],ms=V("link-2",xs);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ma=V("loader-circle",ps);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]],hs=V("lock-keyhole",us);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],bs=V("mail",gs);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],Ta=V("moon",fs);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ys=V("play",vs);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],pa=V("plus",js);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],At=V("printer",Ns);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],_a=V("rotate-ccw",ws);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ua=V("search",ks);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ha=V("send",Ss);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Pt=V("settings",Cs);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ia=V("shield-check",Ms);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]],Es=V("shield-off",Ds);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Ts=V("sun",Rs);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Et=V("trash-2",_s);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],mt=V("trending-down",Is);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ga=V("triangle-alert",As);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ba=V("upload",Ps);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ls=V("users",$s);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Te=V("x",Fs),Aa="adora_theme",Pa=["dark","light"];function Je(){if(typeof window>"u")return"dark";const a=localStorage.getItem(Aa);return Pa.includes(a)?a:window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}function $a(a){(typeof a!="string"||!Pa.includes(a))&&(a=Je());try{localStorage.setItem(Aa,a)}catch{}typeof document<"u"&&document.documentElement&&document.documentElement.setAttribute("data-theme",a)}function La(){const a=Je()==="dark"?"light":"dark";return $a(a),a}typeof window<"u"&&(window.AdoraTheme={getTheme:Je,applyTheme:$a,toggleTheme:La});const Fe={apiKey:"AIzaSyAKpUAnc_EJXxGrhPPfTAgnFB13Qvs_ogk",authDomain:"rewards-63e43.firebaseapp.com",projectId:"rewards-63e43",storageBucket:"rewards-63e43.firebasestorage.app",messagingSenderId:"453256410249",appId:"1:453256410249:web:b7edd6afe3922c3e738258"},fa={BASE_URL:"/Rewards/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function we(a,t){const n=typeof import.meta<"u"&&fa&&fa[a];return typeof n=="string"&&n.trim()?n.trim():t}const Bs=we("VITE_ADMIN_SECRET_KEY",""),Os=(()=>{const a=we("VITE_ADMIN_ALLOWED_EMAILS","");return a?a.split(",").map(t=>t.trim()).filter(Boolean):[]})(),ot="adora_admin_auth_session",Nt="adora_admin_last_email",wt="adora-admin-auth",Vs={apiKey:we("VITE_FIREBASE_API_KEY",Fe.apiKey),authDomain:we("VITE_FIREBASE_AUTH_DOMAIN",Fe.authDomain),projectId:we("VITE_FIREBASE_PROJECT_ID",Fe.projectId),storageBucket:we("VITE_FIREBASE_STORAGE_BUCKET",Fe.storageBucket),messagingSenderId:we("VITE_FIREBASE_MESSAGING_SENDER_ID",Fe.messagingSenderId),appId:we("VITE_FIREBASE_APP_ID",Fe.appId)},zs=a=>/[\u0600-\u06FF]/.test(a);function Us({gateKey:a,setGateKey:t,onSubmit:n}){const[l,s]=y.useState(!1),[i,c]=y.useState(!1),b=y.useCallback(N=>{var _;const M=(_=N.getModifierState)==null?void 0:_.call(N,"CapsLock");s(!!M),M&&c(!0)},[]),u=y.useCallback(N=>{var M;s(!!((M=N.getModifierState)!=null&&M.call(N,"CapsLock")))},[]),h=y.useCallback(N=>{t(N.target.value)},[t]),g=zs(a);return e.jsx("div",{dir:"rtl",className:"min-h-screen relative flex items-center justify-center px-4 py-8 bg-[var(--adora-bg)]",children:e.jsxs("div",{className:"relative w-full max-w-md rounded-[28px] overflow-hidden shadow-[0_20px_60px_rgba(0,0,0,0.12)] bg-[var(--adora-bg-card)] border border-[var(--adora-border)] p-6 sm:p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("img",{src:"/rewards/unnamed.png",alt:"إليت",className:"w-14 h-14 sm:w-16 sm:h-16 object-contain rounded-lg mx-auto mb-3",onError:N=>{N.target.style.display="none"}}),e.jsx("h2",{className:"text-xl font-black text-[var(--adora-text)] mb-2",children:"بوابة الإدارة"}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)]",children:"أدخل مفتاح الدخول ثم ستظهر لك صفحة تسجيل الدخول (البريد وكلمة المرور)."})]}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"مفتاح بوابة الإدارة"}),e.jsx("input",{type:"text",dir:"ltr",autoComplete:"off",value:a,onChange:h,onKeyDown:b,onKeyUp:u,onBlur:()=>c(!1),placeholder:"أدخل المفتاح",className:"w-full px-4 py-3 rounded-xl bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] placeholder:text-[var(--adora-text-secondary)] focus:outline-none focus:border-[var(--adora-accent)] focus:ring-2 focus:ring-[var(--adora-focus-border)] transition-all"}),i&&l&&e.jsxs("p",{className:"mt-1.5 text-[var(--adora-warning)] text-sm flex items-center gap-1.5",role:"alert",children:[e.jsx("span",{"aria-hidden":!0,children:"⚠️"}),e.jsx("span",{children:"الكابتل لوك (Caps Lock) مفعّل — قد يكون المفتاح بحروف صغيرة."})]}),g&&e.jsxs("p",{className:"mt-1.5 text-[var(--adora-warning)] text-sm flex items-center gap-1.5",role:"alert",children:[e.jsx("span",{"aria-hidden":!0,children:"⚠️"}),e.jsx("span",{children:"يبدو أنك أدخلت حروفاً عربية. المفتاح عادة بالإنجليزي من الرابط."})]})]}),e.jsx("button",{type:"submit",className:"w-full py-3.5 rounded-xl font-bold bg-[var(--adora-accent)] hover:opacity-90 text-white shadow-md transition-all",children:"دخول"})]})]})})}function qs({loginEmail:a,onLoginEmailChange:t,loginPassword:n,setLoginPassword:l,showPassword:s,setShowPassword:i,loginEmailWarning:c,authError:b,loginLoading:u,onSubmit:h,showReset:g,onOpenReset:N,resetEmail:M,resetEmailWarning:_,resetStatus:A,onResetPassword:S}){return e.jsx("div",{dir:"rtl",className:"min-h-screen relative flex items-center justify-center px-4 py-8 bg-[var(--adora-bg)]",children:e.jsx("div",{className:"relative w-full max-w-5xl rounded-[28px] overflow-hidden shadow-[0_20px_60px_rgba(0,0,0,0.12)] bg-[var(--adora-bg-card)] border border-[var(--adora-border)]",children:e.jsxs("div",{className:"relative grid grid-cols-1 lg:grid-cols-2 min-h-[620px]",children:[e.jsx("div",{className:"flex items-center justify-center p-6 sm:p-10 order-2 lg:order-2",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex flex-shrink-0 items-center justify-center mb-3",children:e.jsx("img",{src:"/rewards/unnamed.png",alt:"إليت",className:"w-16 h-16 sm:w-[5.2rem] sm:h-[5.2rem] object-contain rounded-lg",style:{maxWidth:"104px",maxHeight:"104px"},onError:w=>{w.target.style.display="none"}})}),e.jsx("h3",{className:"text-2xl sm:text-3xl font-black text-[var(--adora-text)] mb-2",children:"تسجيل دخول الأدمن"}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)]",children:"استخدم بريد الإدارة للوصول للنظام"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] mr-1",children:"البريد الإلكتروني"}),e.jsxs("div",{className:"relative",children:[e.jsx(bs,{className:"w-4 h-4 text-[var(--adora-text-secondary)] absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"}),e.jsx("input",{type:"email",value:a,onChange:w=>t(w.target.value,"login"),onKeyDown:w=>{w.key==="Enter"&&h()},onPaste:w=>{w.preventDefault();const O=w.clipboardData.getData("text");t(O,"login")},placeholder:"admin@elite.com",autoComplete:"email",className:"w-full pr-10 pl-3 py-3 rounded-xl bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] placeholder:text-[var(--adora-text-secondary)] focus:outline-none focus:border-[var(--adora-accent)] focus:ring-2 focus:ring-[var(--adora-focus-border)] transition-all"})]}),c&&e.jsx("div",{className:"text-[15px] text-[var(--adora-warning)] px-1",children:c})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] mr-1",children:"كلمة المرور"}),e.jsxs("div",{className:"relative",children:[e.jsx(hs,{className:"w-4 h-4 text-[var(--adora-text-secondary)] absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none"}),e.jsx("input",{type:s?"text":"password",value:n,onChange:w=>l(w.target.value),onKeyDown:w=>{w.key==="Enter"&&h()},placeholder:"••••••••",autoComplete:"current-password",className:"w-full pr-10 pl-20 py-3 rounded-xl bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] placeholder:text-[var(--adora-text-secondary)] focus:outline-none focus:border-[var(--adora-accent)] focus:ring-2 focus:ring-[var(--adora-focus-border)] transition-all"}),e.jsx("button",{type:"button",onClick:()=>i(w=>!w),className:"absolute left-2 top-1/2 -translate-y-1/2 text-[15px] px-2 py-1 rounded-md bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text-secondary)] hover:bg-[var(--adora-hover-bg)] hover:text-[var(--adora-text)] transition-all",children:s?"إخفاء":"إظهار"})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsx("span",{className:"text-[15px] text-[var(--adora-text-secondary)]",children:"الجلسة تنتهي بإغلاق المتصفح — لا يُحفظ دخول تلقائي"}),e.jsx("button",{type:"button",onClick:N,className:"text-sm font-medium text-[var(--adora-accent)] hover:opacity-90 transition-colors",children:"نسيت كلمة المرور؟"})]}),b&&e.jsx("div",{className:"text-sm text-[var(--adora-error)] bg-[var(--adora-error)]/10 border border-[var(--adora-error)]/40 rounded-lg px-3 py-2",children:b}),e.jsx("button",{type:"button",onClick:h,disabled:u,className:"w-full py-3.5 rounded-xl font-bold bg-[var(--adora-accent)] hover:opacity-90 text-white shadow-md transition-all disabled:opacity-60 disabled:cursor-not-allowed",children:u?"جاري تسجيل الدخول...":"دخول آمن"})]}),g&&e.jsxs("div",{className:"mt-4 p-3 rounded-xl border border-[var(--adora-border)] bg-[var(--adora-input-bg)] space-y-2",children:[e.jsx("div",{className:"text-sm text-[var(--adora-text-secondary)]",children:"استرجاع كلمة المرور"}),e.jsx("input",{type:"email",value:M,onChange:w=>t(w.target.value,"reset"),onPaste:w=>{w.preventDefault();const O=w.clipboardData.getData("text");t(O,"reset")},placeholder:"اكتب الإيميل لإرسال رابط الاستعادة",className:"w-full px-3 py-2 rounded-lg bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] focus:outline-none focus:border-[var(--adora-accent)]"}),_&&e.jsx("div",{className:"text-[15px] text-[var(--adora-warning)] px-1",children:_}),e.jsx("button",{type:"button",onClick:S,className:"w-full py-2 rounded-lg text-sm font-bold bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] hover:bg-[var(--adora-hover-bg)] transition-colors",children:"إرسال رابط الاستعادة"}),A&&e.jsx("div",{className:"text-sm text-[var(--adora-text-secondary)]",children:A})]}),e.jsx("p",{className:"mt-5 text-[15px] text-[var(--adora-text-secondary)] text-center",children:"الدخول محمي ويقتصر على الحسابات المصرح بها فقط."})]})}),e.jsx("div",{className:"hidden lg:flex flex-col justify-between p-10 border-r border-[var(--adora-border)] bg-[var(--adora-hover-bg)]/30 order-1 lg:order-1",children:e.jsxs("div",{children:[e.jsxs("div",{className:"inline-flex items-center gap-2 text-sm font-medium tracking-wide text-white bg-[var(--adora-accent)] rounded-full px-3 py-1.5 mb-4 shadow-sm",children:[e.jsx(Pt,{className:"w-3.5 h-3.5"}),"Secure Admin Access"]}),e.jsxs("h2",{className:"text-4xl font-black leading-[1.2] text-[var(--adora-text)] mb-4",children:["بوابة إدارة",e.jsx("span",{className:"block text-[var(--adora-accent)]",children:"Elite Rewards"})]}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)] leading-7 max-w-sm text-justify",children:"المنصة الرائدة لإدارة المكافآت وتحليل الأداء باحترافية وأمان. تجربة سلسة تدمج بين دقة البيانات وخصوصية التحكم، لتطوير منظومة النجاح"})]})})]})})})}const va=`<p class="text-gray-300 text-center border-b border-white/10 pb-3">تهدف هذه اللائحة إلى تنظيم سير العمل في قسم الاستقبال وضمان تقديم أفضل خدمة ممكنة للنزلاء. يجب على جميع الموظفين الالتزام التام بالتعليمات والسياسات المذكورة أدناه.</p>
<div class="bg-turquoise/10 rounded-xl p-4 border border-turquoise/30"><h4 class="text-turquoise font-bold mb-2 text-base">القسم الأول: المظهر العام والسلوكيات الأساسية</h4><ul class="space-y-2 text-gray-300 list-none"><li class="flex gap-2"><span class="text-turquoise">•</span><span>المظهر الشخصي: يجب على الموظف العناية بنظافته الشخصية، بما في ذلك نظافة الأسنان، الملابس، والرائحة وتعليق الاسم والالتزام بالزي السعودي الرسمي.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>التواجد في مكان العمل: يلتزم الموظف بالتواجد في مكتب الاستقبال خلال فترة دوامه، ولا يجوز له التواجد في أماكن غير مخصصة لعمله مثل المقهى أو المخزن أو خارج المبنى.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>استخدام الهاتف: يمنع استخدام الهاتف الجوال الشخصي أمام النزلاء خلال ساعات العمل. كما يمنع إعطاء الرقم الشخصي للنزيل تحت أي ظرف.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>التعامل مع النزلاء: يمنع الجلوس في حال وجود نزيل في منطقة الاستقبال. يجب إعطاء الأولوية للنزيل وعدم الانشغال بأي شيء آخر أثناء التحدث معه.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>يُمنع تسجيل دخول النزيل دون إثبات هوية ساري المفعول. يجب التحقق من الهوية بمطابقة الأصل عند تسجيل الدخول وتسجيل بياناتها فقط، دون طلب أو أخذ نسخة منها (كارت العائلة غير الزامي).</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>في حال تأخر إدخال النزيل إلى الوحدة المحجوزة في الوقت المحدد، يجب استلام الحقائب وحفظها، وتوفير مكان مناسب للسائح يتم فيه تقديم المشروبات أو الوجبات مجانًا أثناء الانتظار.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>السلوك العام: ممنوع تناول الطعام أو الشراب أمام النزلاء. يجب الحفاظ على نظافة وترتيب مكتب الاستقبال بشكل دائم، وتجنب ترك الأوراق والأكواب وغيرها من الأشياء المتناثرة.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>التعامل مع الخلافات: في حال حدوث أي خلاف بين الموظفين، يمنع منعًا باتًا مناقشة الأمر أمام النزلاء. يجب إبلاغ المدير المسؤول فورًا.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>الهدوء: يجب أن يكون موظف الاستقبال مسؤولًا عن الحفاظ على بيئة هادئة ومنظمة في منطقة الاستقبال. يمنع تواجد أكثر من ثلاثة أشخاص في الاستقبال، سواء كانوا موظفين أو عمالًا أو إداريين.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>الخصوصية: ممنوع إعطاء أي معلومات عن النزلاء لأي شخص كان في حال طلب أي شخص معلومات عن نزيل، يجب إخباره بالاتصال به مباشرة او بضرورة احضار اذن رسمي من الجهة الرسمية المختصة.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>المهام الشخصية: يجب الاحتفاظ بالأمور الشخصية، مثل المكالمات الهاتفية ورسائل الجوال ومواقع التواصل الاجتماعي، بعيدًا عن وقت ومكان العمل.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>تسجيل كافة الملاحظات: تسجيل أي ملاحظه للنزلاء مكتوبه حتى لو تم حلها وإبلاغ مشرف الاستقبال بها كسجل توثيق.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>التأكد من جاهزية أدوات العمل: عند بدء الدوام يجب التأكد من جاهزية (الكاميرات – التلفون – الانترنت – تكييف الاستقبال – تلفزيون الاستقبال – موسيقي الاستقبال – الطابعة – صرف نقدي – تسجيل المرافقين – ترحيل شموس – التواصل مع الحجوزات – فتح الغرف الشاغرة – الحضور وعدم الحضور – توقيع كل العقود – الرد على كل الرسائل – تحصيل كل الرسوم – فحص برنامج المفاتيح – تدوين ملاحظات الشفت السابق) في حال وجود أي تقصير من الموظف السابق يجب ابلاغ المشرف فوراً.</span></li><li class="flex gap-2"><span class="text-turquoise">•</span><span>في حال وجود موظف سياحة: في فرع الكورنيش يتم فتح الغرف القديمة فقط وغير مسموح بفتح الغرف الجديدة بالدور الثالث والرابع.</span></li></ul></div>
<div class="bg-blue-500/10 rounded-xl p-4 border border-blue-500/30"><h4 class="text-blue-400 font-bold mb-2 text-base">القسم الثاني: إجراءات الحجوزات والدفع</h4><ul class="space-y-2 text-gray-300 list-none"><li class="flex gap-2"><span class="text-blue-400">•</span><span>التسعير: غير مسموح بالتفاوض على الأسعار المكتوبة في قائمة الأسعار إلا في حالات محددة يتم إبلاغ الموظف بها مسبقًا. لا يختص مدير التشغيل أو المشرف بالتفاوض على الأسعار مع النزلاء.</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>الحجوزات الشهرية: يجب أن تكون الإيجارات الشهرية مدفوعة مقدمًا وغير مستردة.</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>العقود: من الضروري توقيع النزيل على عقد تسجيل الدخول لضمان حقوق المنشأة في حال وجود أي مشكلة.</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>التأمين: يتم احتساب مبلغ تأمين قدره 100 ريال كحد أدنى على كل نزيل. يُستحسن تحصيل التأمين كاش فيجب سؤال النزيل عن توافر كاش. يتم رد مبلغ التأمين عند تسجيل الخروج بعد خصم خدمات الفندق (مثل المغسلة والميني بار إن وجد). في حال عدم أخذ التأمين، يتحمل الموظف مسؤولية أي مستحقات للنزيل. بعض الحالات يتم التغاضي فيها عن تحصيل التأمين (حجوزات المطار – تابي وتمارا – بوكينج الأجانب).</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>يُمنع اشتراط أن يكون حجز الوحدة لأكثر من ليلة واحدة.</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>غير مسموح بتسجيل رقم جوال غير دقيق او مكتمل للنزيل (يطبق على الأرقام الدولية يتم كتابه رقم النزيل في الملاحظات فقط على نزيل مع تسجيل رقم الفندق ببيانات النزيل).</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>المستحقات المالية: في حال تجاوز المبلغ المستحق على النزيل إيجار ليلة واحدة، يجب على موظف الاستقبال إبلاغ المشرف المباشر لمطالبة النزيل بالدفع قبل بداية الشفت التالي وفي حال عدم القدرة على التحصيل يتم نقل مسؤوليه التحصيل لشفت الليل.</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>المدفوعات: عند رد أي مبالغ متبقية للنزيل (بخلاف التأمين)، يجب توقيعه على سند الصرف.</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>السندات والفواتير: مسموح بإعطاء النزيل صوره من العقد والسندات والفاتورة بعد الخروج وممنوع تسجيل سند خدمه او فاتورة بقيمة صفر.</span></li><li class="flex gap-2"><span class="text-blue-400">•</span><span>الحسابات: كل موظف مسؤول عن حسابه على النظام. يجب إغلاق الحساب بعد انتهاء الدوام.</span></li></ul></div>
<div class="bg-green-500/10 rounded-xl p-4 border border-green-500/30"><h4 class="text-green-400 font-bold mb-2 text-base">القسم الثالث: التعامل مع النزلاء والخدمات</h4><ul class="space-y-2 text-gray-300 list-none"><li class="flex gap-2"><span class="text-green-400">•</span><span>ترحيل العقود: يجب ترحيل جميع العقود على نظام شموس وتسجيل المرافقين خصوصاً الحجوزات المجمعة ومراجعة ذلك بداية كل شفت وفي حال وجود عميل غير مرحل من خلال نزيل يتم ترحيله يدوي وفي حال عدم الترحيل يجب ابلاغ المشرف ومدير التشغيل.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>الضيافة: يمكن تقديم ضيافة مجانية (قهوة، شاي، تمر) لأي نزيل حسب تقدير موظف الاستقبال للأمر.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>النزلاء المميزون: يتم تقديم ضيافة خاصة (قهوة وتمر) لعملاء أجنحة الـ VIP وضيوف المالك. كما يجب منحهم اهتمامًا خاصًا اثناء استقبالهم، خصوصًا في حال وجود نزلاء آخرين كما يجب ارسال العمال قبل دخول النزل لإعادة تنظيف الملحق مع إعطاء النزيل أولوية الخروج المتأخر.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>لنزلاء تجهيزات ذكري الزواج – تقليل التواصل مع النزيل وعدم التواصل المتكرر لتسجيل الخروج.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>النظافة: رسمياً تتوفر خدمة التنظيف للنزلاء من الساعة 11:00 صباحًا إلى 9:00 مساءً. يحصل النزلاء الشهري على هذه الخدمة مرتين إلى ثلاث مرات أسبوعيًا كحد أقصى. لا تدخل في مشكله مع نزيل على شيء بسيط اجعل المرونة ورضاء النزيل هما البوصلة.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>تحديد صلاحية الغرف: غير مسموح بتحويل حالة الغرفة إلى نظيفة إلا بعد فحص وتأكيد من مشرف العمال.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>فحص الغرف: مشرف العمال هو المسؤول الأول عن فحص الغرفة عند خروج النزيل في حال الانشغال يمكن لحامل الحقائب القيام بعمليه فحص الغرفة. لا يسمح بتسجيل خروج النزيل دون فحص الغرفة. يتحمل الموظف مسؤولية أي تلف أو نقصان بعد خروج النزيل في حال عدم فحص الغرفة. يتم ابلاغ النزيل بالانتظار في الاستقبال لحين التأكد من عدم نسيان أغراض له في الغرفة.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>تغيير الغرف: غير مسموح بنقل نزيل من غرفة إلى أخرى دون ذكر سبب النقل في نزيل.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>الصيانة: لا يجوز إدخال أي غرفة للصيانة دون ذكر السبب الفعلي على برنامج نزيل ومن ثم إبلاغ مشرف العمال وفني الصيانة.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>الاستجابة للطلبات: يجب الرد على اتصالات الفندق ورسائل الواتساب وبوكينج في أسرع وقت ممكن. ممنوع وضع هاتف الفندق او الجوال على الوضع الصامت.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>الاتصال: يجب استخدام تحية رسمية عند الرد على الهاتف، مثل: السلام عليكم، معك فندق إليت، أنا (اسم الموظف)، كيف أقدر أخدمك؟</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>تحويل المكالمات: في حال طلب النزيل خدمة غير مختص بها الموظف، يجب تحويل الاتصال بطريقة مؤدبة، مثل: دقيقة من فضلك، سيتم تحويل المكالمة إلى الإدارة.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>إشعار النزيل بوقتٍ كافٍ قبل البدء بأي أعمال صيانة أو نحوها تخص المرافق أو التجهيزات، والتي قد ينتج عنها إزعاج أو ضوضاء تصل إلى الوحدة التي يقيم فيها، مع توضيح موعد بدء الأعمال وانتهائها بشكلٍ دقيق.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>المفقودات: يُبلغ السائح بأي مفقودات تخصه يتم العثور عليها، ويتم الاحتفاظ بها مدة لا تقل عن (30) يومًا وتُحتسب المدة من تاريخ إبلاغ النزيل، وفي حال تعذر إبلاغه تُخطر الجهات المختصة بذلك.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>يُحظر الامتناع عن إعادة أمتعة النزيل أو مقتنياته الشخصية، سواء كانت مودعة في الاستقبال أو موجودة داخل الوحدة التي يشغلها.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>يُمنع اتخاذ أي إجراء يُلزم السائح بمغادرة الوحدة بعد تسجيل دخوله مثل فصل الكهرباء.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>يُلتزم بإبلاغ الجهات المختصة والوزارة فورًا، وبشكلٍ مباشر، من خلال القنوات المخصصة لذلك، عن أي حادث يتعلق بالأمن أو السلامة في الفندق.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>تأكد من توفير وحدة بديلة للسائح فورًا في الفرع الثاني او مكان قريب مساوية أو أعلى فئة وتصنيفًا، أو إعادة المبلغ المدفوع، في الحالات التالية: انقطاع الخدمات الأساسية مثل الكهرباء والماء لأكثر من ساعتين. كما يجب توفير وحدة بديلة أو إعادة المبلغ إذا تعذّر على السائح دخول الوحدة المحجوزة بعد تجاوز موعد الدخول بساعتين.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>الخروج من الغرف: يمنع على موظف الاستقبال الصعود منفرداً إلى أي غرفة (شاغرة أو مشغولة) تحت أي مبرر، إلا بعلم الإدارة.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>الزوار: يمنع صعود أي شخص (مندوب، سائق، توصيل مطاعم) إلى الغرفة إلا بعد تواصل النزيل بالاستقبال ومرافقة أحد العمال له. في حال بقاء الزائر في الغرفة لأكثر من دقيقة، يجب تسجيل هويته في ملاحظات الغرفة.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>التواصل اللاسلكي: يجب أن يكون التواصل مع مشرف النظافة أو العمال عبر الجهاز اللاسلكي إن وجدت في أضيق الحدود بكلمات مختصره متفق عليها مسبقاً، وبنداء طارئ وبدون تفاصيل مطوله.</span></li><li class="flex gap-2"><span class="text-green-400">•</span><span>الخروج المتأخر: يُسمح للنزيل بالخروج ورد المبلغ المدفوع في حال لم يمر على دخوله أكثر من نصف ساعة، ودون استخدام محتويات الغرفة. يتم فحص الغرفة من قبل عامل قبل رد المبلغ للنزيل وتوقيعه على سند استلام المبلغ.</span></li></ul></div>
<div class="bg-yellow-500/10 rounded-xl p-4 border border-yellow-500/30"><h4 class="text-yellow-400 font-bold mb-2 text-base">القسم الرابع: إجراءات بوكينج وتسجيل الخروج</h4><ul class="space-y-2 text-gray-300 list-none"><li class="flex gap-2"><span class="text-yellow-400">•</span><span><strong>الحجوزات عبر بوكينج:</strong> غير مسموح بطلب إلغاء الحجز من النزيل. يتم منح أولوية التواصل صباحاً لنزيل بوكينج، حتى لو كان رقمه خاطئًا يتم التواصل معه عن طريق رسائل الموقع، الحالة الوحيدة المسموح فيها بعدم التواصل معه هي امتلاء الفندق بالكامل. يمنع محاسبة نزلاء بوكينج بمبلغ مخالف للحجز أو بعدد ليال أقل. يُسمح بطلب التأمين من نزلاء بوكينج بقيمة 100 ريال كحد أدنى وتزيد قيمة التأمين حسب رؤية الموظف. يجب متابعة إلغاء الحجوزات عبر بوكينج، حيث يتم فتح الغرفة تلقائيًا على الموقع. يجب على الموظف تعديل وضع المتاح ورفع السعر لضمان عدم الحجز. لا يُسمح ابلاغ النزيل بإلغاء حجز نزيل بوكينج بسبب عدم توفر غرفة في حال وصوله للفندق في الوقت الرسمي للدخول. يجب عرض خيارين: ترقية مجانية للحجز، أو تحويله إلى فرعنا الآخر مع ذكر المميزات المتاحة. يتم عمل عدم حضور للنزلاء الساعة 12 الليل.</span></li><li class="flex gap-2"><span class="text-yellow-400">•</span><span><strong>تسجيل الخروج:</strong> موعد الخروج الرسمي هو الساعة 2:00 ظهرًا. يتم الاتصال بالنزيل من الساعة 12 ظهراً للاستفسار عن تجديد الإقامة أو المغادرة. الخروج المتأخر: في حال رغبة النزيل في الخروج بعد الموعد الرسمي (بحد أقصى الساعة 8:00 مساءً)، يتم احتساب خدمة خروج متأخر. يتم تفعيل هذه الخدمة في الأيام التي لا توجد فيها مواسم. الدخول المبكر: في حال رغبة النزيل في الدخول المبكر (من الساعة 4:00 فجرًا)، يتم احتساب خدمة دخول مبكر. يتم تفعيل هذه الخدمة في الأيام التي لا توجد فيها حجوزات، وفي حال توافر أكثر من 3 شقق شاغرة.</span></li></ul><p class="mt-3 text-yellow-200/90 text-xs">أثناء مغادرة نزيل بوكينج، يمكنك تشجيعه على حجز إقامته القادمة مباشرةً من الفندق للاستفادة من المزايا: خصم 5% عند الاحتفاظ بكارت الفندق، مرونة في المواعيد، إمكانية الحجز المسبق عبر الهاتف، الانضمام لعضوية (Elite) لخصومات تصل إلى 15%، وسؤال النزيل عن الملاحظات والاقتراحات وطلب تقييم الفندق على خرائط جوجل.</p></div>
<div class="bg-red-500/10 rounded-xl p-4 border border-red-500/30"><h4 class="text-red-400 font-bold mb-2 text-base">القسم الخامس: سياسات الدوام والإجازات</h4><ul class="space-y-2 text-gray-300 list-none"><li class="flex gap-2"><span class="text-red-400">•</span><span>الدوام الرسمي: يجب على جميع الموظفين الالتزام بالجدول المحدد والمعتمد من مشرف الاستقبال.</span></li><li class="flex gap-2"><span class="text-red-400">•</span><span>استبدال الدوام: يمنع استبدال أيام الإجازة أو الدوام إلا بالتنسيق مع الزميل وقبل 24 ساعة ويوجد ما يثبت الطلب وموافقه الزميل على ذلك.</span></li><li class="flex gap-2"><span class="text-red-400">•</span><span>التأخير: مسموح بتأخير بحد أقصى 15 دقيقة في الظروف الطارئة. يتم تطبيق جزاء حسب رؤية الإدارة ويتم مضاعفة الجزاء وتوجيه إنذار رسمي في حال تكرار التأخير.</span></li><li class="flex gap-2"><span class="text-red-400">•</span><span>الغياب: في حال الرغبة في الغياب، يجب تقديم طلب مكتوب قبل 24 ساعة على الأقل. الغياب بدون طلب مكتوب يعتبر غيابًا بدون اذن ويتم خصم يومين. يتم مضاعفة الجزاء وتوجيه إنذار رسمي في حال التكرار.</span></li></ul></div>`,Hs=[{id:"returnToAnalysis",label:"نظام التحليل",labelShort:"نظام التحليل",variant:"cyan",context:"rewards",onclick:"returnToAnalysis()",iconId:"arrow-left"},{id:"returnToUpload",label:"خروج",labelShort:"خروج",variant:"red",context:"rewards",onclick:"returnToUpload()",iconId:"log-out",hidden:!0},{id:"closePeriod",label:"إغلاق الفترة",labelShort:"إغلاق",variant:"red",context:"rewards",onclick:"showClosePeriodModal()",iconId:"lock"},{id:"discounts",label:"الخصم الإداري",labelShort:"خصم إداري",variant:"default",context:"rewards",onclick:"showDiscountsModal()",iconId:"percent"},{id:"reports",label:"التقارير",labelShort:"تقارير",variant:"default",context:"rewards",onclick:"showReportsPage()",iconId:"bar-chart2"},{id:"conditions",label:"شروط المكافآت",labelShort:"شروط",variant:"default",context:"both",onclick:"showConditionsModal()",actionType:"conditions",iconId:"file-text"},{id:"printAll",label:"طباعة الكل",labelShort:"الكل",variant:"primary",context:"rewards",onclick:"smartPrint(false)",iconId:"printer"},{id:"exportPdfTableAll",label:"تصدير PDF",labelShort:"PDF",variant:"default",context:"rewards",onclick:"exportPdfTableAll()",iconId:"file-down",title:"تصدير جدول الكل PDF (صفوف، صافي، تقييمات، حضور)"},{id:"printSelected",label:"طباعة المحدد",labelShort:"محدد",variant:"amber",context:"rewards",onclick:"smartPrint(true)",iconId:"target",hidden:!0},{id:"refreshLive",label:"تحميل التحديثات",labelShort:"تحديث",variant:"default",context:"rewards",onclick:"refreshLivePeriodFromFirebase()",iconId:"refresh",title:"جلب آخر التقييمات والحضور من المشرف/HR"},{id:"adminManage",label:"إدارة الإداريين",labelShort:"إداريين",variant:"violet",context:"rewards",onclick:"showAdminManagementModal()",iconId:"users"},{id:"settings",label:"الإعدادات",labelShort:"الإعدادات",variant:"default",context:"analysis",actionType:"settings",iconId:"settings",title:"إعدادات التحليل"},{id:"logout",label:"خروج",labelShort:"خروج",variant:"red",context:"analysis",actionType:"logout",iconId:"log-out",title:"خروج — تسجيل الخروج والعودة لصفحة الدخول"},{id:"methodology",label:"المنهجية",labelShort:"المنهجية",variant:"default",context:"analysis",actionType:"methodology",iconId:"info",title:"منهجية التحليل"},{id:"ratingExplanation",label:"كيفية حساب التقييم",labelShort:"كيفية حساب التقييم",variant:"default",context:"analysis",actionType:"ratingExplanation",iconId:"bar-chart3",title:"كيفية حساب التقييم"}],Gs={buttons:Hs},Ks={name:"الكورنيش",excluded:!1,vipRooms:["603","604"],priceRules:[{roomType:"VIP",dailyMin:850,monthlyMin:600,keywords:["vip"]},{roomType:"تؤم",dailyMin:230,monthlyMin:187,keywords:["تؤم","تؤام"]},{roomType:"كينج",dailyMin:230,monthlyMin:187,keywords:["كينج","king"]},{roomType:"ستوديو",dailyMin:340,monthlyMin:260,keywords:["ستوديو","studio"]},{roomType:"غرفة وصالة",dailyMin:370,monthlyMin:280,keywords:["صالة","النوم"]},{roomType:"غرفتين",dailyMin:400,monthlyMin:300,keywords:["غرفتين","شقة غرفتين"]}],mergedRules:[]},Ws={name:"الأندلس",excluded:!1,vipRooms:["601","602","603","604"],priceRules:[{roomType:"VIP-601",dailyMin:570,monthlyMin:467,keywords:["vip"]},{roomType:"VIP-602",dailyMin:370,monthlyMin:333,keywords:["vip"]},{roomType:"VIP-604",dailyMin:320,monthlyMin:267,keywords:["vip"]},{roomType:"تؤام",dailyMin:190,monthlyMin:169,keywords:["تؤام","تؤم"]},{roomType:"كينج",dailyMin:205,monthlyMin:180,keywords:["كينج","king"]},{roomType:"ستوديو",dailyMin:220,monthlyMin:192,keywords:["ستوديو","studio"]},{roomType:"جناح",dailyMin:290,monthlyMin:245,keywords:["جناح","صال"]}],mergedRules:[{label:"غرفتين أمامية",dailyMin:420,monthlyMin:345,digitPairs:[1,2]},{label:"غرفتين خلفية",dailyMin:390,monthlyMin:322,digitPairs:[3,4]},{label:"غرفتين خلفية",dailyMin:390,monthlyMin:322,digitPairs:[5,6]},{label:"غرفتين أمامية",dailyMin:420,monthlyMin:345,digitPairs:[7,8]}]},de={rateMorning:2,rateEvening:3,rateNight:4,rateBooking:2,rateContract:200,rateVipByBranch:{الكورنيش:{603:{reception:30,booking:3},604:{reception:30,booking:3}},الأندلس:{601:{reception:30,booking:3},602:{reception:30,booking:3},603:{reception:30,booking:3},604:{reception:10,booking:2}}},rateVipDefault:{reception:30,booking:3},vipDescription:"الحد الادني لعدد الحجوزات = شفت الليل 75 عقد باقي الشفتات 120 عقد",rateEvalBooking:30,rateEvalGoogle:10,minEvalCorniche:8.7,minEvalAndalus:8.2,minEvalGoogle:4.3,supportFundPercent:15},Re={minBookingThreshold:0,monthlyNightsThreshold:28,branches:{الكورنيش:Ks,الأندلس:Ws},rewardPricing:structuredClone(de)},Rt="adora-analysis-config",Fa="adora-analysis-default-config",Ba="adora_rewards_pricing";function Ys(){try{const a=localStorage.getItem(Ba);if(!a)return null;const t=JSON.parse(a);return!t||typeof t!="object"?null:t}catch{return null}}function Js(a,t){const n=t.rateVipDefault!=null?typeof t.rateVipDefault=="number"?{reception:t.rateVipDefault,booking:t.rateVipDefault}:{reception:t.rateVipDefault.reception??a.rateVipDefault.reception,booking:t.rateVipDefault.booking??a.rateVipDefault.booking}:a.rateVipDefault;let l=a.rateVipByBranch;if(t.rateVipByBranch&&typeof t.rateVipByBranch=="object"){l={...a.rateVipByBranch};for(const[s,i]of Object.entries(t.rateVipByBranch))if(i&&typeof i=="object"){l[s]={...l[s]||{}};for(const[c,b]of Object.entries(i))typeof b=="number"?l[s][c]={reception:b,booking:b}:b&&typeof b=="object"&&(l[s][c]={reception:b.reception??0,booking:b.booking??0})}}return{rateMorning:typeof t.rateMorning=="number"?t.rateMorning:a.rateMorning,rateEvening:typeof t.rateEvening=="number"?t.rateEvening:a.rateEvening,rateNight:typeof t.rateNight=="number"?t.rateNight:a.rateNight,rateBooking:typeof t.rateBooking=="number"?t.rateBooking:a.rateBooking,rateContract:typeof t.rateContract=="number"?t.rateContract:a.rateContract??200,rateVipByBranch:l,rateVipDefault:n,vipDescription:typeof t.vipDescription=="string"?t.vipDescription:a.vipDescription??"حجوزات VIP — تُسعّر من خانات VIP (استقبال/بوكينج لكل غرفة)",rateEvalBooking:typeof t.rateEvalBooking=="number"?t.rateEvalBooking:a.rateEvalBooking,rateEvalGoogle:typeof t.rateEvalGoogle=="number"?t.rateEvalGoogle:a.rateEvalGoogle,minEvalCorniche:typeof t.minEvalCorniche=="number"?t.minEvalCorniche:a.minEvalCorniche??8.7,minEvalAndalus:typeof t.minEvalAndalus=="number"?t.minEvalAndalus:a.minEvalAndalus??8.2,minEvalGoogle:typeof t.minEvalGoogle=="number"?t.minEvalGoogle:a.minEvalGoogle??4.3,supportFundPercent:typeof t.supportFundPercent=="number"?t.supportFundPercent:a.supportFundPercent??15}}function Xs(a){try{localStorage.setItem(Fa,JSON.stringify(a))}catch{}}function Zs(){try{const a=localStorage.getItem(Fa);if(!a)return null;const t=JSON.parse(a);return!t||typeof t!="object"?null:structuredClone(t)}catch{return null}}function ya(){try{const a=localStorage.getItem(Rt);if(!a){const u=structuredClone(Re),h=Ys();if(h&&typeof h.rateMorning=="number"){u.rewardPricing=Js(u.rewardPricing,h);try{localStorage.setItem(Rt,JSON.stringify(u))}catch{}}return u}const t=JSON.parse(a),n=t.branches??structuredClone(Re.branches),l={};for(const[u,h]of Object.entries(n)){const g=Re.branches[u];l[u]={name:h.name??u,excluded:h.excluded??(g==null?void 0:g.excluded)??!1,vipRooms:h.vipRooms??(g==null?void 0:g.vipRooms)??[],priceRules:h.priceRules??(g==null?void 0:g.priceRules)??[],mergedRules:h.mergedRules??(g==null?void 0:g.mergedRules)??[]}}const s=t.rewardPricing;let i=de.rateVipDefault;(s==null?void 0:s.rateVipDefault)!=null&&(typeof s.rateVipDefault=="number"?i={reception:s.rateVipDefault,booking:s.rateVipDefault}:i={reception:s.rateVipDefault.reception??0,booking:s.rateVipDefault.booking??0});const c={};if(s!=null&&s.rateVipByBranch)for(const[u,h]of Object.entries(s.rateVipByBranch)){c[u]={};for(const[g,N]of Object.entries(h))typeof N=="number"?c[u][g]={reception:N,booking:N}:N&&typeof N=="object"&&(c[u][g]={reception:N.reception??0,booking:N.booking??0})}const b={rateMorning:(s==null?void 0:s.rateMorning)??de.rateMorning,rateEvening:(s==null?void 0:s.rateEvening)??de.rateEvening,rateNight:(s==null?void 0:s.rateNight)??de.rateNight,rateBooking:(s==null?void 0:s.rateBooking)??de.rateBooking,rateContract:(s==null?void 0:s.rateContract)??de.rateContract,rateVipByBranch:c,rateVipDefault:i,vipDescription:(s==null?void 0:s.vipDescription)??de.vipDescription,rateEvalBooking:(s==null?void 0:s.rateEvalBooking)??de.rateEvalBooking,rateEvalGoogle:(s==null?void 0:s.rateEvalGoogle)??de.rateEvalGoogle,minEvalCorniche:(s==null?void 0:s.minEvalCorniche)??de.minEvalCorniche,minEvalAndalus:(s==null?void 0:s.minEvalAndalus)??de.minEvalAndalus,minEvalGoogle:(s==null?void 0:s.minEvalGoogle)??de.minEvalGoogle,supportFundPercent:typeof(s==null?void 0:s.supportFundPercent)=="number"?s.supportFundPercent:de.supportFundPercent};return{minBookingThreshold:t.minBookingThreshold??Re.minBookingThreshold,monthlyNightsThreshold:t.monthlyNightsThreshold??Re.monthlyNightsThreshold,branches:l,rewardPricing:b}}catch{return structuredClone(Re)}}function kt(a){try{localStorage.setItem(Rt,JSON.stringify(a)),localStorage.setItem(Ba,JSON.stringify(a.rewardPricing))}catch{}}function ja(a,t){return a.branches[t]?a:{...a,branches:{...a.branches,[t]:{name:t,excluded:!0,vipRooms:[],priceRules:[],mergedRules:[]}}}}function Qs(a,t,n,l,s){const i=a.branches[t];if(!i||!n)return{label:"غير محدد",minPrice:0,isMonthly:!1};const c=n.toLowerCase(),b=s>=a.monthlyNightsThreshold;if(c.includes("vip")){const u=i.priceRules.find(g=>g.roomType.includes(l)&&g.keywords.some(N=>c.includes(N)));if(u)return{label:u.roomType+(b?" (شهري)":""),minPrice:b?u.monthlyMin:u.dailyMin,isMonthly:b};const h=i.priceRules.find(g=>g.roomType==="VIP"||g.roomType.startsWith("VIP"));return h?{label:"VIP"+(b?" (شهري)":""),minPrice:b?h.monthlyMin:h.dailyMin,isMonthly:b}:{label:"VIP",minPrice:0,isMonthly:b}}for(const u of i.priceRules)if(!u.roomType.startsWith("VIP")&&u.keywords.some(h=>c.includes(h)))return{label:u.roomType+(b?" (شهري)":""),minPrice:b?u.monthlyMin:u.dailyMin,isMonthly:b};return{label:"غير مصنف",minPrice:0,isMonthly:!1}}let Tt=null;function Na(a){Tt=a}function $t(){if(!Tt)throw new Error("XLSX not loaded; call setXLSXModule after dynamic import");return Tt}const Lt=10*1024*1024;function Ft(a){if(a.byteLength>Lt)throw new Error("الملف أكبر من الحد المسموح (10 ميجابايت)")}const Oa={employeeName:["المستخدم","اسم المستخدم","الموظف"],creationTime:["تاريخ/وقت الإنشاء","تاريخ الإنشاء","تاريخ/وقت الانشاء"],bookingSource:["مصدر الحجز","المصدر"],totalPrice:["الاجمالي","الإجمالي","المبلغ الإجمالي"],rentOnly:["الايجار الكلي","الإيجار الكلي","صافي الإيجار"],nights:["مدة الحجز","عدد الليالي","الليالي"],checkoutDate:["تاريخ الخروج"],checkInTime:["تاريخ الدخول"],status:["حالة الحجز"],bookingNumber:["رقم الحجز"],roomUnit:["رقم الوحدة","الوحدة","الوحدات"],guestName:["إسم العميل","اسم العميل","العميل","إسم النزيل"]},Va={employeeName:["المستخدم","اسم المستخدم","الموظف"],changeText:["التفاصيل","تفاصيل الحركة","الوصف"],bookingInfo:["معلومات الحجز","الحجز","رقم الحجز"],dateTime:["التاريخ","تاريخ/وقت","التاريخ والوقت"]},za={bookingCount:["عدد الحجوزات","الحجوزات"],employeeName:["اسم الموظف","الموظف","المستخدم"]},Ua={employeeName:["المستخدم","اسم المستخدم"],rent:["قيمة الإيجار","الإيجار","صافي الإيجار"],nights:["الليالي المباعة","عدد الليالي","الليالي"],checkoutDate:["تاريخ الخروج"],checkInTime:["تاريخ الدخول"],floor:["الطابق"],roomType:["نوع الوحدة","النوع"],roomUnit:["رقم الوحدة","الوحدة"]},qa={employeeName:0,creationTime:4,bookingSource:7,totalPrice:19,rentOnly:27,nights:31,checkoutDate:34,checkInTime:37,status:40,bookingNumber:41,roomUnit:42,guestName:48},Ha={employeeName:26,changeText:3,bookingInfo:15,dateTime:32},Ga={bookingCount:27,employeeName:28},Ka={employeeName:1,rent:6,nights:8,checkoutDate:15,checkInTime:17,floor:21,roomType:26,roomUnit:30};function ke(a,t,n,l=25){const s=new Map;for(const[u,h]of Object.entries(t))for(const g of h)s.set(g.trim(),u);let i={},c=-1,b=0;for(let u=0;u<Math.min(l,a.length);u++){const h=a[u];if(!h||h.length<3)continue;const g={};let N=0;for(let M=0;M<h.length;M++){const _=String(h[M]??"").trim();if(!_)continue;const A=s.get(_);A&&!(A in g)&&(g[A]=M,N++)}N>b&&(i=g,c=u,b=N)}if(b>=3){const u={...n};for(const[h,g]of Object.entries(i))u[h]=g;return{col:u,headerRow:c}}return{col:{...n},headerRow:-1}}function Ve(a,t,n,l){if(t<0)return l;const s=Object.values(n)[0]??0;for(let i=t+1;i<Math.min(t+10,a.length);i++){const c=a[i];if(!c)continue;const b=String(c[s]??"").trim();if(b&&b.length>0)return i}return t+1}function Bt(a){const t=a.toLowerCase().trim();if(!t||t.length<3)return"";if(t.includes("corniche")||t.includes("كورنيش"))return"الكورنيش";if(t.includes("andalous")||t.includes("أندلس")||t.includes("اندلس"))return"الأندلس";if(t.includes("batin")||t.includes("باطن")||t.includes("حفر"))return"حفر الباطن";const n=a.match(/(?:adora|فندق)\s*[-–:]\s*(.+)/i);if(n){const l=n[1].trim();if(l.length>=2)return l}return""}function en(a){for(let t=0;t<Math.min(10,a.length);t++){const n=a[t];if(n)for(let l=0;l<Math.min(5,n.length);l++){const s=String(n[l]??"").trim(),i=Bt(s);if(i)return i}}return""}function tn(a){var l;const t=be(a),n=[];for(let s=0;s<t.length;s++){const i=String(((l=t[s])==null?void 0:l[0])??"").trim(),c=Bt(i);c&&!n.includes(c)&&n.push(c)}return n}function an(a,t){const l={staff:"تقرير إحصائيات الموظفين",log:"سجل حركات النظام",report:"تقرير حجوزات العملاء",units:"تقرير وحدات الحجوزات",actualDates:"تقرير التواريخ الفعلية للحجوزات",unknown:"ملف غير معروف"}[a]||"ملف";return t?`${l} — ${t}`:l}function rn(a){const t={staff:{color:"text-cyan-400",bg:"bg-cyan-500/20"},log:{color:"text-teal-400",bg:"bg-teal-500/20"},report:{color:"text-sky-400",bg:"bg-sky-500/20"},units:{color:"text-amber-400",bg:"bg-amber-500/20"},actualDates:{color:"text-violet-400",bg:"bg-violet-500/20"},unknown:{color:"text-[var(--adora-error)]",bg:"bg-adora-error-subtle"}};return t[a]||t.unknown}function sn(a){Ft(a);const t=$t(),n=t.read(a,{type:"array"}),l=n.SheetNames[0]||"",s=t.utils.sheet_to_json(n.Sheets[l],{header:1,defval:""}),i=l.toLowerCase();let c="unknown";if(i.includes("userstatisticsreport"))c="staff";else if(i.includes("activitylog"))c="log";else if(i.includes("resesrvationsunits")||i.includes("reservationsunits"))c="units";else if(i.includes("guestsstatistical"))c="report";else if(i.includes("actualdates")||i.includes("resesrvationactual")||i.includes("resesrvatinactual"))c="actualDates";else for(let h=0;h<Math.min(20,s.length);h++){const g=s[h];if(!g)continue;const N=g.map(M=>String(M??"")).join(" ");if(N.includes("عدد الحجوزات")||N.includes("تقرير إحصائيات المستخدمين")){c="staff";break}if(N.includes("تقرير سجل الحركات")||N.includes("إنشاء حجز جديد")){c="log";break}if(N.includes("تقرير وحدات الحجوزات")){c="units";break}if(N.includes("تقرير حجوزات العملاء")||N.includes("مصدر الحجز")){c="report";break}if(N.includes("الدخول والخروج الفعلي للحجوزات")||N.includes("تقرير تسجيل الدخول والخروج الفعلي")){c="actualDates";break}}if(c==="staff")return{slotKey:"staff",baseType:c,branch:""};if(c==="unknown")return{slotKey:"unknown",baseType:c,branch:""};const b=en(s);return{slotKey:b?`${c}-${b}`:`${c}-unknown`,baseType:c,branch:b}}function Wa(a){const t=a.getHours()*60+a.getMinutes();return t>=360&&t<960?"صباح":t>=960?"مساء":"ليل"}function Ya(a){const t=a.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})[,\s]+(\d{1,2}):(\d{2})\s*(AM|PM)/i);if(!t)return null;let n=parseInt(t[4],10);return t[6].toUpperCase()==="PM"&&n!==12&&(n+=12),t[6].toUpperCase()==="AM"&&n===12&&(n=0),new Date(parseInt(t[3]),parseInt(t[2])-1,parseInt(t[1]),n,parseInt(t[5]))}function ue(a){let t=a.match(/(\d{2})\/(\d{2})\/(\d{4})/);return t?new Date(parseInt(t[3]),parseInt(t[2])-1,parseInt(t[1])):(t=a.match(/(\d{4})-(\d{2})-(\d{2})/),t?new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3])):null)}function nn(a){return a.includes("استقبال")?"استقبال":a.includes("بوكينج")||a.toLowerCase().includes("booking")?"بوكينج":"غير محدد"}function xt(a){if(!a)return"عادي";const t=a.toLowerCase();return t.includes("vip")||t.includes("جناح")||t.includes("سويت")||t.includes("suite")||t.includes("بنتهاوس")||t.includes("رويال")||t.includes("royal")?"VIP":"عادي"}function _t(a){const t=a.match(/^(\d{3})/);return t?t[1]:""}function be(a){Ft(a);const t=$t(),n=t.read(a,{type:"array"});return t.utils.sheet_to_json(n.Sheets[n.SheetNames[0]],{header:1,defval:""})}function lt(a){const t=a.split(" ")[0]||"";if(t.includes("-")){const[n,l,s]=t.split("-");return`${s}/${l}/${n}`}return t}function wa(a){var b,u;const t=be(a),{col:n}=ke(t,za,Ga);let l=lt(String(((b=t[10])==null?void 0:b[26])??"")),s=lt(String(((u=t[10])==null?void 0:u[11])??""));if(!ue(l)||!ue(s)){const h=[];for(let g=0;g<Math.min(15,t.length);g++){const N=t[g];if(N)for(let M=0;M<N.length;M++){const _=String(N[M]??"").trim(),A=ue(_);A&&h.push({str:_,d:A})}}h.length>=2&&(h.sort((g,N)=>g.d.getTime()-N.d.getTime()),l=lt(h[0].str),s=lt(h[h.length-1].str))}let i=0,c=!1;for(let h=0;h<t.length;h++){const g=t[h];if(!g)continue;const N=String(g[n.bookingCount]??"").trim();if(N==="عدد الحجوزات"){c=!0;continue}const M=String(g[n.employeeName]??"").trim();if(M==="المجموع"){c=!1;continue}!c||!M||(parseInt(N,10)||0)>0&&i++}return{activeEmployees:i,dateFrom:l,dateTo:s}}function on(a){var i,c;const t=be(a),n=ue(String(((i=t[10])==null?void 0:i[26])??"")),l=ue(String(((c=t[10])==null?void 0:c[11])??""));if(n&&l)return{from:n,to:l};const s=[];for(let b=0;b<Math.min(15,t.length);b++){const u=t[b];if(u)for(let h=0;h<u.length;h++){const g=String(u[h]??"").trim(),N=ue(g);N&&s.push(N)}}return s.length>=2?(s.sort((b,u)=>b.getTime()-u.getTime()),{from:s[0],to:s[s.length-1]}):null}function ln(a){const t=be(a),{col:n,headerRow:l}=ke(t,Va,Ha),s=Ve(t,l,n,16);let i=0;for(let c=s;c<t.length;c++){const b=t[c];b&&String(b[n.employeeName]??"").trim()&&String(b[n.changeText]??"").trim().length>=30&&i++}return{newBookings:i}}function cn(a){var c;const t=be(a),{col:n,headerRow:l}=ke(t,Oa,qa),s=Ve(t,l,n,11);let i=0;for(let b=s;b<t.length;b++){const u=String(((c=t[b])==null?void 0:c[n.bookingNumber])??"").trim();u&&u.length>=3&&i++}return{bookings:i}}function dn(a){const t=be(a);let n=0,l=0;const{col:s,headerRow:i}=ke(t,Ua,Ka),c=Ve(t,i,s,14);for(let b=c;b<t.length;b++){const u=t[b];if(!u)continue;if(Ja(u)){n++;continue}const h=String(u[s.employeeName]??"").trim(),g=String(u[s.rent]??"").trim();h&&g&&h!=="المستخدم"&&h!=="المجموع"&&l++}return{bookings:n,units:l}}function xn(a){const t=be(a),n=15;let l=0;for(let s=n+1;s<t.length;s++){const i=t[s];if(!i)continue;const c=String(i[1]??"").trim();c&&c!=="المستخدم"&&l++}return{rows:l}}function mn(a,t){var h;const n=be(a),{col:l}=ke(n,za,Ga),s=new Set(["المجموع","اسم الموظف",""]),i=[];let c="",b=!1;for(let g=0;g<n.length;g++){const N=n[g];if(!N)continue;const M=String(N[0]??"").trim(),_=Bt(M);_&&(c=_);const A=String(N[l.bookingCount]??"").trim();if(A==="عدد الحجوزات"){b=!0;continue}const S=String(N[l.employeeName]??"").trim();if(S==="المجموع"){b=!1;continue}!b||!S||s.has(S)||(h=t.branches[c])!=null&&h.excluded||i.push({name:S,bookingCount:parseInt(A,10)||0,branch:c})}const u={};for(const g of i)u[g.name]=(u[g.name]||0)+g.bookingCount;return i.filter(g=>(u[g.name]||0)>=t.minBookingThreshold)}function pn(a){const t=a.match(/العميل\s*\(قديم\)\s*\(جديد\)\s*(.*?)\s*نوع/),n=t?t[1].trim():"",l=a.match(/الوحدات\s*\(قديم\)\s*\(جديد\)\s*(.*?)\s*الأسعار/),s=l?l[1].trim():"",i=a.matchAll(/\(\s*([\d,.]+)\s*SAR\s*\)/g);let c=0;for(const N of i)c+=parseFloat(N[1].replace(",",""))||0;const b=a.match(/تاريخ الدخول\s*\(قديم\)\s*\(جديد\)\s*(\d{2}\/\d{2}\/\d{4})/),u=b?b[1]:"",h=a.match(/تاريخ الخروج\s*\(قديم\)\s*\(جديد\)\s*(\d{2}\/\d{2}\/\d{4})/),g=h?h[1]:"";return{guest:n,unit:s,price:c,checkinDateStr:u,checkoutDateStr:g}}function un(a,t){const n=be(a),{col:l,headerRow:s}=ke(n,Va,Ha),i=Ve(n,s,l,16),c=[];for(let b=i;b<n.length;b++){const u=n[b];if(!u)continue;const h=String(u[l.employeeName]??"").trim(),g=String(u[l.changeText]??"").trim(),N=String(u[l.bookingInfo]??"").trim(),M=String(u[l.dateTime]??"").trim();if(!h||!g||g.length<30)continue;const _=N.match(/رقم الحجز[:\s]*(\d+)/),A=_?_[1]:"",S=/إنشاء\s*حجز|حجز\s*جديد|إضافة\s*حجز|تم\s*إنشاء/i.test(g),w=pn(g),O=Ya(M),T=O?Wa(O):"صباح",E=w.checkinDateStr?ue(w.checkinDateStr):null,I=w.checkoutDateStr?ue(w.checkoutDateStr):null;let q=1;E&&I&&I>E&&(q=Math.round((I.getTime()-E.getTime())/864e5)),c.push({employeeName:h,bookingNumber:A,creationDateTime:M,checkinDateStr:w.checkinDateStr,checkinDate:E,checkoutDateStr:w.checkoutDateStr,checkoutDate:I,nights:q,guestName:w.guest,roomUnit:w.unit,roomCategory:xt(w.unit),priceSAR:w.price,shift:T,branch:t,isCreation:S})}return c}function hn(a,t){const n=be(a),{col:l,headerRow:s}=ke(n,Oa,qa),i=Ve(n,s,l,16),c=[];for(let b=i;b<n.length;b++){const u=n[b];if(!u)continue;const h=String(u[l.bookingNumber]??"").trim();if(!h||h.length<3)continue;const g=String(u[l.employeeName]??"").trim();if(!g)continue;const N=String(u[l.bookingSource]??"").trim(),M=nn(N),_=String(u[l.guestName]??"").trim(),A=String(u[l.roomUnit]??"").replace(/\s+/g," ").trim(),S=parseFloat(String(u[l.rentOnly]??0))||0,w=parseFloat(String(u[l.totalPrice]??0))||0,O=S>0?S:w,T=parseInt(String(u[l.nights]??0))||1,E=String(u[l.checkInTime]??"").trim(),I=String(u[l.checkoutDate]??"").trim(),q=String(u[l.creationTime]??"").trim(),L=Ya(q),z=L?Wa(L):"صباح";c.push({employeeName:g,bookingNumber:h,bookingSource:M,guestName:_,roomUnit:A,priceSAR:O,nights:T,checkInTime:E,checkoutDateStr:I,creationTime:q,shift:z,branch:t})}return c}function Ja(a){for(let t=0;t<a.length;t++){const n=String(a[t]??"").trim();if(n.includes("رقم الحجز"))return n}return null}function gn(a,t){const n=be(a),{col:l,headerRow:s}=ke(n,Ua,Ka),i=Ve(n,s,l,14),c=[];let b="",u="";for(let h=i;h<n.length;h++){const g=n[h];if(!g)continue;const N=Ja(g);if(N){const q=N.match(/رقم الحجز\.\s*(\d+)/);b=q?q[1]:"";const L=N.split(" - ");u=L.length>0?L[L.length-1].trim():"";continue}const M=String(g[l.employeeName]??"").trim(),_=String(g[l.rent]??"").trim();if(!M||M==="المستخدم"||M==="المجموع"||!_)continue;const A=parseFloat(_)||0,S=parseInt(String(g[l.nights]??0))||1,w=String(g[l.checkoutDate]??"").trim(),O=String(g[l.checkInTime]??"").trim(),T=String(g[l.floor]??"").trim(),E=String(g[l.roomType]??"").trim(),I=String(g[l.roomUnit]??"").trim();b&&c.push({bookingNumber:b,guestName:u,employeeName:M,roomUnit:I,roomType:E,floor:T,priceSAR:A,nights:S,checkInTime:O,checkoutDateStr:w,branch:t})}return c}function bn(a){const t=new Map;for(const n of a)n.bookingNumber&&n.roomUnit&&t.set(`${n.bookingNumber}|${n.branch}`,n.roomUnit);return t}function fn(a,t){const n={};for(const l of a){if(!l.isCreation)continue;if(t){const i=ue(l.creationDateTime);if(!i||i<t.from||i>t.to)continue}const s=`${l.branch}|${l.employeeName}`;n[s]||(n[s]={صباح:0,مساء:0,ليل:0,total:0}),n[s].total++,l.shift==="صباح"?n[s].صباح++:l.shift==="مساء"?n[s].مساء++:n[s].ليل++}return n}function vn(a){const t=new Map;for(const n of a){const l=`${n.bookingNumber}|${n.branch}`;let s=t.get(l);s||(s={totalRent:0,unitCount:0,perUnitPrices:[]},t.set(l,s)),s.totalRent+=n.priceSAR,s.unitCount++,s.perUnitPrices.push({room:n.roomUnit,type:n.roomType,price:n.priceSAR,nights:n.nights})}return t}function yn(a,t,n){const l=parseInt(t,10),s=parseInt(n,10);if(isNaN(l)||isNaN(s)||Math.floor(l/100)===6||Math.floor(s/100)===6||Math.floor(l/100)!==Math.floor(s/100))return null;const i=[l%10,s%10].sort((c,b)=>c-b);for(const c of a){const[b,u]=c.digitPairs;if(i[0]===b&&i[1]===u)return c.label}return null}function jn(a,t,n){const l=n.branches[t];if(!l||l.mergedRules.length===0)return null;const s=a.match(/\d{3}/g);if(!s||s.length<2)return null;for(let i=0;i<s.length;i++)for(let c=i+1;c<s.length;c++){const b=yn(l.mergedRules,s[i],s[c]);if(b)return{mergeType:b,roomCount:s.length}}return null}function Nn(a,t,n,l,s,i){const c={},b={};for(const S of a){const w=`${S.branch}|${S.name}`;c[w]=(c[w]||0)+S.bookingCount,b[S.name]=(b[S.name]||0)+S.bookingCount}const u=s?s.to:null,h=[],g=new Set;for(const S of t){if(s){const w=ue(S.creationTime),O=ue(S.checkInTime),T=!w||w>=s.from&&w<=s.to,E=!O||O>=s.from&&O<=s.to;if(!T||!E)continue}if(h.push(S),u){const w=ue(S.checkoutDateStr);w&&w>u&&g.add(`${S.bookingNumber}|${S.branch}`)}}const N=new Set;for(const[S,w]of Object.entries(b))w<i.minBookingThreshold&&N.add(S);for(const S of h)S.employeeName in b||N.add(S.employeeName);const M=new Map;for(const S of h){const w=jn(S.roomUnit,S.branch,i);w&&S.bookingNumber&&M.set(`${S.bookingNumber}|${S.branch}`,w)}const _={};for(const S of h){if(N.has(S.employeeName))continue;const w=`${S.branch}|${S.employeeName}`;_[w]||(_[w]=[]),_[w].push(S)}const A=[];for(const[S,w]of Object.entries(_)){const O=c[S]||0,T=w.length;w.sort((E,I)=>{const q=g.has(`${E.bookingNumber}|${E.branch}`),L=g.has(`${I.bookingNumber}|${I.branch}`),z=xt(E.roomUnit)==="VIP",G=xt(I.roomUnit)==="VIP",o=E.shift==="ليل",d=I.shift==="ليل";return(q?2:z||o?0:1)-(L?2:G||d?0:1)}),w.forEach((E,I)=>{var te,H;const q=I>=O,L=E.roomUnit,z=E.nights||1,G=z>=i.monthlyNightsThreshold,o=n.get(`${E.bookingNumber}|${E.branch}`)||"",d=L&&((te=L.match(/\d{3}/))==null?void 0:te[0])||"",j=o&&((H=o.match(/\d{3}/))==null?void 0:H[0])||"",f=!!(j&&d&&j!==d),p=M.get(`${E.bookingNumber}|${E.branch}`),m=!!p,v=l.get(`${E.bookingNumber}|${E.branch}`),C=v&&v.totalRent>0?v.totalRent:E.priceSAR;let k=0,$="",F=0;if(m&&p){const W=i.branches[E.branch],Z=W==null?void 0:W.mergedRules.find(B=>B.label===p.mergeType);if(Z?($=p.mergeType+(G?" (شهري)":""),k=G?Z.monthlyMin:Z.dailyMin):($=p.mergeType,k=0),!(E.bookingSource==="بوكينج"||f)&&k>0){const B=k*z;F=C<B?B-C:0}}else{const W=_t(L),Z=Qs(i,E.branch,L,W,z);if($=Z.label,k=Z.minPrice,!(E.bookingSource==="بوكينج"||f)&&k>0){const B=k*z;F=C<B?B-C:0}}const D=z>0?C/z:0;let K="";q&&(O===0?K="بدون صلاحية":g.has(`${E.bookingNumber}|${E.branch}`)?K="لم يخرج":K="تجاوز العدد");const Y=E.checkInTime.split(" ")[0]||E.checkInTime;A.push({employeeName:E.employeeName,branch:E.branch,roomUnit:L,roomCategory:xt(L),shift:E.shift,bookingSource:E.bookingSource,priceSAR:C,checkInTime:Y,checkoutDateStr:E.checkoutDateStr.split(" ")[0]||E.checkoutDateStr,creationTime:E.creationTime,bookingNumber:E.bookingNumber,guestName:E.guestName,staffBookingCount:O,reportBookingCount:T,difference:T-O,isExcess:q,excessReason:K,nights:z,nightlyRate:Math.round(D*100)/100,minPrice:k,roomTypeLabel:$,priceShortfall:Math.round(F*100)/100,isMonthly:G,isMerged:m,mergedWithBooking:"",isRoomTransfer:f})})}return A}const It=/\d{1,2}:\d{2}(:\d{2})?/,ka=" -- ",wn=12,Sa=8,kn=4,Sn=5;function St(a){return It.test(a)}function Cn(a,t){const n=new Date(a);return t<6&&n.setDate(n.getDate()-1),n.toISOString().slice(0,10)}function Mn(a){var u,h;const t=String(a??"");if(!St(t))return{entryMins:null,exitMins:null};const n=t.indexOf(ka),l=n>=0?t.slice(0,n).trim():t.trim(),s=n>=0?t.slice(n+ka.length).trim():"",i=g=>{const N=g.match(/(\d{1,2}):(\d{2})/);return N?parseInt(N[1],10)*60+parseInt(N[2],10):null},c=l&&St(l)?i(((u=l.match(It))==null?void 0:u[0])??l):null,b=s&&St(s)?i(((h=s.match(It))==null?void 0:h[0])??s):null;return c!=null&&b!=null&&Math.abs(b-c)<Sn?{entryMins:c,exitMins:null}:{entryMins:c??null,exitMins:b??null}}function Dn(a,t){let n=(t-a)/60;return n<0&&(n+=24),Math.min(n,wn)}function En(a){const[t,n]=a.split("-").map(Number),s=new Date(t,n,0).getDate();return`${t}-${String(n).padStart(2,"0")}-${String(s).padStart(2,"0")}`}function Rn(a,t){const n=new Date(a),l=new Date(t);if(isNaN(n.getTime())||isNaN(l.getTime())||n>l)return 0;const s=l.getTime()-n.getTime();return Math.round(s/(24*60*60*1e3))+1}function Tn(a){const t=a.trim();if(!t)return null;const n=t.split(/\s*--\s*|\s+-\s+|\s+إلى\s+|\s+to\s+/i).map(c=>c.trim()).filter(Boolean);if(n.length<2)return null;const l=c=>{const u=c.includes("-")?"-":"/",h=c.match(new RegExp(`(\\d{1,4})${u}(\\d{1,2})${u}(\\d{1,4})`));if(!h)return null;const g=parseInt(h[1],10),N=parseInt(h[2],10),M=parseInt(h[3],10);return g>=1e3&&g<=9999?`${g}-${String(N).padStart(2,"0")}-${String(M).padStart(2,"0")}`:M>=1e3&&M<=9999?`${M}-${String(N).padStart(2,"0")}-${String(g).padStart(2,"0")}`:null},s=l(n[0]),i=l(n[n.length-1]);return!s||!i?null:[s,i]}function _n(a){if(a.length===0)return null;const t=new Map;for(const c of a){const b=c.workDateStr.slice(0,7);t.set(b,(t.get(b)??0)+1)}let n="",l=0;for(const[c,b]of t)b>l&&(l=b,n=c);if(!n)return null;const s=`${n}-01`,i=En(n);return[s,i]}function In(a,t){Ft(a);const n=$t(),l=n.read(a,{type:"array",cellDates:!0});let s="موظف",i="";const c=l.Sheets.Sheet1;if(c){const k=n.utils.sheet_to_json(c,{header:1,defval:""});for(const $ of k){const F=$||[];for(let D=0;D<F.length;D++){const K=String(F[D]??"").trim();K.indexOf("اسم الموظف")!==-1&&F[D+1]&&(s=String(F[D+1]).replace(/^\s*\d+\s*-\s*\(?/,"").replace(/\)?\s*-\s*\d+\s*$/,"").trim()),K.indexOf("تقرير عن")!==-1&&F[D+1]&&(i=String(F[D+1]??"").trim())}}}const b=l.Sheets.Sheet3;if(!b)return{fileName:t,employeeName:s,period:i,totalDaysInPeriod:0,totalWorkDays:0,validDays:0,incompleteDays:0,absentDays:0,permittedAbsence:0,reviewRequiredDays:0,totalNetHours:0,fingerprintAccuracy:0,days:[]};const u=n.utils.sheet_to_json(b,{header:1,defval:""}),h=u[0]||[],g=h.findIndex(k=>String(k??"").trim().indexOf("التاريخ")!==-1),N=h.findIndex(k=>String(k??"").trim().indexOf("الطابع الزمني")!==-1),M=h.findIndex(k=>String(k??"").trim().indexOf("الحالة")!==-1),_=g>=0?g:1,A=N>=0?N:5,S=M>=0?M:h.length-1,w=new Map;for(let k=1;k<u.length;k++){const $=u[k]||[];if(String($[S]??"").trim()==="الغياب المسموح")continue;const D=$[_],K=D instanceof Date?D:typeof D=="string"?new Date(D):null,Y=K&&!isNaN(K.getTime())?K:null;if(!Y)continue;const te=$[A],{entryMins:H,exitMins:W}=Mn(te);if(H==null&&W==null){const oe=Y.toISOString().slice(0,10);w.has(oe)||w.set(oe,[]);continue}const Z=H!=null?Math.floor(H/60):W!=null?Math.floor(W/60):-1,re=Cn(Y,Z>=0?Z:0),B=H!=null&&W==null||H==null&&W!=null;w.has(re)||w.set(re,[]),w.get(re).push({workDateStr:re,entryMins:H,exitMins:W,isOrphan:B})}const O=Array.from(w.keys()).sort(),T=[];let E=0,I=0,q=0,L=0,z=0;const G=new Set;for(let k=1;k<u.length;k++){const F=(u[k]||[])[_],D=F instanceof Date?F:typeof F=="string"?new Date(F):null;D&&!isNaN(D.getTime())&&G.add(D.toISOString().slice(0,10))}for(const k of O){const $=w.get(k),F=$.filter(B=>B.entryMins!=null),D=$.filter(B=>B.exitMins!=null),K=$.length,Y=F.length>0,te=D.length>0;let H="absent",W=0,Z=!1;if(Y&&te&&(K>=2||K===1&&$[0].entryMins!=null&&$[0].exitMins!=null)){const B=Math.min(...F.map(U=>U.entryMins)),oe=Math.max(...D.map(U=>U.exitMins));W=Dn(B,oe),H=W>=kn?"valid":"incomplete",H==="valid"?E++:I++,T.push({workDateStr:k,status:H,netHours:W,isOrphan:Z});continue}if(K===1){const B=$[0],oe=B.entryMins!=null?Math.floor(B.entryMins/60):B.exitMins!=null?Math.floor(B.exitMins/60):-1;let U=!1;if(B.entryMins!=null&&B.exitMins==null)H="incomplete",Z=!0,I++,W=Sa;else if(B.entryMins==null&&B.exitMins!=null){if(oe>=5&&oe<=10)continue;oe>=21||oe<=1?(H="incomplete",Z=!0,U=!0,I++,W=Sa):(H="review_required",Z=!0,z++)}T.push({workDateStr:k,status:H,netHours:W,isOrphan:Z,orphanNightExit:U});continue}K===0&&q++,T.push({workDateStr:k,status:H,netHours:W,isOrphan:Z})}for(const k of G){if(w.has(k))continue;const $=u.findIndex((F,D)=>D>0&&String((F==null?void 0:F[S])??"").trim()==="الغياب المسموح"&&new Date(F==null?void 0:F[_]).toISOString().slice(0,10)===k);$>0?L++:q++,T.push({workDateStr:k,status:$>0?"permitted_absence":"absent",netHours:0,isOrphan:!1})}T.sort((k,$)=>k.workDateStr.localeCompare($.workDateStr));let o=T,d=null,j=null;const f=Tn(i);if(f&&([d,j]=f),(!d||!j)&&T.length>0){const k=_n(T);k&&([d,j]=k)}if((!d||!j)&&G.size>0){const k=Array.from(G).sort();d=d??k[0],j=j??k[k.length-1]}d&&j&&(o=T.filter(k=>k.workDateStr>=d&&k.workDateStr<=j),E=o.filter(k=>k.status==="valid").length,I=o.filter(k=>k.status==="incomplete").length,q=o.filter(k=>k.status==="absent").length,L=o.filter(k=>k.status==="permitted_absence").length,z=o.filter(k=>k.status==="review_required").length);const p=E+I,m=d&&j?Rn(d,j):E+I+q+L+z,v=o.reduce((k,$)=>k+$.netHours,0),C=p>0?Math.round(E/p*100):0;return{fileName:t,employeeName:s,period:i,totalDaysInPeriod:m,totalWorkDays:p,validDays:E,incompleteDays:I,absentDays:q,permittedAbsence:L,reviewRequiredDays:z,totalNetHours:v,fingerprintAccuracy:C,days:o}}const An=Gs.buttons,Pn={default:"action-header-btn action-header-btn-default",red:"action-header-btn action-header-btn--red",cyan:"action-header-btn action-header-btn--cyan",primary:"action-header-btn action-header-btn--primary",amber:"action-header-btn action-header-btn--amber",violet:"action-header-btn action-header-btn--violet"},$n={settings:Pt,"log-out":_a,info:Ra,"file-text":Ea,"bar-chart3":Ct};function De({className:a=""}){const[t,n]=y.useState(()=>Je()),l=y.useCallback(()=>{La(),n(Je())},[]),s=t==="dark";return e.jsx("button",{type:"button",onClick:l,className:`p-2 rounded-xl border border-[var(--adora-border)] bg-[var(--adora-bg-card)] hover:bg-[var(--adora-hover-bg)] text-[var(--adora-text)] transition-[background-color,color,border-color] duration-300 ease-out ${a}`,title:s?"تفعيل الوضع الفاتح":"تفعيل الوضع الداكن","aria-label":s?"تفعيل الوضع الفاتح":"تفعيل الوضع الداكن",children:s?e.jsx(Ts,{className:"w-5 h-5 text-[var(--adora-accent)]"}):e.jsx(Ta,{className:"w-5 h-5 text-[var(--adora-accent)]"})})}const Ln=/\.xlsx?$/i;function Fn(a){return a.size>Lt?{ok:!1,error:`حجم الملف يتجاوز الحد المسموح (10 ميجابايت): ${a.name}`}:Ln.test(a.name)?{ok:!0}:{ok:!1,error:`نوع الملف غير مدعوم (استخدم .xlsx أو .xls): ${a.name}`}}function Ca(a){return new Promise((t,n)=>{const l=new FileReader;l.onload=()=>t(l.result),l.onerror=n,l.readAsArrayBuffer(a)})}function Be({label:a,value:t,options:n,onChange:l}){return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm text-slate-400 font-medium",children:a}),e.jsxs("select",{value:t,onChange:s=>l(s.target.value),className:`border border-white/10 text-sm rounded-xl px-3 py-2
                   focus:ring-2 focus:ring-[var(--adora-focus-border)] focus:border-[var(--adora-focus-border)] outline-none transition-all`,style:{colorScheme:"dark"},children:[e.jsx("option",{value:"",children:"الكل"}),n.map(s=>e.jsx("option",{value:s,children:s},s))]})]})}const ce=Ar(),Bn=[ce.display({id:"status",header:"",cell:a=>a.row.original.isExcess?e.jsx(Es,{className:"w-3.5 h-3.5 text-amber-500/70"}):e.jsx(Ia,{className:"w-3.5 h-3.5 text-emerald-500/60"}),size:24}),ce.accessor("employeeName",{header:"الموظف",size:90,cell:a=>e.jsx("span",{className:"font-medium text-[var(--adora-text)] truncate block text-sm",children:a.getValue()})}),ce.accessor("branch",{header:"الفرع",size:60,cell:a=>e.jsx("span",{className:"px-1.5 py-0.5 rounded-full text-[14px] font-medium badge-adora",children:a.getValue()})}),ce.accessor("bookingNumber",{header:"رقم الحجز",size:65,cell:a=>e.jsx("span",{className:"text-[var(--adora-text-secondary)] font-mono text-sm",children:a.getValue()})}),ce.accessor("guestName",{header:"العميل",size:100,cell:a=>e.jsx("span",{className:"text-[var(--adora-text)] text-sm truncate block",children:a.getValue()||"—"})}),ce.accessor("roomUnit",{header:"الوحدة",size:90,cell:a=>e.jsx("span",{className:"text-[var(--adora-text-secondary)] text-sm truncate block",children:a.getValue()||"—"})}),ce.accessor("roomCategory",{header:"التصنيف",size:46,cell:a=>a.getValue()==="VIP"?e.jsxs("span",{className:"px-1.5 py-0.5 rounded-full text-[14px] font-bold badge-warning flex items-center gap-0.5 w-fit",children:[e.jsx(Dt,{className:"w-2.5 h-2.5"}),"VIP"]}):e.jsx("span",{className:"px-1.5 py-0.5 rounded-full text-[14px] font-medium badge-muted",children:"عادي"})}),ce.accessor("bookingSource",{header:"المصدر",size:52,cell:a=>{const t=a.getValue(),n={استقبال:"badge-success",بوكينج:"badge-warning","غير محدد":"badge-muted"};return e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[14px] font-medium ${n[t]||"badge-muted"}`,children:t})}}),ce.accessor("shift",{header:"الشفت",size:44,cell:a=>{const t=a.getValue(),n={صباح:"badge-warning",مساء:"badge-adora",ليل:"badge-muted"};return e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-[14px] font-medium ${n[t]||"badge-muted"}`,children:t})}}),ce.accessor("priceSAR",{header:"السعر",size:70,cell:a=>{const t=a.row.original;return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[var(--adora-success)] font-mono text-sm font-semibold",children:a.getValue().toLocaleString("en-SA")}),t.isMerged&&e.jsxs("span",{title:`دمج مع حجز ${t.mergedWithBooking}`,className:"flex items-center gap-0.5 px-1 py-0.5 rounded text-[8px] font-bold badge-adora",children:[e.jsx(ms,{className:"w-2.5 h-2.5"}),"دمج"]})]})}}),ce.accessor("nights",{header:"ليالي",size:55,cell:a=>{const t=a.row.original;return e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:"text-[var(--adora-text-secondary)] font-mono text-sm flex items-center gap-0.5",children:[e.jsx(Ta,{className:"w-2.5 h-2.5 opacity-60"}),t.nights,t.isMonthly&&e.jsx("span",{className:"px-1 py-0 rounded text-[8px] font-bold badge-adora mr-0.5",children:"شهري"})]}),e.jsxs("span",{className:"text-[var(--adora-text-secondary)] font-mono text-[14px]",children:[t.nightlyRate.toLocaleString("en-SA"),"/ل"]})]})}}),ce.accessor("priceShortfall",{header:"تنبيه",size:60,cell:a=>{const t=a.row.original;return t.isExcess||!t.minPrice?e.jsx("span",{className:"text-[var(--adora-text-secondary)]",children:"—"}):t.isRoomTransfer?e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold badge-adora whitespace-nowrap",children:"↔ نقل"}):t.priceShortfall<=0?e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold badge-success",children:"✓ سليم"}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mt,{className:"w-3 h-3 text-[var(--adora-error)] shrink-0"}),e.jsxs("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold badge-error whitespace-nowrap",children:["▼ ",t.priceShortfall.toLocaleString("en-SA")]})]})}}),ce.accessor("roomTypeLabel",{header:"الغرفة",size:65,cell:a=>{const t=a.getValue();return!t||t==="غير مصنف"||t==="غير محدد"?e.jsx("span",{className:"text-[var(--adora-text-secondary)] text-[14px]",children:"—"}):e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-medium badge-muted",children:t})}}),ce.accessor("checkInTime",{header:"الدخول",size:68,cell:a=>e.jsx("span",{className:"text-[var(--adora-text-secondary)] text-[15px] font-mono",children:a.getValue()})}),ce.accessor("isExcess",{header:"الحالة",size:50,cell:a=>a.getValue()?e.jsx("span",{className:"px-1.5 py-0.5 rounded-full text-[14px] font-bold badge-warning",children:"زيادة"}):e.jsx("span",{className:"px-1.5 py-0.5 rounded-full text-[14px] font-bold badge-success",children:"محسوب"})}),ce.accessor("excessReason",{header:"السبب",size:60,cell:a=>{const t=a.getValue();if(!t)return e.jsx("span",{className:"text-[var(--adora-text-secondary)]",children:"—"});const n={"تجاوز العدد":"badge-warning","بدون صلاحية":"badge-warning","لم يخرج":"badge-adora"},l={"تجاوز العدد":"⚡","بدون صلاحية":"🚫","لم يخرج":"🏨"};return e.jsxs("span",{className:`px-1.5 py-0.5 rounded text-[14px] font-medium ${n[t]||"badge-muted"}`,children:[l[t]||""," ",t]})}})],ge={data:"adora_analysis_data",staffList:"adora_analysis_staffList",dateRange:"adora_analysis_dateRange",analyzed:"adora_analysis_analyzed",logCreationShiftCounts:"adora_analysis_logCreationShiftCounts"};function it(){const a=Rr().some(t=>t.name===wt)?Tr(wt):_r(Vs,wt);return Ir(a)}function Ma(a){if(!a)return!1;const t=a.trim().toLowerCase();return Os.includes(t)}function On(a,t,n,l){try{localStorage.setItem(ge.data,JSON.stringify(a)),localStorage.setItem(ge.staffList,JSON.stringify(t)),localStorage.setItem(ge.dateRange,JSON.stringify(n)),localStorage.setItem(ge.analyzed,"true"),l&&localStorage.setItem(ge.logCreationShiftCounts,JSON.stringify(l))}catch(s){console.warn("⚠️ Failed to save analysis to localStorage:",s)}}function Vn(){try{if(localStorage.getItem(ge.analyzed)!=="true")return null;const a=JSON.parse(localStorage.getItem(ge.data)||"[]"),t=JSON.parse(localStorage.getItem(ge.staffList)||"[]"),n=JSON.parse(localStorage.getItem(ge.dateRange)||"null"),l=JSON.parse(localStorage.getItem(ge.logCreationShiftCounts)||"{}");return!Array.isArray(a)||a.length===0?null:{data:a,staffList:t,dateRange:n,analyzed:!0,logCreationShiftCounts:l}}catch{return null}}function zn(){Object.values(ge).forEach(a=>localStorage.removeItem(a))}function Un(){const[a,t]=y.useState("checking"),[,n]=y.useState(""),[l,s]=y.useState(()=>{try{return(localStorage.getItem(Nt)||"").toLowerCase()}catch{return""}}),[i,c]=y.useState(""),[b,u]=y.useState(""),[h,g]=y.useState(!1),[N,M]=y.useState(!1),[_,A]=y.useState(!1),[S,w]=y.useState(""),[O,T]=y.useState(""),[E,I]=y.useState(""),[q,L]=y.useState(""),[z,G]=y.useState(""),[o,d]=y.useState("checking"),j=y.useMemo(()=>typeof window>"u"?"":new URLSearchParams(window.location.search).get("admin")||"",[]),f=y.useMemo(()=>{if(typeof window>"u")return null;const x=(window.location.pathname||"").match(/^\/(supervisor|hr|accounting|manager)\/([^/]+)\/([^/]+)\/?$/);if(!x)return null;const[,R,P,X]=x;return(window.location.origin||"")+"/rewards"+"?role="+encodeURIComponent(R)+"&token="+encodeURIComponent(P)+"&period="+encodeURIComponent(X)},[]);y.useEffect(()=>{f&&window.location.href!==f&&window.location.replace(f)},[f]);const p=j===Bs;y.useEffect(()=>{if(!p){t("signed_out");return}const r=it(),x=Sr(r,async R=>{if(!R){t("signed_out"),n(""),localStorage.removeItem(ot);return}if(!Ma(R.email)){await jt(r).catch(()=>{}),u("الحساب غير مخوّل للإدارة."),t("signed_out"),n(""),localStorage.removeItem(ot);return}const P=(R.email||"").toLowerCase();n(P),s(P),localStorage.setItem(ot,JSON.stringify({email:P,ts:Date.now()})),localStorage.setItem(Nt,P),t("signed_in"),u("")});return()=>x()},[p]),y.useEffect(()=>{if(!p){d("blocked");return}a==="signed_in"&&d("analysis")},[p,a]);const m=y.useCallback(async()=>{if(!l.trim()||!i){u("اكتب الإيميل وكلمة المرور.");return}g(!0),u("");try{const r=it();await Cr(r,Mr);const x=await Dr(r,l.trim(),i);if(!Ma(x.user.email))throw await jt(r),new Error("UNAUTHORIZED_ADMIN");localStorage.setItem(Nt,l.trim().toLowerCase()),c("")}catch(r){const x=(r==null?void 0:r.code)||(r==null?void 0:r.message)||"";String(x).includes("UNAUTHORIZED_ADMIN")?u("هذا الحساب ليس ضمن حسابات الأدمن المصرح بها."):String(x).includes("auth/invalid-credential")||String(x).includes("auth/wrong-password")||String(x).includes("auth/user-not-found")?u("بيانات الدخول غير صحيحة."):String(x).includes("auth/too-many-requests")?u("محاولات كثيرة. انتظر دقيقة وحاول مرة أخرى."):String(x).includes("API_KEY_HTTP_REFERRER_BLOCKED")||String(x).toLowerCase().includes("referer")&&String(x).toLowerCase().includes("blocked")?u("دخول Firebase مرفوض لأن localhost غير مضاف في API key restrictions. أضف localhost ثم حاول مرة أخرى."):String(x).includes("API_KEY_SERVICE_BLOCKED")||String(x).toLowerCase().includes("identitytoolkit")||String(x).toLowerCase().includes("service")&&String(x).toLowerCase().includes("blocked")?u("دخول Firebase مرفوض لأن خدمة Authentication محظورة في API restrictions. غيّرها إلى Don't restrict key أو اسمح identitytoolkit."):u("تعذر تسجيل الدخول الآن. حاول مرة أخرى.")}finally{g(!1)}},[l,i]),v=y.useCallback(async()=>{if(!S.trim()){T("اكتب الإيميل أولًا.");return}try{await Er(it(),S.trim()),T("تم إرسال رابط استعادة كلمة المرور على الإيميل.")}catch{T("تعذر إرسال الرابط الآن. تأكد من الإيميل وحاول مرة أخرى.")}},[S]),C=y.useCallback((r,x)=>{const R=/[\u0600-\u06FF]/.test(r),P=/[A-Z]/.test(r),X=/[^a-z0-9@._-]/.test(r),ae=r.toLowerCase().replace(/[^a-z0-9@._-]/g,""),fe=R||P||X?"مسموح فقط: حروف إنجليزية صغيرة + أرقام + @ . _ - (بدون عربي أو Capital).":"";x==="login"?(s(ae),I(fe)):(w(ae),L(fe))},[]),[k,$]=y.useState(()=>ya()),F=y.useRef(null),D=y.useRef(null),K=y.useRef(null);y.useEffect(()=>{Le(async()=>{const{loadConfigFromFirebase:r}=await import("./firebase-cj8VFPmH.js");return{loadConfigFromFirebase:r}},__vite__mapDeps([0,1,2,3])).then(({loadConfigFromFirebase:r})=>{r({forceFetch:!0}).then(x=>{x&&($(x),kt(x))}).catch(()=>{})}).catch(()=>{})},[]),y.useEffect(()=>{const r=x=>{var P;if(((P=x.data)==null?void 0:P.type)!=="ADORA_REQUEST_PAYLOAD"||!x.source)return;const R=F.current;if(R)try{x.source.postMessage(R,x.origin||"*")}catch{}};return window.addEventListener("message",r),()=>window.removeEventListener("message",r)},[]);const[Y,te]=y.useState({}),[H,W]=y.useState([]),[Z,re]=y.useState(!1),[B,oe]=y.useState(!0),[U]=y.useState(()=>Vn()),[J,Ot]=y.useState(()=>(U==null?void 0:U.data)??[]),[Xe,Vt]=y.useState(()=>(U==null?void 0:U.staffList)??[]),[Ze,zt]=y.useState(()=>(U==null?void 0:U.dateRange)??null),[Xa,Za]=y.useState(()=>(U==null?void 0:U.logCreationShiftCounts)??{}),[Se,Ut]=y.useState(!1),[ve,_e]=y.useState(()=>(U==null?void 0:U.analyzed)??!1),[Qa,pt]=y.useState(!1),[er,tr]=y.useState([]),[ze,qt]=y.useState(""),[Ue,Ht]=y.useState(""),[qe,Gt]=y.useState(""),[He,Kt]=y.useState(""),[Ge,Wt]=y.useState(""),[Ke,Yt]=y.useState(""),[We,Jt]=y.useState(""),[Ie,Qe]=y.useState(!1),[Ae,et]=y.useState(!1),[Pe,ut]=y.useState(!1),[ar,Xt]=y.useState(!1),[rr,Zt]=y.useState(!1),[sr,Qt]=y.useState(!1),[nr,ea]=y.useState(!1),[or,ta]=y.useState(!1),[ye,ht]=y.useState(null),[lr,gt]=y.useState(!1),[tt,at]=y.useState(null),ir=y.useCallback(async r=>{const x=Array.from(r).filter(R=>/\.xls$/i.test(R.name)||/\.xlsx$/i.test(R.name));if(x.length===0){alert("اختر ملفات Excel (تقارير حضور فريق العمل — .xls أو .xlsx)");return}gt(!0),ht(null);try{const R=await Le(()=>import("./xlsx-B2eTCt_Q.js"),[]);Na(R)}catch(R){gt(!1),alert(`تعذّر تحميل مكتبة Excel.
`+(R instanceof Error?R.message:String(R)));return}try{const R=[];for(const P of x)if(!(P.size>Lt))try{const X=await Ca(P),ae=In(X,P.name);R.push(ae)}catch{R.push({fileName:P.name,employeeName:"—",period:"",totalDaysInPeriod:0,totalWorkDays:0,validDays:0,incompleteDays:0,absentDays:0,permittedAbsence:0,reviewRequiredDays:0,totalNetHours:0,fingerprintAccuracy:0,days:[]})}ht(R),ta(!0),K.current&&(K.current.value="")}finally{gt(!1)}},[]),aa=y.useCallback(async r=>{var fe;const x=Array.from(r);if(x.length===0)return;re(!0),_e(!1);const R={...Y},P=[...H],X=[];let ae=k;try{const le=await Le(()=>import("./xlsx-B2eTCt_Q.js"),[]);Na(le)}catch(le){re(!1),alert(`تعذّر تحميل مكتبة قراءة Excel. جرّب تحديث الصفحة.
`+(le instanceof Error?le.message:String(le)));return}try{for(const ee of x){const Ne=Fn(ee);if(!Ne.ok){P.push(ee.name),Ne.error&&X.push(Ne.error);continue}try{const xe=await Ca(ee),se=sn(xe);if(se.baseType==="unknown"){P.push(ee.name);continue}if(se.baseType==="staff"){const ie=tn(xe);for(const Nr of ie)ae=ja(ae,Nr)}se.branch&&(ae=ja(ae,se.branch));let ne=null;if(se.baseType==="staff"){const ie=wa(xe);ne=`${ie.activeEmployees} موظف نشط • ${ie.dateFrom} → ${ie.dateTo}`}else if(se.baseType==="log")ne=`${ln(xe).newBookings} حجز جديد`;else if(se.baseType==="report")ne=`${cn(xe).bookings} حجز`;else if(se.baseType==="units"){const ie=dn(xe);ne=`${ie.bookings} حجز • ${ie.units} وحدة`}else se.baseType==="actualDates"&&(ne=`${xn(xe).rows} صف`);R[se.slotKey]={slotKey:se.slotKey,baseType:se.baseType,branch:se.branch,file:ee,buffer:xe,stats:ne}}catch{P.push(ee.name)}}X.length>0&&alert(X.length===1?X[0]:X.join(`
`));const le=ya();let Q=ae;for(const ee of Object.keys(ae.branches))((fe=le.branches[ee])==null?void 0:fe.excluded)===!0&&(Q={...Q,branches:{...Q.branches,[ee]:{...Q.branches[ee],excluded:!0}}});for(const ee of Object.keys(le.branches))Q.branches[ee]||(Q={...Q,branches:{...Q.branches,[ee]:{...le.branches[ee]}}});Q!==k&&($(Q),kt(Q),Le(async()=>{const{saveConfigToFirebase:ee}=await import("./firebase-cj8VFPmH.js");return{saveConfigToFirebase:ee}},__vite__mapDeps([0,1,2,3])).then(({saveConfigToFirebase:ee})=>ee(Q).catch(()=>{}))),te(R),W(P),re(!1)}catch(le){re(!1),alert(`حدث خطأ أثناء معالجة الملفات:
`+(le instanceof Error?le.message:String(le)))}},[Y,H,k]),cr=y.useCallback(r=>{te(x=>{const R={...x};return delete R[r],R}),_e(!1)},[]),rt=y.useCallback(()=>{te({}),W([]),_e(!1),Ot([]),Vt([]),zt(null),zn()},[]),dr=y.useCallback(async()=>{rt();try{await jt(it())}catch{}try{localStorage.removeItem(ot),localStorage.removeItem("adora_transfer_payload")}catch{}t("signed_out")},[rt]),bt=y.useMemo(()=>{const r=new Set;for(const x of Object.values(Y))x.branch&&r.add(x.branch);return[...r].sort()},[Y]),ft=y.useMemo(()=>{const r=[{key:"staff",baseType:"staff",branch:"",required:!0}];for(const x of bt)r.push({key:`report-${x}`,baseType:"report",branch:x,required:!0}),r.push({key:`actualDates-${x}`,baseType:"actualDates",branch:x,required:!0}),r.push({key:`log-${x}`,baseType:"log",branch:x,required:!1}),r.push({key:`units-${x}`,baseType:"units",branch:x,required:!1});return r},[bt]),je=Object.keys(Y).length,me=je>0&&je===ft.length,vt=!!Y.staff,ra=Object.values(Y).some(r=>r.baseType==="report"),pe=vt&&ra;y.useEffect(()=>{me&&oe(!0)},[me]);const Ye=y.useCallback(async()=>{var r;if(pe){Ut(!0),pt(!1),await new Promise(x=>setTimeout(x,100)),pt(!0);try{const x=Y.staff.buffer,R=mn(x,k),P=[],X=[],ae=[];for(const ne of Object.values(Y)){if(!ne.buffer||ne.baseType==="staff")continue;const ie=ne.branch;ie&&((r=k.branches[ie])!=null&&r.excluded||(ne.baseType==="report"?P.push(...hn(ne.buffer,ie)):ne.baseType==="log"?X.push(...un(ne.buffer,ie)):ne.baseType==="units"&&ae.push(...gn(ne.buffer,ie))))}const fe=bn(X),le=vn(ae),Q=on(x),ee=fn(X,Q);Za(ee);const Ne=Nn(R,P,fe,le,Q,k),xe=wa(x);await new Promise(ne=>setTimeout(ne,2e3)),Vt(R),Ot(Ne);const se={from:xe.dateFrom,to:xe.dateTo};zt(se),_e(!0),On(Ne,R,se,ee)}catch(x){console.error("Analysis error:",x),alert("خطأ في التحليل. تأكد من صحة الملفات.")}Ut(!1),pt(!1)}},[pe,Y,k]),[sa,na]=y.useState(!1),oa=y.useCallback(r=>{$(r),kt(r),Le(async()=>{const{saveConfigToFirebase:x}=await import("./firebase-cj8VFPmH.js");return{saveConfigToFirebase:x}},__vite__mapDeps([0,1,2,3])).then(({saveConfigToFirebase:x})=>x(r).catch(()=>{})),ea(!1),ve&&pe&&na(!0)},[ve,pe]);y.useEffect(()=>{sa&&pe&&!Se&&(na(!1),Ye())},[sa,pe,Se,Ye]),y.useEffect(()=>{!me||!pe||ve||Se||Ye()},[me,pe,ve,Se,Ye]);const Ce=y.useMemo(()=>J.filter(r=>!r.isExcess),[J]),st=y.useMemo(()=>J.filter(r=>r.isExcess),[J]),xr=y.useMemo(()=>[...new Set(J.map(r=>r.branch))],[J]),mr=y.useMemo(()=>[...new Set(J.map(r=>r.shift))],[J]),pr=y.useMemo(()=>[...new Set(J.map(r=>r.bookingSource))],[J]),ur=y.useMemo(()=>[...new Set(J.map(r=>r.roomUnit).filter(Boolean))].sort(),[J]),hr=y.useMemo(()=>[...new Set(J.map(r=>r.employeeName))].sort(),[J]),gr=y.useMemo(()=>[...new Set(J.map(r=>r.roomCategory))],[J]),yt=y.useMemo(()=>{let r=J;if(Ue&&(r=r.filter(x=>x.branch===Ue)),qe&&(r=r.filter(x=>x.shift===qe)),He&&(r=r.filter(x=>x.bookingSource===He)),Ge&&(r=r.filter(x=>x.roomUnit===Ge)),Ke&&(r=r.filter(x=>x.employeeName===Ke)),We&&(r=r.filter(x=>x.roomCategory===We)),Ie&&(r=r.filter(x=>x.isExcess)),Ae&&(r=r.filter(x=>!x.isExcess)),Pe&&(r=r.filter(x=>!x.isExcess&&x.priceShortfall>0)),ze){const x=ze.toLowerCase();r=r.filter(R=>R.employeeName.toLowerCase().includes(x)||R.guestName.toLowerCase().includes(x)||R.roomUnit.toLowerCase().includes(x)||R.bookingNumber.includes(x))}return r},[J,Ue,qe,He,Ge,Ke,We,Ie,Ae,Pe,ze]),he=Pr({data:yt,columns:Bn,state:{sorting:er},onSortingChange:tr,getCoreRowModel:Br(),getFilteredRowModel:Fr(),getSortedRowModel:Lr(),getPaginationRowModel:$r(),initialState:{pagination:{pageSize:25}}}),br=()=>{Ht(""),Gt(""),Kt(""),Wt(""),Yt(""),Jt(""),Qe(!1),et(!1),ut(!1),qt("")},fr=Ue||qe||He||Ge||Ke||We||Ie||Ae||Pe||ze,nt=y.useMemo(()=>Xe.reduce((r,x)=>r+x.bookingCount,0),[Xe]),Me=y.useMemo(()=>Ce.filter(r=>r.priceShortfall>0),[Ce]),vr=y.useMemo(()=>Me.reduce((r,x)=>r+x.priceShortfall,0),[Me]),la=y.useMemo(()=>Ce.filter(r=>r.isMerged).length,[Ce]),yr=nt>0?(Ce.length/nt*100).toFixed(1):"0",$e=y.useMemo(()=>{const r={"تجاوز العدد":0,"بدون صلاحية":0,"لم يخرج":0};for(const x of st)x.excessReason&&(r[x.excessReason]=(r[x.excessReason]||0)+1);return r},[st]),jr=y.useCallback(r=>{r.preventDefault();const x=(z||"").trim();if(!x)return;const R=new URL(window.location.href);R.searchParams.set("admin",x),window.location.href=R.pathname+R.search},[z]);return f?e.jsxs("div",{dir:"rtl",className:"min-h-screen text-[var(--adora-text)] relative flex items-center justify-center px-4",children:[e.jsx(De,{className:"fixed top-4 left-4 z-[100]"}),e.jsxs("div",{className:"glass rounded-2xl border border-white/15 p-6 max-w-xl w-full text-center",children:[e.jsx("h2",{className:"text-xl font-black text-turquoise mb-2",children:"جاري التحويل"}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)] leading-7",children:"تحويلك إلى شاشة المكافآت بحسب صلاحيات الرابط..."})]})]}):j===""?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"fixed top-4 left-4 z-[100]"}),e.jsx(Us,{gateKey:z,setGateKey:G,onSubmit:jr})]}):p?a==="checking"?e.jsxs("div",{dir:"rtl",className:"min-h-screen text-[var(--adora-text)] relative flex items-center justify-center px-4",children:[e.jsx(De,{className:"fixed top-4 left-4 z-[100]"}),e.jsxs("div",{className:"glass rounded-2xl border border-white/15 p-6 max-w-xl w-full text-center",children:[e.jsx("h2",{className:"text-xl font-black text-turquoise mb-2",children:"جاري التحقق من الجلسة"}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)] leading-7",children:"لحظات من فضلك..."})]})]}):a==="signed_out"?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"fixed top-4 left-4 z-[100]"}),e.jsx(qs,{loginEmail:l,onLoginEmailChange:C,loginPassword:i,setLoginPassword:c,showPassword:_,setShowPassword:A,loginEmailWarning:E,authError:b,loginLoading:h,onSubmit:m,showReset:N,onOpenReset:()=>{M(r=>!r),T(""),w(l),L("")},resetEmail:S,resetEmailWarning:q,resetStatus:O,onResetPassword:v})]}):o==="checking"||o==="redirecting"?e.jsxs("div",{dir:"rtl",className:"min-h-screen text-[var(--adora-text)] relative flex items-center justify-center px-4",children:[e.jsx(De,{className:"fixed top-4 left-4 z-[100]"}),e.jsx("div",{className:"fixed inset-0 bg-[var(--adora-overlay-bg)] backdrop-blur-md z-[100] flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-20 bg-cyan-500/10 rounded-full blur-3xl animate-pulse pointer-events-none"}),e.jsx("div",{className:"absolute -inset-14 bg-teal-500/5 rounded-full blur-2xl pointer-events-none"}),e.jsxs("div",{className:"relative bg-[var(--adora-modal-bg)] backdrop-blur-xl border border-[var(--adora-border)] rounded-3xl px-8 sm:px-12 py-10 text-center modal-no-side-shadow max-w-md mx-auto",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-6",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-transparent border-t-cyan-400 border-r-cyan-400/40 animate-spin"}),e.jsx("div",{className:"absolute inset-1.5 rounded-full border-2 border-transparent border-b-teal-400/60 border-l-teal-400/20 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(ma,{className:"w-7 h-7 text-[var(--adora-accent)] animate-pulse"})})]}),e.jsx("h2",{className:"text-xl font-black text-[var(--adora-accent)] mb-2",children:o==="redirecting"?"جاري فتح شاشة المكافآت":"جاري فحص حالة الفترة"}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)] leading-7",children:"إذا كانت الفترة مفتوحة سيتم تحويلك تلقائياً إلى شاشة المكافآت، وإذا كانت مغلقة ستظهر صفحة رفع الملفات."})]})]})})]}):e.jsxs("div",{dir:"rtl",className:"min-h-screen text-[var(--adora-text)] relative",children:[e.jsx("div",{className:"particles-bg"}),Se&&e.jsx("div",{className:"fixed inset-0 bg-[var(--adora-overlay-bg)] backdrop-blur-md z-100 flex items-center justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-20 bg-cyan-500/10 rounded-full blur-3xl animate-pulse pointer-events-none"}),e.jsx("div",{className:"absolute -inset-14 bg-teal-500/5 rounded-full blur-2xl pointer-events-none"}),e.jsxs("div",{className:"relative bg-[var(--adora-modal-bg)] backdrop-blur-xl border border-[var(--adora-border)] rounded-3xl px-12 py-10 text-center modal-no-side-shadow max-w-sm mx-auto",children:[e.jsxs("div",{className:"relative w-20 h-20 mx-auto mb-6",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-transparent border-t-cyan-400 border-r-cyan-400/40 animate-spin"}),e.jsx("div",{className:"absolute inset-1.5 rounded-full border-2 border-transparent border-b-teal-400/60 border-l-teal-400/20 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Ct,{className:"w-8 h-8 text-[var(--adora-accent)] animate-pulse"})})]}),e.jsx("h3",{className:"text-lg font-bold text-[var(--adora-text)] mb-2",children:"جاري التحليل"}),e.jsxs("p",{className:"text-[13px] text-[var(--adora-text-secondary)] mb-6 leading-relaxed",children:["المرجع: تقرير إحصائيات الموظفين",e.jsx("br",{}),e.jsx("span",{className:"text-[var(--adora-text-secondary)]",children:"الفلتر: تاريخ الإنشاء + الدخول"})]}),e.jsx("div",{className:"w-full h-1.5 bg-slate-800/80 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-cyan-500 via-teal-400 to-cyan-500 rounded-full transition-all ease-out bg-[length:200%_100%] animate-[shimmer_1.5s_ease-in-out_infinite]",style:{width:Qa?"100%":"0%",transitionDuration:"2200ms"}})})]})]})}),e.jsx("header",{className:"px-3 sm:px-5 pt-3 sm:pt-4 animate-in",children:e.jsx("div",{className:"max-w-[1440px] mx-auto glass rounded-2xl sm:rounded-[30px] md:rounded-[40px] border-r-4 sm:border-r-6 md:border-r-8 border-[var(--adora-accent)] p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-5",children:[e.jsx(De,{className:"flex-shrink-0 self-center order-first sm:order-first"}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 md:gap-5 w-full sm:w-auto",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:"/rewards/unnamed.png",alt:"إليت",className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 object-contain rounded-lg",style:{maxWidth:"80px",maxHeight:"80px"},onError:r=>{r.target.style.display="none"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-[var(--adora-text)] truncate typography-h1",children:"مكافآت فريق عمل فندق إليت"}),e.jsx("p",{className:"header-sub text-[var(--adora-text-secondary)] mt-1 sm:mt-2 font-semibold",children:ve&&Ze?e.jsxs(e.Fragment,{children:["الفترة: ",e.jsxs("span",{className:"text-[var(--adora-accent)] font-bold",children:[Ze.from," → ",Ze.to]})]}):"تحليل الحجوزات — المرجع: تقرير إحصائيات الموظفين"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 w-full sm:w-auto justify-end items-center action-header-btns-container",children:[An.filter(r=>!(r.hidden||r.context!=="analysis"&&r.context!=="both"||["methodology","ratingExplanation","conditions"].includes(r.id)&&!ve)).map(r=>{const x=r.iconId?$n[r.iconId]:null,R=r.actionType==="settings"?()=>ea(!0):r.actionType==="logout"?dr:r.actionType==="methodology"?()=>Xt(!0):r.actionType==="ratingExplanation"?()=>Zt(!0):r.actionType==="conditions"?()=>Qt(!0):void 0;return e.jsxs("button",{onClick:R,className:Pn[r.variant],title:r.title??void 0,children:[x&&e.jsx(x,{className:"w-4 h-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:r.label}),e.jsx("span",{className:"sm:hidden",children:r.labelShort??r.label})]},r.id)}),e.jsxs("button",{type:"button",onClick:()=>{var r;return(r=K.current)==null?void 0:r.click()},className:"action-header-btn action-header-btn--cyan",title:"رفع تقارير حضور فريق العمل (TeamAttendanceReport.xls) وعرض النتيجة",children:[e.jsx(ba,{className:"w-4 h-4 shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"رفع تقارير الحضور"}),e.jsx("span",{className:"sm:hidden",children:"الحضور"})]}),e.jsx("input",{ref:K,type:"file",accept:".xls,.xlsx",multiple:!0,"aria-label":"رفع تقارير الحضور",className:"sr-only",onChange:r=>{const x=r.target.files;x&&x.length>0&&ir(x)}})]})]})})}),e.jsxs("main",{className:"max-w-[1440px] mx-auto px-3 sm:px-5 md:px-6 py-6 sm:py-8 space-y-6 sm:space-y-8 relative z-10",children:[!ve&&!Se&&e.jsx(e.Fragment,{children:e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{role:"button",tabIndex:0,onKeyDown:r=>{var x;(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),(x=D.current)==null||x.click())},onDragOver:r=>{r.preventDefault()},onDrop:r=>{r.preventDefault(),r.dataTransfer.files.length>0&&aa(r.dataTransfer.files)},onClick:r=>{var x;r.target.closest("button")||(x=D.current)==null||x.click()},className:`
                  relative flex flex-col items-center justify-center gap-4 rounded-2xl sm:rounded-[28px] border-2 border-dashed
                  cursor-pointer transition-all duration-300 p-10 min-h-[220px] glass
                  ${je>0?"border-[var(--adora-focus-border)] hover:border-[var(--adora-accent)]":"border-white/15 hover:border-[var(--adora-focus-border)]"}
                `,children:[Z?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-[var(--adora-focus-border)] border-t-[var(--adora-accent)] rounded-full animate-spin"}),e.jsx("p",{className:"text-turquoise font-semibold",children:"جاري تحليل الملفات..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 rounded-2xl bg-[var(--adora-hover-bg)]",children:e.jsx(cs,{className:"w-10 h-10 text-turquoise"})}),e.jsxs("div",{className:"text-center space-y-1.5",children:[e.jsx("p",{className:"text-lg font-bold text-[var(--adora-text)]",children:"ارفع كل الملفات دفعة واحدة"}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)]",children:"اسحب الملفات هنا أو اضغط لاختيارها — التعرف تلقائي من المحتوى"}),e.jsxs("p",{className:"text-sm text-[var(--adora-text-secondary)]",children:[e.jsx("span",{className:"text-[var(--adora-accent)]",children:"مطلوب:"})," تقرير إحصائيات الموظفين (واحد لجميع الفروع) • تقرير التواريخ الفعلية للحجوزات (ملف لكل فرع) • تقرير حجوزات العملاء (ملف لكل فرع)"]}),e.jsx("p",{className:"text-xs text-[var(--adora-text-secondary)]/80",children:"اختياري: سجل حركات النظام • تقرير وحدات الحجوزات (ملف لكل فرع)"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[var(--adora-text-secondary)] text-sm mt-1",children:[e.jsx(ba,{className:"w-3.5 h-3.5"})," xlsx / xls"]}),e.jsx("button",{type:"button",onClick:r=>{var x;r.preventDefault(),r.stopPropagation(),(x=D.current)==null||x.click()},className:"mt-2 px-5 py-2.5 rounded-xl bg-[var(--adora-accent)] text-white font-semibold text-sm hover:opacity-90 transition-opacity pointer-events-auto z-10 relative",children:"اختر ملفات"})]}),e.jsx("input",{ref:D,type:"file",accept:".xlsx,.xls",multiple:!0,"aria-label":"اختر ملفات Excel",style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",pointerEvents:"auto",zIndex:2},onChange:r=>{const x=r.target,R=x.files;R&&R.length>0&&aa(R).catch(P=>{re(!1),alert("خطأ في الرفع: "+(P instanceof Error?P.message:String(P)))}),x.value=""}})]}),je>0&&e.jsxs("div",{className:`rounded-2xl overflow-hidden border transition-colors ${me?"bg-emerald-950/25 border-emerald-500/50":"bg-[var(--adora-input-bg)] border-[var(--adora-border)]"}`,children:[e.jsxs("button",{type:"button",onClick:()=>me&&oe(r=>!r),className:`w-full flex items-center justify-between gap-2 p-4 text-right transition-colors ${me?"hover:bg-emerald-950/30":"hover:bg-slate-700/30"}`,children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[me?e.jsx(Mt,{className:"w-4 h-4 text-emerald-400 shrink-0"}):e.jsx(xa,{className:"w-4 h-4 text-cyan-400 shrink-0"}),e.jsxs("span",{className:me?"text-[var(--adora-success)]":"text-[var(--adora-text)]",children:["الملفات المكتشفة (",je,"/",ft.length,")"]}),me&&e.jsx("span",{className:"text-[14px] font-bold text-[var(--adora-success)] bg-emerald-500/20 border border-emerald-500/40 rounded-full px-2 py-0.5",children:"تم بنجاح 100%"})]}),e.jsxs("span",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs("span",{role:"button",tabIndex:0,onClick:r=>{r.stopPropagation(),rt()},onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),r.stopPropagation(),rt())},className:"flex items-center gap-1 text-sm text-[var(--adora-error)]/70 hover:text-[var(--adora-error)] transition-colors cursor-pointer",children:[e.jsx(Et,{className:"w-3 h-3"})," مسح الكل"]}),me&&(B?e.jsx(Ee,{className:"w-4 h-4 text-[var(--adora-text-secondary)]"}):e.jsx(dt,{className:"w-4 h-4 text-[var(--adora-text-secondary)]"}))]})]}),(!B||!me)&&e.jsxs("div",{className:"px-5 pb-5 pt-0 space-y-3",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2",children:ft.map(r=>{var ae;const x=Y[r.key],{color:R,bg:P}=rn(r.baseType),X=an(r.baseType,r.branch);return e.jsxs("div",{className:`flex items-center gap-3 px-3 py-2.5 rounded-xl border transition-all ${x?"bg-emerald-950/20 border-emerald-500/30":r.required?"bg-red-950/10 border-red-500/20":"bg-[var(--adora-input-bg)] border-[var(--adora-border)]"}`,children:[e.jsx("div",{className:`p-1.5 rounded-lg ${x?"bg-emerald-500/20":P}`,children:x?e.jsx(Mt,{className:"w-4 h-4 text-emerald-400"}):e.jsx(ss,{className:`w-4 h-4 ${r.required?"text-[var(--adora-error)]/70":"text-slate-500"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-medium truncate ${x?"text-[var(--adora-success)]":R}`,children:X}),x?e.jsxs("p",{className:"text-[14px] text-emerald-400/80 truncate",children:[(ae=x.file)==null?void 0:ae.name," — ",x.stats]}):e.jsx("p",{className:"text-[14px] text-[var(--adora-text-secondary)]",children:r.required?"مطلوب":"اختياري (إثراء)"})]}),x&&e.jsx("button",{onClick:()=>cr(r.key),className:"p-1 text-[var(--adora-text-secondary)] hover:text-[var(--adora-error)] transition-colors",children:e.jsx(Te,{className:"w-3.5 h-3.5"})})]},r.key)})}),H.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-amber-400/80 bg-amber-500/5 px-3 py-2 rounded-lg",children:[e.jsx(ga,{className:"w-3.5 h-3.5 shrink-0"}),e.jsxs("span",{children:["ملفات لم يتم التعرف عليها: ",H.join("، ")]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:Ye,disabled:!pe,className:`group flex items-center gap-3 px-12 py-4 bg-teal-500 hover:bg-teal-600
                               disabled:bg-slate-700 disabled:text-[var(--adora-text-secondary)]
                               text-white rounded-2xl font-bold text-lg shadow-lg shadow-teal-500/30
                               disabled:shadow-none transition-all duration-300
                               disabled:cursor-not-allowed active:scale-95`,children:[e.jsx(ys,{className:"w-6 h-6"})," بدء التحليل"]}),J.length>0&&!ve&&e.jsxs("button",{onClick:()=>_e(!0),className:`flex items-center gap-2 px-6 py-4 bg-[var(--adora-input-bg)] hover:bg-[var(--adora-hover-bg)]
                                 text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] rounded-2xl font-semibold text-sm
                                 border border-[var(--adora-border)] hover:border-[var(--adora-focus-border)]
                                 transition-all duration-300 active:scale-95`,children:[e.jsx(Ct,{className:"w-5 h-5 text-turquoise"})," عرض النتائج السابقة"]})]}),!pe&&je===0&&J.length===0&&e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)]",children:"ارفع الملفات للبدء"}),!pe&&je>0&&!vt&&e.jsx("p",{className:"text-sm text-[var(--adora-error)]/80",children:"مطلوب: تقرير إحصائيات الموظفين"}),!pe&&vt&&!ra&&e.jsx("p",{className:"text-sm text-[var(--adora-error)]/80",children:"مطلوب: تقرير حجوزات العملاء لفرع واحد على الأقل"})]}),je===0&&e.jsxs("div",{className:"text-center py-6 text-[var(--adora-text-secondary)]",children:[e.jsx(xa,{className:"w-14 h-14 mx-auto mb-3 opacity-15"}),e.jsx("p",{className:"text-sm",children:"اسحب ملفات Excel هنا أو اضغط على المنطقة أعلاه"})]})]})}),ve&&!Se&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 animate-in",children:[e.jsxs("div",{className:"glass rounded-2xl p-4 border-r-2 border-[var(--adora-focus-border)] hover:border-[var(--adora-accent)] transition-all duration-200",children:[e.jsx("p",{className:"text-[15px] text-turquoise mb-1.5 font-semibold tracking-wide",children:"مرجع الإحصائيات"}),e.jsx("p",{className:"text-2xl font-bold text-[var(--adora-accent)] tabular-nums",children:nt.toLocaleString()}),e.jsxs("p",{className:"text-[14px] text-[var(--adora-text-secondary)] mt-1.5",children:[Xe.filter(r=>r.bookingCount>0).length," موظف نشط"]})]}),e.jsxs("div",{className:"glass rounded-2xl p-4 border-r-2 border-emerald-500/50 hover:border-emerald-500/80 transition-all duration-200",children:[e.jsx("p",{className:"text-[15px] text-[var(--adora-success)] mb-1.5 font-semibold tracking-wide opacity-90",children:"محسوب (مع تفاصيل)"}),e.jsx("p",{className:"text-2xl font-bold text-[var(--adora-success)] tabular-nums",children:Ce.length.toLocaleString()}),e.jsxs("p",{className:"text-[14px] text-[var(--adora-text-secondary)] mt-1.5",children:["تغطية ",yr,"%"]})]}),e.jsxs("div",{className:"glass rounded-2xl p-4 border-r-2 border-amber-500/50 hover:border-amber-500/80 transition-all duration-200",children:[e.jsx("p",{className:"text-[15px] text-[var(--adora-warning)] mb-1.5 font-semibold tracking-wide opacity-90",children:"زيادة (مستبعد)"}),e.jsx("p",{className:"text-2xl font-bold text-[var(--adora-warning)] tabular-nums",children:st.length}),e.jsxs("div",{className:"flex flex-wrap gap-x-2 gap-y-0.5 mt-1.5",children:[$e["لم يخرج"]>0&&e.jsxs("span",{className:"text-[14px] text-[var(--adora-accent)]",children:["🏨 ",$e["لم يخرج"]," لم يخرج"]}),$e["تجاوز العدد"]>0&&e.jsxs("span",{className:"text-[14px] text-[var(--adora-warning)]",children:["⚡ ",$e["تجاوز العدد"]," تجاوز"]}),$e["بدون صلاحية"]>0&&e.jsxs("span",{className:"text-[14px] text-[var(--adora-warning)]",children:["🚫 ",$e["بدون صلاحية"]," بدون صلاحية"]}),st.length===0&&e.jsx("span",{className:"text-[14px] text-[var(--adora-success)]",children:"✓ مطابق"})]})]}),e.jsxs("div",{className:"glass rounded-2xl p-4 border-r-2 border-red-500/40 hover:border-red-500/70 transition-all duration-200",children:[e.jsx("p",{className:"text-[15px] text-[var(--adora-error)] mb-1.5 font-semibold tracking-wide opacity-90",children:"ناقص (بدون تفاصيل)"}),e.jsx("p",{className:"text-2xl font-bold text-[var(--adora-error)] tabular-nums",children:Math.max(0,nt-Ce.length)}),e.jsx("p",{className:"text-[14px] text-[var(--adora-text-secondary)] mt-1.5",children:"الإحصائيات > التقارير"})]}),e.jsxs("div",{className:`glass rounded-2xl p-4 border-r-2 transition-all duration-200 ${Me.length>0?"border-red-500/50 hover:border-red-500/80":"border-emerald-500/40 hover:border-emerald-500/70"}`,children:[e.jsxs("p",{className:"text-[15px] text-[var(--adora-error)] mb-1.5 font-semibold flex items-center gap-1 tracking-wide opacity-90",children:[e.jsx(mt,{className:"w-3 h-3"})," تنبيهات الأسعار"]}),e.jsx("p",{className:`text-2xl font-bold tabular-nums ${Me.length>0?"text-[var(--adora-error)]":"text-[var(--adora-success)]"}`,children:Me.length>0?Me.length:"✓"}),e.jsxs("p",{className:"text-[14px] text-[var(--adora-text-secondary)] mt-1.5",children:[Me.length>0?`نقص ${vr.toLocaleString("en-SA")} SAR`:"لا توجد مخالفات سعرية",la>0&&e.jsxs("span",{className:"text-purple-400/60 mr-1",children:[" • ",la/2," دمج"]})]})]})]}),e.jsx(ao,{staffList:Xe,data:J,config:k,dateRange:Ze,logCreationShiftCounts:Xa}),e.jsxs("section",{className:"glass rounded-2xl sm:rounded-[28px] p-5 space-y-4 neon-glow animate-in animate-delay-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-sm font-semibold text-[var(--adora-text)] flex items-center gap-2",children:[e.jsx(ua,{className:"w-4 h-4 text-turquoise"})," الجدول التفصيلي"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[fr&&e.jsxs("button",{onClick:br,className:"flex items-center gap-1 text-sm text-[var(--adora-error)] hover:opacity-90",children:[e.jsx(Te,{className:"w-3 h-3"})," مسح"]}),e.jsx("button",{onClick:()=>{_e(!1)},className:"text-sm text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors",children:"← رجوع للملفات"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ua,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[var(--adora-text-secondary)]"}),e.jsx("input",{type:"text",placeholder:"بحث (موظف، عميل، وحدة، رقم حجز)...",value:ze,onChange:r=>qt(r.target.value),className:`w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-xl
                             pr-10 pl-4 py-2.5 focus:ring-2 focus:ring-[var(--adora-focus-border)] focus:border-[var(--adora-focus-border)]
                             outline-none transition-all placeholder:text-[var(--adora-text-secondary)]`})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[e.jsx(Be,{label:"الفرع",value:Ue,options:xr,onChange:Ht}),e.jsx(Be,{label:"المصدر",value:He,options:pr,onChange:Kt}),e.jsx(Be,{label:"الشفت",value:qe,options:mr,onChange:Gt}),e.jsx(Be,{label:"التصنيف",value:We,options:gr,onChange:Jt}),e.jsx(Be,{label:"الوحدة",value:Ge,options:ur,onChange:Wt}),e.jsx(Be,{label:"الموظف",value:Ke,options:hr,onChange:Yt})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{et(!Ae),Ae||Qe(!1)},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${Ae?"bg-emerald-500/20 text-emerald-300 border border-emerald-500/40":"bg-[var(--adora-input-bg)] text-[var(--adora-text-secondary)] border border-[var(--adora-border)] hover:text-[var(--adora-text)]"}`,children:[e.jsx(Ia,{className:"w-4 h-4"})," المحسوب فقط"]}),e.jsxs("button",{onClick:()=>{Qe(!Ie),Ie||(et(!1),ut(!1))},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${Ie?"bg-amber-500/20 text-amber-300 border border-amber-500/40":"bg-[var(--adora-input-bg)] text-[var(--adora-text-secondary)] border border-[var(--adora-border)] hover:text-[var(--adora-text)]"}`,children:[e.jsx(ga,{className:"w-4 h-4"})," الزيادة فقط"]}),e.jsxs("button",{onClick:()=>{ut(!Pe),Pe||(et(!1),Qe(!1))},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${Pe?"bg-red-500/20 text-red-300 border border-red-500/40":"bg-[var(--adora-input-bg)] text-[var(--adora-text-secondary)] border border-[var(--adora-border)] hover:text-[var(--adora-text)]"}`,children:[e.jsx(mt,{className:"w-4 h-4"})," تنبيهات الأسعار"]})]})]}),e.jsxs("section",{className:"glass rounded-2xl sm:rounded-[28px] overflow-hidden neon-glow table-section-no-side-shadow animate-in animate-delay-300",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"text-sm w-full app-detail-table",children:[e.jsx("thead",{children:he.getHeaderGroups().map(r=>e.jsx("tr",{className:"border-b border-[var(--adora-border)]",children:r.headers.map(x=>e.jsx("th",{style:{minWidth:x.getSize()},className:`px-2 py-2.5 text-right text-[15px] font-semibold text-[var(--adora-text-secondary)]
                                       bg-[var(--adora-table-header-bg)] cursor-pointer hover:text-[var(--adora-accent)] hover:bg-[var(--adora-hover-bg)] transition-colors
                                       select-none whitespace-nowrap overflow-hidden tracking-wide`,onClick:x.column.getToggleSortingHandler(),children:e.jsxs("div",{className:"flex items-center gap-1",children:[ia(x.column.columnDef.header,x.getContext()),e.jsx(Wr,{className:"w-3 h-3 text-[var(--adora-text-secondary)] shrink-0"})]})},x.id))},r.id))}),e.jsx("tbody",{children:he.getRowModel().rows.map((r,x)=>e.jsx("tr",{className:`border-b border-white/[0.03] transition-colors hover:bg-white/[0.03] ${r.original.isExcess?"bg-amber-500/3 border-r-2 border-r-amber-500/50 opacity-55":x%2===0?"":"bg-white/[0.01]"}`,children:r.getVisibleCells().map(R=>e.jsx("td",{style:{minWidth:R.column.getSize()},className:"px-2 py-2 whitespace-nowrap overflow-hidden text-ellipsis text-sm",children:ia(R.column.columnDef.cell,R.getContext())},R.id))},r.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-t border-[var(--adora-border)] bg-[var(--adora-modal-header-bg)]",children:[e.jsxs("div",{className:"text-[15px] text-[var(--adora-text-secondary)]",children:["عرض ",e.jsx("span",{className:"text-[var(--adora-text)] font-medium",children:he.getRowModel().rows.length})," من ",e.jsx("span",{className:"text-[var(--adora-text)] font-medium",children:yt.length}),J.length!==yt.length&&e.jsxs("span",{className:"text-amber-500/70 mr-1.5",children:["(مفلتر من ",J.length,")"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>he.previousPage(),disabled:!he.getCanPreviousPage(),className:"p-1.5 rounded-lg bg-[var(--adora-input-bg)] hover:bg-[var(--adora-hover-bg)] disabled:opacity-25 disabled:cursor-not-allowed transition-colors border border-[var(--adora-border)]",children:e.jsx(es,{className:"w-3.5 h-3.5"})}),e.jsxs("span",{className:"text-[15px] text-[var(--adora-text-secondary)] min-w-[70px] text-center tabular-nums",children:[he.getState().pagination.pageIndex+1," / ",he.getPageCount()]}),e.jsx("button",{onClick:()=>he.nextPage(),disabled:!he.getCanNextPage(),className:"p-1.5 rounded-lg bg-[var(--adora-input-bg)] hover:bg-[var(--adora-hover-bg)] disabled:opacity-25 disabled:cursor-not-allowed transition-colors border border-[var(--adora-border)]",children:e.jsx(Zr,{className:"w-3.5 h-3.5"})}),e.jsxs("select",{value:he.getState().pagination.pageSize,onChange:r=>he.setPageSize(Number(r.target.value)),className:"bg-[var(--adora-input-bg)] text-[var(--adora-text)] text-[15px] rounded-lg px-2 py-1.5 border border-[var(--adora-border)] outline-none focus:ring-1 focus:ring-[var(--adora-focus-border)] cursor-pointer",children:[[25,50,100,200].map(r=>e.jsxs("option",{value:r,children:[r," صف"]},r)),e.jsx("option",{value:99999,children:"الكل"})]})]})]})]})]})]}),nr&&e.jsx(qn,{config:k,discoveredBranches:bt,onSave:oa,onSaveAsDefault:async r=>{const{saveConfigToFirebase:x}=await Le(async()=>{const{saveConfigToFirebase:R}=await import("./firebase-cj8VFPmH.js");return{saveConfigToFirebase:R}},__vite__mapDeps([0,1,2,3]));await x(r).catch(()=>{})},onClose:r=>{oa(r)}}),ar&&e.jsx(Hn,{config:k,onClose:()=>Xt(!1)}),rr&&e.jsx(Gn,{config:k,onClose:()=>Zt(!1)}),sr&&e.jsx(Yn,{config:k,onClose:()=>Qt(!1)}),or&&ye&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",role:"dialog","aria-modal":"true","aria-labelledby":"attendance-modal-title",children:e.jsxs("div",{className:"bg-[var(--adora-bg-card)] border border-[var(--adora-border)] rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-[var(--adora-border)] bg-[var(--adora-modal-header-bg)]",children:[e.jsxs("div",{children:[e.jsx("h2",{id:"attendance-modal-title",className:"text-lg font-bold text-[var(--adora-text)]",children:"نتيجة تقارير الحضور"}),ye.length>0&&ye[0].period&&e.jsxs("p",{className:"text-sm text-[var(--adora-text-secondary)] mt-0.5",children:["الفترة: ",ye[0].period]})]}),e.jsx("button",{type:"button",onClick:()=>{ta(!1),ht(null),at(null)},className:"p-2 rounded-lg hover:bg-[var(--adora-hover-bg)] transition-colorss","aria-label":"إغلاق",children:e.jsx(Te,{className:"w-5 h-5 text-[var(--adora-text-secondary)]"})})]}),e.jsxs("div",{className:"overflow-auto flex-1 p-5",children:[e.jsxs("table",{className:"w-full text-right border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-[var(--adora-border)]",children:[e.jsx("th",{className:"py-2 px-2 text-[var(--adora-text-secondary)] font-semibold",children:"الموظف"}),e.jsx("th",{className:"py-2 px-2 text-[var(--adora-text-secondary)] font-semibold",children:"أيام العمل"}),e.jsx("th",{className:"py-2 px-2 text-[var(--adora-text-secondary)] font-semibold",children:"حاضر كامل"}),e.jsx("th",{className:"py-2 px-2 text-yellow-500 font-semibold",title:"حضور محسوب لكن البصمة غير مكتملة (دخول فقط أو خروج فقط)",children:"بصمة غير مكتملة"}),e.jsx("th",{className:"py-2 px-2 text-[var(--adora-text-secondary)] font-semibold",children:"غياب"}),e.jsx("th",{className:"py-2 px-2 text-[var(--adora-text-secondary)] font-semibold",children:"إجازة"}),e.jsx("th",{className:"py-2 px-2 text-[var(--adora-text-secondary)] font-semibold",children:"تحتاج مراجعة"}),e.jsx("th",{className:"py-2 px-2 text-[var(--adora-text-secondary)] font-semibold",children:"صافي الساعات"}),e.jsx("th",{className:"py-2 px-2 text-[var(--adora-text-secondary)] font-semibold",children:"نسبة البصمة %"})]})}),e.jsx("tbody",{children:ye.map((r,x)=>{const R=X=>()=>at({resultIndex:x,column:X}),P="py-2.5 px-2 tabular-nums cursor-pointer hover:ring-1 hover:ring-[var(--adora-accent)]/50 rounded";return e.jsxs("tr",{className:"border-b border-[var(--adora-border)]/60 hover:bg-[var(--adora-hover-bg)]/50",children:[e.jsx("td",{className:"py-2.5 px-2 text-[var(--adora-text)] font-medium",children:r.employeeName}),e.jsx("td",{className:`${P} text-[var(--adora-accent)] font-bold`,onClick:R("totalDaysInPeriod"),title:"اضغط للتفاصيل",children:r.totalDaysInPeriod??r.validDays+r.incompleteDays+r.absentDays+r.permittedAbsence+(r.reviewRequiredDays??0)}),e.jsx("td",{className:`${P} text-emerald-500/90`,onClick:R("validDays"),title:"اضغط للتفاصيل",children:r.validDays}),e.jsx("td",{className:`${P} text-yellow-500 font-medium bg-yellow-500/10`,onClick:R("incompleteDays"),title:"اضغط للتفاصيل",children:r.incompleteDays}),e.jsx("td",{className:`${P} text-red-400/90`,onClick:R("absentDays"),title:"اضغط للتفاصيل",children:r.absentDays}),e.jsx("td",{className:`${P} text-[var(--adora-text-secondary)]`,onClick:R("permittedAbsence"),title:"اضغط للتفاصيل",children:r.permittedAbsence}),e.jsx("td",{className:`${P} text-amber-600/90`,onClick:R("reviewRequiredDays"),title:"اضغط للتفاصيل",children:r.reviewRequiredDays??0}),e.jsx("td",{className:`${P} text-[var(--adora-text)]`,onClick:R("totalNetHours"),title:"اضغط للتفاصيل",children:typeof r.totalNetHours=="number"?r.totalNetHours.toFixed(1):"—"}),e.jsx("td",{className:`${P} text-[var(--adora-accent)]`,onClick:R("fingerprintAccuracy"),title:"اضغط للتفاصيل",children:typeof r.fingerprintAccuracy=="number"?r.fingerprintAccuracy+"%":"—"})]},x)})})]}),tt!=null&&ye&&ye[tt.resultIndex]&&(()=>{const r=ye[tt.resultIndex],x=tt.column,R=r.days??[],P={validDays:"valid",incompleteDays:"incomplete",absentDays:"absent",permittedAbsence:"permitted_absence",reviewRequiredDays:"review_required"},X=P[x]?R.filter(Q=>Q.status===P[x]):[],ae={totalDaysInPeriod:"أيام العمل (إجمالي الفترة)",totalWorkDays:"أيام الحضور",validDays:"حاضر كامل",incompleteDays:"بصمة غير مكتملة",absentDays:"غياب",permittedAbsence:"إجازة",reviewRequiredDays:"تحتاج مراجعة",totalNetHours:"صافي الساعات",fingerprintAccuracy:"نسبة البصمة %"},fe={totalDaysInPeriod:"إجمالي أيام الفترة = حاضر كامل + بصمة غير مكتملة + غياب + إجازة + تحتاج مراجعة.",totalWorkDays:"أيام الحضور فقط = حاضر كامل + بصمة غير مكتملة (لنسبة البصمة).",validDays:"أيام ذات بصمة دخول + خروج ومدة ≥ 4 ساعات.",incompleteDays:"أيام ذات بصمة واحدة فقط (دخول أو خروج) — محسوبة تقديرياً.",absentDays:"أيام بدون أي بصمة في التقرير.",permittedAbsence:"أيام مسجلة كإجازة/غياب مسموح.",reviewRequiredDays:"أيام بصمة وحيدة غير ليلية — تحتاج قرار إداري.",totalNetHours:"مجموع ساعات كل أيام الحضور (حد أقصى 12 ساعة/يوم).",fingerprintAccuracy:"نسبة الالتزام = (حاضر كامل ÷ أيام الحضور) × 100."},le=x==="totalDaysInPeriod"?r.totalDaysInPeriod??r.validDays+r.incompleteDays+r.absentDays+r.permittedAbsence+(r.reviewRequiredDays??0):x==="totalWorkDays"?r.totalWorkDays:x==="validDays"?r.validDays:x==="incompleteDays"?r.incompleteDays:x==="absentDays"?r.absentDays:x==="permittedAbsence"?r.permittedAbsence:x==="reviewRequiredDays"?r.reviewRequiredDays??0:x==="totalNetHours"?typeof r.totalNetHours=="number"?r.totalNetHours.toFixed(1):"—":x==="fingerprintAccuracy"?typeof r.fingerprintAccuracy=="number"?r.fingerprintAccuracy+"%":"—":"";return e.jsx("div",{className:"fixed inset-0 z-[102] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:()=>at(null),role:"presentation",children:e.jsxs("div",{className:"bg-[var(--adora-bg-card)] border border-[var(--adora-border)] rounded-xl shadow-2xl max-w-sm w-full max-h-[70vh] flex flex-col overflow-hidden",onClick:Q=>Q.stopPropagation(),role:"dialog","aria-label":"تفاصيل الرقم",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-[var(--adora-border)]",children:[e.jsxs("h4",{className:"text-[var(--adora-text)] font-semibold",children:[r.employeeName,": ",ae[x]," (",le,")"]}),e.jsx("button",{type:"button",onClick:()=>at(null),className:"p-1.5 rounded-lg hover:bg-[var(--adora-hover-bg)] text-[var(--adora-text-secondary)]","aria-label":"إغلاق",children:"×"})]}),e.jsxs("div",{className:"p-3 overflow-auto text-[13px] text-[var(--adora-text-secondary)]",children:[e.jsx("p",{className:"mb-2",children:fe[x]}),X.length>0?e.jsxs("p",{className:"mt-2 text-[var(--adora-text)] font-medium",children:["التواريخ (",X.length,"):"]}):null,X.length>0?e.jsx("ul",{className:"mt-1 list-disc list-inside space-y-0.5 text-[var(--adora-text)]",children:X.map(Q=>{const[ee,Ne,xe]=Q.workDateStr.split("-"),se=`${xe}/${Ne}/${ee}`;return e.jsxs("li",{children:[se,x==="validDays"||x==="incompleteDays"?` — ${Q.netHours.toFixed(1)} س`:""]},Q.workDateStr)})}):x==="totalDaysInPeriod"?e.jsxs("p",{className:"text-[var(--adora-text)]",children:["حاضر كامل: ",r.validDays," + بصمة غير مكتملة: ",r.incompleteDays," + غياب: ",r.absentDays," + إجازة: ",r.permittedAbsence," + تحتاج مراجعة: ",r.reviewRequiredDays??0," = إجمالي ",r.totalDaysInPeriod??r.validDays+r.incompleteDays+r.absentDays+r.permittedAbsence+(r.reviewRequiredDays??0)," يوم"]}):x==="totalWorkDays"?e.jsxs("p",{className:"text-[var(--adora-text)]",children:["حاضر كامل: ",r.validDays," + بصمة غير مكتملة: ",r.incompleteDays," = أيام الحضور (لنسبة البصمة)."]}):x==="totalNetHours"?e.jsx("p",{className:"text-[var(--adora-text)]",children:"مجموع ساعات أيام الحضور (كل يوم حد أقصى 12 ساعة)."}):x==="fingerprintAccuracy"?e.jsxs("p",{className:"text-[var(--adora-text)]",children:["حاضر كامل ",r.validDays," ÷ أيام الحضور ",r.totalWorkDays," × 100 = ",typeof r.fingerprintAccuracy=="number"?r.fingerprintAccuracy+"%":"—"]}):null]})]})})})(),e.jsxs("div",{className:"mt-4 space-y-3",children:[ye.some(r=>(r.fingerprintAccuracy??0)===0&&(r.totalWorkDays??0)>0)&&e.jsxs("div",{className:"p-3 rounded-xl bg-amber-500/15 border border-amber-500/40 text-[13px] text-amber-800 dark:text-amber-200",children:[e.jsx("p",{className:"font-semibold",children:"تنبيه إداري"}),e.jsx("p",{className:"mt-1",children:"نسبة البصمة 0% تعني أن كل أيام الحضور محسوبة من «بصمة وحيدة» (خروج فقط). الحضور مقبول تقنياً لعدم الظلم، لكن الالتزام بنظام البصمة (دخول + خروج) ضعيف. يُفضّل تشجيع البصمة الكاملة لاحتساب الساعات الفعلية والأوفر تايم بدقة."})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-[var(--adora-hover-bg)]/50 border border-[var(--adora-border)]/50 text-[13px] text-[var(--adora-text-secondary)] space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-[var(--adora-text)]",children:"المعادلات:"})," أيام العمل (إجمالي الفترة) = حاضر كامل + بصمة غير مكتملة + غياب + إجازة + تحتاج مراجعة. صافي الساعات: بصمة وحيدة = 8 ساعات تقديرياً؛ بصمتين = المدة الفعلية (حد أقصى 12 ساعة). نسبة البصمة = (حاضر كامل ÷ أيام الحضور) × 100."]}),e.jsx("p",{children:"التاريخ الذكي: بصمة قبل 06:00 → تُحسب لليوم السابق. البصمة الوحيدة ليلاً (21–01) = حضور نسيان دخول؛ غير ذلك = تحتاج مراجعة (لا تُحسب)."}),e.jsx("p",{className:"text-[var(--adora-text)]/80 mt-1",children:"الأيام ذات البصمة غير المكتملة (دخول فقط أو خروج فقط) محسوبة تقديرياً — للمراجعة والاعتماد الإداري."})]})]})]})]})}),lr&&e.jsx("div",{className:"fixed inset-0 z-[99] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 px-6 py-5 rounded-2xl bg-[var(--adora-bg-card)] border border-[var(--adora-border)]",children:[e.jsx(ma,{className:"w-10 h-10 text-[var(--adora-accent)] animate-spin"}),e.jsx("p",{className:"text-[var(--adora-text)] font-medium",children:"جاري معالجة تقارير الحضور..."})]})})]}):e.jsxs("div",{dir:"rtl",className:"min-h-screen text-[var(--adora-text)] relative flex items-center justify-center px-4",children:[e.jsx(De,{className:"fixed top-4 left-4 z-[100]"}),e.jsxs("div",{className:"glass rounded-2xl border border-white/15 p-6 max-w-xl w-full text-center",children:[e.jsx("h2",{className:"text-xl font-black text-turquoise mb-2",children:"غير مصرح بالدخول"}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)] leading-7",children:"مفتاح الدخول غير صحيح. تأكد من الرابط أو أدخل المفتاح من الصفحة الرئيسية."}),e.jsx("a",{href:typeof window<"u"?window.location.origin+"/":"/",className:"mt-4 inline-block text-[var(--adora-accent)] hover:opacity-90 text-sm font-semibold",children:"← العودة لصفحة الدخول"})]})]})}function qn({config:a,discoveredBranches:t,onSave:n,onSaveAsDefault:l,onClose:s}){const[i,c]=y.useState(()=>structuredClone(a)),[b,u]=y.useState(!1),[h,g]=y.useState(null),N=y.useCallback(()=>{u(!0),setTimeout(()=>{n(i)},900)},[i,n]),M=(o,d)=>{c(j=>({...j,[o]:d}))},_=o=>{c(d=>{var j;return{...d,branches:{...d.branches,[o]:{...d.branches[o],excluded:!((j=d.branches[o])!=null&&j.excluded)}}}})},A=(o,d)=>{const j=d.split(",").map(f=>f.trim()).filter(Boolean);c(f=>({...f,branches:{...f.branches,[o]:{...f.branches[o],vipRooms:j}}}))},S=(o,d,j,f)=>{c(p=>{var v;const m=[...((v=p.branches[o])==null?void 0:v.priceRules)||[]];return m[d]={...m[d],[j]:f},{...p,branches:{...p.branches,[o]:{...p.branches[o],priceRules:m}}}})},w=o=>{c(d=>{var f;const j=[...((f=d.branches[o])==null?void 0:f.priceRules)||[]];return j.push({roomType:"",dailyMin:0,monthlyMin:0,keywords:[]}),{...d,branches:{...d.branches,[o]:{...d.branches[o],priceRules:j}}}})},O=(o,d)=>{c(j=>{var p;const f=[...((p=j.branches[o])==null?void 0:p.priceRules)||[]];return f.splice(d,1),{...j,branches:{...j.branches,[o]:{...j.branches[o],priceRules:f}}}})},T=(o,d,j,f)=>{c(p=>{var v;const m=[...((v=p.branches[o])==null?void 0:v.mergedRules)||[]];return m[d]={...m[d],[j]:f},{...p,branches:{...p.branches,[o]:{...p.branches[o],mergedRules:m}}}})},E=o=>{c(d=>{var f;const j=[...((f=d.branches[o])==null?void 0:f.mergedRules)||[]];return j.push({label:"",dailyMin:0,monthlyMin:0,digitPairs:[0,0]}),{...d,branches:{...d.branches,[o]:{...d.branches[o],mergedRules:j}}}})},I=(o,d)=>{c(j=>{var p;const f=[...((p=j.branches[o])==null?void 0:p.mergedRules)||[]];return f.splice(d,1),{...j,branches:{...j.branches,[o]:{...j.branches[o],mergedRules:f}}}})},q=()=>{const o=Zs()??Re;c(structuredClone(o))},L=async()=>{Xs(i),l&&await l(i),g(Date.now()),setTimeout(()=>g(null),2500)},z=y.useMemo(()=>[...new Set([...Object.keys(i.branches),...t])].sort(),[i,t]),G=y.useMemo(()=>{const o=["الكورنيش","الأندلس"],d=z.filter(j=>j!=="الكورنيش"&&j!=="الأندلس");return[...o.filter(j=>z.includes(j)),...d]},[z]);return e.jsx("div",{className:"fixed inset-0 z-200 flex items-center justify-center bg-black/70 backdrop-blur-sm",onClick:()=>s(i),children:e.jsxs("div",{className:`bg-[var(--adora-modal-bg)] border border-[var(--adora-border)] rounded-2xl modal-no-side-shadow
                      max-w-3xl w-[95%] max-h-[90vh] flex flex-col overflow-hidden`,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-[var(--adora-border)] bg-[var(--adora-modal-header-bg)] shrink-0 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-xl",children:e.jsx(Pt,{className:"w-5 h-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-[var(--adora-text)]",children:"إعدادات التحليل"}),e.jsx("p",{className:"text-[15px] text-[var(--adora-text-secondary)]",children:"الأسعار، الفروع، الحدود — محفوظة تلقائياً"}),e.jsx("p",{className:"text-[14px] text-[var(--adora-accent)] mt-0.5 opacity-90",children:"هذه الإعدادات عامة للمشروع ولا تتغير بتغيير الفترة أو إغلاقها أو رفع ملفات جديدة. الإعدادات الحالية يمكن حفظها كافتراضي بزر «حفظ كافتراضي» لتُستعاد لاحقاً بـ «استعادة الافتراضي». عند الإغلاق (× أو إلغاء) تُحفظ التعديلات تلقائياً."})]})]}),e.jsx("button",{onClick:()=>s(i),className:"text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors",children:e.jsx(Te,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"overflow-y-auto flex-1 px-6 py-5 space-y-6 text-base leading-relaxed max-w-3xl",children:[e.jsxs("section",{children:[e.jsx("h4",{className:"text-[var(--adora-accent)] font-bold text-base mb-3",children:"الحدود العامة"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"الحد الأدنى لحجوزات الموظف"}),e.jsx("input",{type:"number",min:0,value:i.minBookingThreshold,onChange:o=>M("minBookingThreshold",parseInt(o.target.value)||0),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-500/50"}),e.jsxs("p",{className:"text-sm text-[var(--adora-text-secondary)] mt-1",children:["الموظفون الذين تقل حجوزاتهم عن هذا العدد يُستبعدون. ",e.jsx("span",{className:"text-cyan-400/90",children:"0 = إظهار الكل بدون استبعاد"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"عتبة الحجز الشهري (ليالي)"}),e.jsx("input",{type:"number",min:1,value:i.monthlyNightsThreshold,onChange:o=>M("monthlyNightsThreshold",parseInt(o.target.value)||1),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-500/50"}),e.jsx("p",{className:"text-sm text-[var(--adora-text-secondary)] mt-1",children:"≥ هذا العدد = حجز شهري (سعر أقل)"})]})]})]}),e.jsxs("section",{className:"border border-emerald-500/30 rounded-xl p-4 space-y-4 bg-emerald-900/10",children:[e.jsx("h4",{className:"text-emerald-400 font-bold text-base",children:"أسعار المكافآت (تؤثر على صافي الموظف)"}),e.jsxs("p",{className:"text-sm text-[var(--adora-text-secondary)]",children:["كل وحدة × السعر المحدد = جزء من الإجمالي. الصافي = الإجمالي − صندوق الدعم (",i.rewardPricing.supportFundPercent??15,"%)"]}),e.jsxs("p",{className:"text-sm text-[var(--adora-text-secondary)]",children:["الحساب يُقسّم حسب المصدر: ",e.jsx("strong",{className:"text-emerald-400/90",children:"استقبال"})," (حسب الشفت صباح/مساء/ليل)، ",e.jsx("strong",{className:"text-orange-400/90",children:"بوكينج عادي"})," (سعر ثابت لكل حجز)، ",e.jsx("strong",{className:"text-violet-400/90",children:"VIP"})," (من الخانات أدناه لكل غرفة)."]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-sm font-medium text-emerald-400/90",children:"استقبال (حسب الشفت) — ريال لكل حجز عادي"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"صباح"}),e.jsx("input",{type:"number",min:0,step:.5,value:i.rewardPricing.rateMorning,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,rateMorning:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"مساء"}),e.jsx("input",{type:"number",min:0,step:.5,value:i.rewardPricing.rateEvening,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,rateEvening:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"ليل"}),e.jsx("input",{type:"number",min:0,step:.5,value:i.rewardPricing.rateNight,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,rateNight:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-sm font-medium text-orange-400/90",children:"بوكينج عادي (غير VIP) — ريال واحد لكل حجز بغض النظر عن الشفت"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs("div",{className:"max-w-[140px]",children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"مكافأة بوكينج (ريال)"}),e.jsx("input",{type:"number",min:0,step:.5,value:i.rewardPricing.rateBooking,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,rateBooking:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-sm font-medium text-cyan-400/90",children:"عقد شهري (قائمة الأسعار)"}),e.jsxs("div",{className:"max-w-[140px]",children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"ريال لكل عقد"}),e.jsx("input",{type:"number",min:0,step:1,value:i.rewardPricing.rateContract??200,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,rateContract:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-sm font-medium text-cyan-400/90",children:"صندوق الدعم"}),e.jsxs("div",{className:"max-w-[140px]",children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"نسبة من الإجمالي (%)"}),e.jsx("input",{type:"number",min:0,max:100,step:1,value:i.rewardPricing.supportFundPercent??15,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,supportFundPercent:Math.min(100,Math.max(0,parseInt(o.target.value,10)||0))}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"}),e.jsx("p",{className:"text-xs text-[var(--adora-text-secondary)] mt-1",children:"الصافي = الإجمالي − (الإجمالي × هذه النسبة)"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-sm font-medium text-violet-400/90",children:"VIP — لكل غرفة سعر استقبال وسعر بوكينج (أو الافتراضي أدناه)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"VIP افتراضي — استقبال (ريال)"}),e.jsx("input",{type:"number",min:0,step:.5,value:i.rewardPricing.rateVipDefault.reception,onChange:o=>{const d=parseFloat(o.target.value)||0;c(j=>({...j,rewardPricing:{...j.rewardPricing,rateVipDefault:{...j.rewardPricing.rateVipDefault,reception:d},rateVipByBranch:{}}}))},className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"VIP افتراضي — بوكينج (ريال)"}),e.jsx("input",{type:"number",min:0,step:.5,value:i.rewardPricing.rateVipDefault.booking,onChange:o=>{const d=parseFloat(o.target.value)||0;c(j=>({...j,rewardPricing:{...j.rewardPricing,rateVipDefault:{...j.rewardPricing.rateVipDefault,booking:d},rateVipByBranch:{}}}))},className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]})]})]}),(()=>{const o=[];if(Object.entries(i.branches).forEach(([j,f])=>{!f.excluded&&f.vipRooms.length>0&&o.push({name:j,rooms:[...f.vipRooms].sort()})}),o.length===0)return null;const d=(j,f,p,m)=>{c(v=>{const C={...v.rewardPricing.rateVipByBranch||{}},k={...C[j]||{}},$=m.trim()===""?null:parseFloat(m);if($===null||isNaN($)){if(k[f]){const F={...k[f]};delete F[p],F[p==="reception"?"booking":"reception"]==null?delete k[f]:k[f]=F}}else{const F=k[f]||{};k[f]={...F,[p]:$}}return Object.keys(k).length===0?delete C[j]:C[j]=k,{...v,rewardPricing:{...v.rewardPricing,rateVipByBranch:C}}})};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block",children:"سعر VIP لكل غرفة حسب الفرع (ريال) — اترك فارغاً ليأخذ الافتراضي"}),e.jsx("p",{className:"text-[14px] text-violet-400/70",children:"لكل غرفة VIP: سعر استقبال (حجز مباشر) وسعر بوكينج (حجز أونلاين) — الحقل الفارغ يرث القيمة الافتراضية أعلاه. حجز VIP يأخذ هذا السعر فقط بدون سعر الشفت"}),o.map(j=>e.jsxs("div",{className:"border border-violet-500/20 rounded-lg p-3 bg-violet-900/10",children:[e.jsx("p",{className:"text-sm text-violet-300 font-bold mb-2",children:j.name}),e.jsx("div",{className:"space-y-2",children:j.rooms.map(f=>{var m,v;const p=(v=(m=i.rewardPricing.rateVipByBranch)==null?void 0:m[j.name])==null?void 0:v[f];return e.jsxs("div",{className:"flex items-center gap-2 bg-[var(--adora-input-bg)] rounded-lg px-2.5 py-2 border border-[var(--adora-border)] flex-wrap sm:flex-nowrap",children:[e.jsx("span",{className:"text-sm text-violet-300 font-bold font-mono bg-violet-500/15 px-2 py-1 rounded border border-violet-500/25 shrink-0",children:f}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[e.jsx("span",{className:"text-[14px] text-emerald-400 shrink-0",children:"استقبال"}),e.jsx("input",{type:"number",min:0,step:.5,value:(p==null?void 0:p.reception)??"",placeholder:String(i.rewardPricing.rateVipDefault.reception),onChange:C=>d(j.name,f,"reception",C.target.value),className:"flex-1 bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-2 py-1.5 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono min-w-[50px]"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[e.jsx("span",{className:"text-[14px] text-orange-400 shrink-0",children:"بوكينج"}),e.jsx("input",{type:"number",min:0,step:.5,value:(p==null?void 0:p.booking)??"",placeholder:String(i.rewardPricing.rateVipDefault.booking),onChange:C=>d(j.name,f,"booking",C.target.value),className:"flex-1 bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-2 py-1.5 outline-none focus:ring-2 focus:ring-orange-500/50 font-mono min-w-[50px]"})]}),e.jsx("span",{className:"text-[14px] text-slate-500 shrink-0",children:"ر.س"})]},f)})})]},j.name))]})})(),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2 border-t border-[var(--adora-border)]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"تقييم Booking (ريال/تقييم)"}),e.jsx("input",{type:"number",min:0,step:1,value:i.rewardPricing.rateEvalBooking,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,rateEvalBooking:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"تقييم Google Maps (ريال/تقييم)"}),e.jsx("input",{type:"number",min:0,step:1,value:i.rewardPricing.rateEvalGoogle,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,rateEvalGoogle:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]})]}),e.jsx("p",{className:"text-[14px] text-[var(--adora-text-secondary)]",children:"حد التقييم الأدنى للفندق (يظهر في شروط المكافآت)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"الكورنيش"}),e.jsx("input",{type:"number",min:0,max:10,step:.1,value:i.rewardPricing.minEvalCorniche??8.7,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,minEvalCorniche:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"الأندلس"}),e.jsx("input",{type:"number",min:0,max:10,step:.1,value:i.rewardPricing.minEvalAndalus??8.2,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,minEvalAndalus:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"خرائط جوجل"}),e.jsx("input",{type:"number",min:0,max:5,step:.1,value:i.rewardPricing.minEvalGoogle??4.3,onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,minEvalGoogle:parseFloat(o.target.value)||0}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50 font-mono"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"نص حجوزات VIP (يظهر في شروط المكافآت)"}),e.jsx("input",{type:"text",value:i.rewardPricing.vipDescription??"حجوزات VIP — تُسعّر من خانات VIP (استقبال/بوكينج لكل غرفة)",onChange:o=>c(d=>({...d,rewardPricing:{...d.rewardPricing,vipDescription:o.target.value}})),className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500/50"})]})]}),G.map(o=>{const d=i.branches[o];return d?e.jsxs("section",{className:`border rounded-xl p-4 space-y-4 ${d.excluded?"border-slate-700/30 bg-slate-800/20 opacity-60":"border-slate-700/50 bg-slate-800/30"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sky-400 font-bold text-base",children:o}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.excluded,onChange:()=>_(o),className:"rounded border-[var(--adora-border)] bg-[var(--adora-input-bg)] text-[var(--adora-error)] focus:ring-red-500/50"}),e.jsx("span",{className:"text-sm text-[var(--adora-text-secondary)]",children:"مستبعد"})]})]}),!d.excluded&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] block mb-1",children:"غرف VIP (مفصولة بفاصلة)"}),e.jsx("input",{type:"text",value:d.vipRooms.join(", "),onChange:j=>A(o,j.target.value),placeholder:"601, 602, 603, 604",className:"w-full bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-cyan-500/50"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] font-medium",children:"جدول الأسعار الدنيا"}),e.jsxs("button",{onClick:()=>w(o),className:"flex items-center gap-1 text-sm text-cyan-400 hover:text-cyan-300",children:[e.jsx(pa,{className:"w-3 h-3"})," إضافة نوع"]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_80px_80px_1fr_32px] gap-2 text-[14px] text-slate-500 font-medium px-1",children:[e.jsx("span",{children:"نوع الغرفة"}),e.jsx("span",{children:"يومي"}),e.jsx("span",{children:"شهري"}),e.jsx("span",{children:"كلمات مفتاحية"}),e.jsx("span",{})]}),(d.priceRules||[]).map((j,f)=>e.jsxs("div",{className:"grid grid-cols-[1fr_80px_80px_1fr_32px] gap-2 items-center",children:[e.jsx("input",{type:"text",value:j.roomType,onChange:p=>S(o,f,"roomType",p.target.value),className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none"}),e.jsx("input",{type:"number",value:j.dailyMin,onChange:p=>S(o,f,"dailyMin",parseInt(p.target.value)||0),className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none font-mono"}),e.jsx("input",{type:"number",value:j.monthlyMin,onChange:p=>S(o,f,"monthlyMin",parseInt(p.target.value)||0),className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none font-mono"}),e.jsx("input",{type:"text",value:j.keywords.join(", "),onChange:p=>S(o,f,"keywords",p.target.value.split(",").map(m=>m.trim()).filter(Boolean)),placeholder:"كلمات للمطابقة",className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none"}),e.jsx("button",{onClick:()=>O(o,f),className:"p-1 text-slate-600 hover:text-[var(--adora-error)] transition-colors",children:e.jsx(Et,{className:"w-3.5 h-3.5"})})]},f))]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm text-[var(--adora-text-secondary)] font-medium",children:"غرف مدمجة (أزواج)"}),e.jsxs("button",{onClick:()=>E(o),className:"flex items-center gap-1 text-sm text-purple-400 hover:text-purple-300",children:[e.jsx(pa,{className:"w-3 h-3"})," إضافة زوج"]})]}),(d.mergedRules||[]).length>0&&e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"grid grid-cols-[1fr_60px_60px_50px_50px_32px] gap-2 text-[14px] text-slate-500 font-medium px-1",children:[e.jsx("span",{children:"التسمية"}),e.jsx("span",{children:"يومي"}),e.jsx("span",{children:"شهري"}),e.jsx("span",{children:"رقم1"}),e.jsx("span",{children:"رقم2"}),e.jsx("span",{})]}),d.mergedRules.map((j,f)=>e.jsxs("div",{className:"grid grid-cols-[1fr_60px_60px_50px_50px_32px] gap-2 items-center",children:[e.jsx("input",{type:"text",value:j.label,onChange:p=>T(o,f,"label",p.target.value),className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none"}),e.jsx("input",{type:"number",value:j.dailyMin,onChange:p=>T(o,f,"dailyMin",parseInt(p.target.value)||0),className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none font-mono"}),e.jsx("input",{type:"number",value:j.monthlyMin,onChange:p=>T(o,f,"monthlyMin",parseInt(p.target.value)||0),className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none font-mono"}),e.jsx("input",{type:"number",value:j.digitPairs[0],onChange:p=>T(o,f,"digitPairs",[parseInt(p.target.value)||0,j.digitPairs[1]]),className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none font-mono"}),e.jsx("input",{type:"number",value:j.digitPairs[1],onChange:p=>T(o,f,"digitPairs",[j.digitPairs[0],parseInt(p.target.value)||0]),className:"bg-[var(--adora-input-bg)] border border-[var(--adora-border)] text-[var(--adora-text)] text-sm rounded px-2 py-1.5 outline-none font-mono"}),e.jsx("button",{onClick:()=>I(o,f),className:"p-1 text-slate-600 hover:text-[var(--adora-error)] transition-colors",children:e.jsx(Et,{className:"w-3.5 h-3.5"})})]},f))]})]})]})]},o):null})]}),e.jsxs("div",{className:"px-6 py-3 border-t border-[var(--adora-border)] bg-[var(--adora-modal-header-bg)] shrink-0 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:q,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors",children:[e.jsx(_a,{className:"w-3.5 h-3.5"})," استعادة الافتراضي"]}),e.jsx("button",{onClick:L,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors",title:"حفظ الإعدادات الحالية كافتراضي يُستعاد بزر «استعادة الافتراضي» — يُرفع أيضاً لـ Firebase ليتوفر على أجهزة أخرى",children:h?"✓ تم حفظ الافتراضي":"حفظ كافتراضي"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>s(i),className:"px-4 py-1.5 rounded-lg text-sm font-medium text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors",children:"إلغاء"}),e.jsx("button",{onClick:N,disabled:b,className:`px-6 py-1.5 rounded-lg text-sm font-medium border transition-all duration-300 flex items-center gap-1.5 ${b?"bg-emerald-500/20 text-emerald-300 border-emerald-500/30 shadow-lg shadow-emerald-500/10 scale-105":"bg-cyan-600/20 text-cyan-300 hover:bg-cyan-600/30 border-cyan-500/20 hover:scale-[1.02] active:scale-[0.98]"}`,children:b?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5 animate-[scaleIn_0.3s_ease-out]",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12",className:"animate-[drawCheck_0.4s_ease-out_0.1s_both]",style:{strokeDasharray:24,strokeDashoffset:0}})}),e.jsx("span",{children:"تم الحفظ ✓"})]}):"حفظ الإعدادات"})]})]})]})})}function Hn({config:a,onClose:t}){const n=Object.entries(a.branches).filter(([,l])=>!l.excluded);return e.jsx("div",{className:"fixed inset-0 z-200 flex items-center justify-center bg-black/70 backdrop-blur-sm",onClick:t,children:e.jsxs("div",{className:`bg-[var(--adora-modal-bg)] border border-[var(--adora-border)] rounded-2xl modal-no-side-shadow
                      max-w-2xl w-[95%] max-h-[90vh] flex flex-col overflow-hidden`,onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-[var(--adora-border)] bg-[var(--adora-modal-header-bg)] shrink-0 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-xl",children:e.jsx(Ra,{className:"w-5 h-5 text-[var(--adora-accent)]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-[var(--adora-text)]",children:"منهجية التحليل والشروط"}),e.jsx("p",{className:"text-[15px] text-[var(--adora-text-secondary)]",children:"كل قواعد احتساب الحجوزات والتنبيهات السعرية"})]})]}),e.jsx("button",{onClick:t,className:"text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors",children:e.jsx(Te,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"overflow-y-auto flex-1 px-6 py-5 space-y-6 text-base leading-relaxed max-w-3xl",children:[e.jsxs("section",{children:[e.jsxs("h4",{className:"text-cyan-400 font-bold text-base mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-lg bg-cyan-500/20 flex items-center justify-center text-sm font-bold",children:"1"}),"مصادر البيانات"]}),e.jsxs("div",{className:"space-y-1.5 text-slate-300 text-sm mr-8",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-cyan-300 font-bold",children:"تقرير إحصائيات الموظفين"})," — المرجع النهائي لعدد الحجوزات لكل موظف (الحَكَم). يُستخرج منه عدد الحجوزات + فترة التقرير."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-violet-300 font-bold",children:"تقرير التواريخ الفعلية للحجوزات"})," — دخول/خروج فعلي لكل فرع (لتحديد الشفت بدقة)."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-sky-300 font-bold",children:"تقرير حجوزات العملاء"})," — المصدر الأساسي للتفاصيل: اسم العميل، الوحدة، السعر، تاريخ الدخول/الخروج، مصدر الحجز."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-teal-300 font-bold",children:"سجل حركات النظام"})," — مصدر ثانوي لكشف نقل الغرف فقط (Room Transfer)."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-amber-300 font-bold",children:"تقرير وحدات الحجوزات"})," — مصدر تكميلي لأسعار الغرف المدمجة بدقة (per-unit pricing)."]}),e.jsx("p",{className:"text-slate-500 text-sm mt-1.5",children:"الأعمدة تُكتشف تلقائياً من هيدرات الملف — لا تعتمد على ترتيب ثابت."})]})]}),e.jsxs("section",{children:[e.jsxs("h4",{className:"text-emerald-400 font-bold text-base mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-lg bg-emerald-500/20 flex items-center justify-center text-sm font-bold",children:"2"}),"شروط احتساب الحجز (الفلتر المزدوج)"]}),e.jsxs("div",{className:"space-y-2 text-slate-300 text-sm mr-8",children:[e.jsx("p",{className:"font-medium text-slate-200",children:"الحجز يُحسب للموظف فقط إذا تحقق الشرطان معاً:"}),e.jsxs("div",{className:"bg-slate-800/60 rounded-xl p-3 border border-slate-700/30 space-y-1.5",children:[e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:"✓"}),e.jsxs("span",{children:[e.jsx("span",{className:"text-emerald-300 font-bold",children:"تاريخ الإنشاء"})," داخل فترة التقرير (الموظف أنشأ الحجز خلال الفترة)"]})]}),e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:"✓"}),e.jsxs("span",{children:[e.jsx("span",{className:"text-emerald-300 font-bold",children:"تاريخ الدخول"})," داخل فترة التقرير (العميل فعلاً دخل خلال الفترة)"]})]})]}),e.jsx("p",{className:"text-slate-500 text-sm",children:"حجز أُنشئ في يناير لعميل يدخل فبراير → لا يُحسب. حجز أُنشئ في ديسمبر لعميل دخل يناير → لا يُحسب."})]})]}),e.jsxs("section",{children:[e.jsxs("h4",{className:"text-violet-400 font-bold text-base mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-lg bg-violet-500/20 flex items-center justify-center text-sm font-bold",children:"3"}),"آلية العد والحالة"]}),e.jsxs("div",{className:"space-y-1.5 text-slate-300 text-sm mr-8",children:[e.jsx("p",{children:"لكل موظف-فرع: عدد تقرير الإحصائيات = السقف الأعلى (Cap)."}),e.jsxs("p",{children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold bg-emerald-500/15 text-emerald-400 border border-emerald-500/20",children:"محسوب"})," — الحجوزات ضمن السقف (أول N حجز)."]}),e.jsxs("p",{children:[e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold bg-amber-500/15 text-amber-400 border border-amber-500/20",children:"زيادة"})," — حجوزات تتجاوز السقف."]}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"text-amber-400 font-bold",children:"⚡ تجاوز العدد:"})," الموظف له حجوزات أكثر من تقرير الإحصائيات."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-orange-400 font-bold",children:"🚫 بدون صلاحية:"})," الموظف غير موجود في تقرير الإحصائيات أصلاً."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-sky-400 font-bold",children:"🏨 لم يخرج:"})," النزيل لم يسجل خروج ضمن فترة التقرير — لذلك الإحصائيات لا تحسبه."]}),e.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["الموظفون بأقل من ",e.jsx("span",{className:"text-cyan-400 font-bold",children:a.minBookingThreshold})," حجوزات مجمعة يُستبعدون.",Object.entries(a.branches).filter(([,l])=>l.excluded).map(([l])=>l).length>0&&e.jsxs(e.Fragment,{children:[" فروع مستبعدة: ",Object.entries(a.branches).filter(([,l])=>l.excluded).map(([l])=>l).join("، "),"."]})]})]})]}),e.jsxs("section",{children:[e.jsxs("h4",{className:"text-[var(--adora-error)] font-bold text-base mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-lg bg-red-500/20 flex items-center justify-center text-sm font-bold",children:"4"}),"التنبيهات السعرية (الحد الأدنى لليلة)"]}),e.jsxs("div",{className:"space-y-3 text-sm mr-8",children:[e.jsxs("p",{className:"text-slate-300",children:["لكل نوع غرفة حد أدنى لسعر الليلة. لو ",e.jsx("span",{className:"text-red-300 font-mono",children:"(الإيجار ÷ الليالي) < الحد الأدنى"})," → تنبيه."]}),n.map(([l,s])=>e.jsxs("div",{children:[e.jsxs("p",{className:"text-sky-300 font-bold mb-1",children:[l,":"]}),e.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-0.5 text-slate-400 bg-slate-800/40 rounded-lg p-2.5 border border-slate-700/20",children:s.priceRules.map(i=>e.jsxs("span",{className:"font-mono",children:[i.roomType," ",e.jsx("span",{className:"text-slate-600",children:"→"})," يومي ",e.jsx("span",{className:"text-red-300",children:i.dailyMin})," | شهري ",e.jsx("span",{className:"text-cyan-300",children:i.monthlyMin})]},i.roomType))}),s.mergedRules.length>0&&e.jsxs("div",{className:"mt-1.5",children:[e.jsxs("p",{className:"text-purple-300 font-bold mb-1",children:["غرف مدمجة (",l,"):"]}),e.jsx("div",{className:"text-slate-400 bg-slate-800/40 rounded-lg p-2.5 border border-slate-700/20 space-y-0.5",children:s.mergedRules.map((i,c)=>e.jsxs("span",{className:"font-mono block",children:[i.label," ",e.jsx("span",{className:"text-slate-600",children:"→"})," يومي ",e.jsx("span",{className:"text-red-300",children:i.dailyMin})," | شهري ",e.jsx("span",{className:"text-cyan-300",children:i.monthlyMin})]},c))})]})]},l)),e.jsxs("p",{className:"text-slate-500 text-sm",children:["شهري = ",a.monthlyNightsThreshold," ليلة فأكثر. حجوزات بوكينج (أونلاين) مستبعدة من فحص الحد الأدنى. نقل الغرف (Room Transfer) مستبعد أيضاً."]})]})]}),e.jsxs("section",{children:[e.jsxs("h4",{className:"text-blue-400 font-bold text-base mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-lg bg-blue-500/20 flex items-center justify-center text-sm font-bold",children:"5"}),"الاستثناءات من فحص السعر"]}),e.jsxs("div",{className:"space-y-1.5 text-slate-300 text-sm mr-8",children:[e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-orange-400 font-bold shrink-0",children:"بوكينج:"}),e.jsx("span",{children:"حجوزات المواقع الخارجية (Booking.com وغيرها) لا تخضع لفحص الحد الأدنى — السعر محدد مسبقاً من المنصة."})]}),e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 font-bold shrink-0",children:"↔ نقل غرفة:"}),e.jsx("span",{children:"إذا تم نقل النزيل من غرفة لأخرى (كُشف من مقارنة السجل بالتقرير)، السعر لا يمكن تقسيمه بدقة فيُستبعد."})]}),e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-purple-400 font-bold shrink-0",children:"دمج غرف:"}),e.jsx("span",{children:"حجز بأكثر من غرفة يتم حساب إيجاره الكلي من تقرير الوحدات (إن وُجد) لدقة أعلى."})]}),e.jsxs("p",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-400 font-bold shrink-0",children:"زيادة:"}),e.jsx("span",{children:'الحجوزات المصنفة "زيادة" لا تخضع لفحص السعر — لأنها غير محسوبة أصلاً.'})]})]})]}),e.jsxs("section",{children:[e.jsxs("h4",{className:"text-amber-400 font-bold text-base mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-lg bg-amber-500/20 flex items-center justify-center text-sm font-bold",children:"6"}),"معادلة حساب النقص السعري"]}),e.jsx("div",{className:"text-sm mr-8 space-y-2",children:e.jsxs("div",{className:"bg-slate-800/60 rounded-xl p-3 border border-slate-700/30 font-mono text-slate-300",children:[e.jsxs("p",{children:["المتوقع = ",e.jsx("span",{className:"text-cyan-300",children:"الحد الأدنى لليلة"})," × ",e.jsx("span",{className:"text-cyan-300",children:"عدد الليالي"})]}),e.jsxs("p",{className:"mt-1",children:["النقص = ",e.jsx("span",{className:"text-red-300",children:"المتوقع"})," − ",e.jsx("span",{className:"text-emerald-300",children:"الإيجار الفعلي"})]}),e.jsxs("p",{className:"mt-1 text-slate-500",children:["لو النقص ≤ 0 → ",e.jsx("span",{className:"text-emerald-400",children:"✓ سليم"})]}),e.jsxs("p",{className:"text-slate-500",children:["لو النقص > 0 → ",e.jsx("span",{className:"text-[var(--adora-error)]",children:"▼ تنبيه"})]})]})})]}),e.jsxs("section",{children:[e.jsxs("h4",{className:"text-teal-400 font-bold text-base mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-lg bg-teal-500/20 flex items-center justify-center text-sm font-bold",children:"7"}),"جدول ملخص المكافآت"]}),e.jsxs("div",{className:"space-y-1.5 text-slate-300 text-sm mr-8",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-cyan-300 font-bold",children:"مرجع الإحصائيات:"})," العدد من تقرير إحصائيات الموظفين (الحَكَم النهائي)."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-emerald-300 font-bold",children:"محسوب:"})," عدد الحجوزات بالتفاصيل (≤ مرجع الإحصائيات)."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-amber-300 font-bold",children:"زيادة:"})," حجوزات تتجاوز سقف تقرير الإحصائيات (⚡تجاوز / 🏨لم يخرج / 🚫بدون صلاحية)."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-emerald-300 font-bold",children:"استقبال / بوكينج:"})," توزيع مصدر الحجز (المحسوب فقط)."]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-amber-300 font-bold",children:"صباح / مساء / ليل:"})," توزيع الورديات (6ص-4م = صباح، 4م-12ل = مساء، 12ل-6ص = ليل)."]}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"اضغط على أي رقم في الجدول لعرض تفاصيل الحجوزات المكونة له."})]})]})]}),e.jsxs("div",{className:"px-6 py-3 border-t border-[var(--adora-border)] bg-[var(--adora-modal-header-bg)] shrink-0 flex items-center justify-between",children:[e.jsx("p",{className:"text-[14px] text-[var(--adora-text-secondary)]",children:"نظام Adora لتحليل الحجوزات — التوثيق التلقائي"}),e.jsx("button",{onClick:t,className:"px-4 py-1.5 rounded-lg text-sm font-medium bg-cyan-600/20 text-[var(--adora-accent)] hover:bg-cyan-600/30 border border-cyan-500/20 transition-colors",children:"فهمت"})]})]})})}function Gn({config:a,onClose:t}){return e.jsx("div",{className:"fixed inset-0 z-200 flex items-center justify-center bg-black/70 backdrop-blur-sm p-2 sm:p-4",onClick:t,children:e.jsxs("div",{className:"bg-[var(--adora-modal-bg)] border border-[var(--adora-focus-border)] rounded-2xl modal-no-side-shadow max-w-2xl w-full max-h-[90vh] overflow-y-auto flex flex-col",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-[var(--adora-border)] shrink-0 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-black text-[var(--adora-accent)] flex items-center gap-2",children:[e.jsx("span",{children:"📊"}),e.jsx("span",{children:"كيفية حساب التقييم"})]}),e.jsx("button",{onClick:t,className:"text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors text-2xl font-bold w-11 h-11 flex items-center justify-center rounded-lg hover:bg-[var(--adora-hover-bg)]",children:"×"})]}),e.jsxs("div",{className:"px-6 py-5 space-y-4 text-sm text-[var(--adora-text)] leading-relaxed",children:[e.jsxs("p",{className:"text-[var(--adora-text)] font-medium",children:["عمود ",e.jsx("strong",{className:"text-[var(--adora-accent)]",children:"«النقاط»"})," في الجدول = ",e.jsx("strong",{className:"text-[var(--adora-text)]",children:"رصيد النقاط من الفترة"})," (صافي المستحق + مساهمة ",a.rewardPricing.supportFundPercent??15,"% معروض كنقاط) — نفس المفهوم في التقرير عند الضغط على الاسم. ",e.jsx("strong",{className:"text-[var(--adora-text)]",children:"مستوى الأداء"})," (ممتاز/جيد/سيء) يُحسب من أدائك مقارنةً بباقي الموظفين ويُعرض تحت النقاط للتوضيح. فيما يلي شرح كيفية حساب مستوى الأداء:"]}),e.jsxs("div",{className:"bg-[var(--adora-hover-bg)] rounded-xl p-4 border border-[var(--adora-focus-border)]",children:[e.jsx("h4",{className:"text-base font-bold text-[var(--adora-accent)] mb-3",children:"1. ما الذي يُؤخذ في الاعتبار؟"}),e.jsxs("ul",{className:"space-y-2 list-none",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-accent)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-text)]",children:"عدد الحجوزات:"})," كلما كان عدد حجوزاتك أقرب إلى أعلى موظف في الفريق، زادت نقاطك في هذا الجزء."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-accent)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-text)]",children:"التقييمات (Booking و Google):"})," كلما كان إجمالي تقييماتك أقرب إلى أعلى موظف، زادت نقاطك."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-accent)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-text)]",children:"الحضور 26 يوم وأكثر:"})," إذا أتممت 26 يوماً وأكثر من العطاء (بطل تحدي الظروف)، يُضاف لك ",e.jsx("strong",{className:"text-[var(--adora-success)]",children:"50 ريال"})," حافز تحدي الظروف في جدول المكافآت، ويُحسّن ترتيبك في مستوى الأداء."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-error)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-text)]",children:"الخصم الإداري:"})," إذا كان عليك خصم إداري بأي قيمة، يتم ",e.jsx("strong",{className:"text-[var(--adora-error)]",children:"تخفيض التقييم بمقدار 0.25"})," ليعكس تأثير التقصير على الأداء."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-error)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-text)]",children:"خصم تقييم الفندق (تقييمات سلبية) وفقدان فرص حجز (مكالمات لم يُرد عليها):"})," إذا سجّل الفرع تقييمات سلبية (أقل من تقييم الفندق) أو فقدان فرص حجز نتيجة المكالمات التي لم يتم الرد عليها، يُخصم ",e.jsx("strong",{className:"text-[var(--adora-error)]",children:"10 ريال × عدد التقييمات السلبية للفرع"})," من صافي كل موظف في ذلك الفرع، ويُنقص نقاط التقييم."]})]})]})]}),e.jsxs("div",{className:"bg-[var(--adora-hover-bg)] rounded-xl p-4 border border-[var(--adora-border)]",children:[e.jsx("h4",{className:"text-base font-bold text-[var(--adora-accent)] mb-3",children:"2. كيف تُترجم النتيجة إلى نقاط ومستوى؟"}),e.jsxs("p",{className:"text-[var(--adora-text)] mb-3",children:[e.jsx("strong",{className:"text-[var(--adora-text)]",children:"مستوى الأداء"})," (ممتاز/جيد/سيء) يُحسب من نتيجة داخلية تُحوَّل إلى ",e.jsx("strong",{className:"text-[var(--adora-text)]",children:"نقاط من 0 إلى 100"}),"، ثم يُحدَّد المستوى حسب الجدول التالي:"]}),e.jsxs("ul",{className:"space-y-2 list-none",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-success)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-success)]",children:"ممتاز:"})," من 90 إلى 100 نقطة."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-success)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-success)]",children:"جيد:"})," من 80 إلى أقل من 90 نقطة."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-warning)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-warning)]",children:"متوسط:"})," من 60 إلى أقل من 80 نقطة."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-warning)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-warning)]",children:"ضعيف:"})," من 40 إلى أقل من 60 نقطة."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-[var(--adora-error)] font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-error)]",children:"سيء:"})," أقل من 40 نقطة."]})]})]})]}),e.jsxs("div",{className:"bg-[var(--adora-accent)]/5 rounded-xl p-4 border border-[var(--adora-border)]",children:[e.jsx("h4",{className:"text-base font-bold text-[var(--adora-accent)] mb-2",children:"3. ملخص سريع"}),e.jsxs("p",{className:"text-[var(--adora-text)]",children:[e.jsx("strong",{className:"text-[var(--adora-text)]",children:"النقاط"})," في الجدول = رصيد النقاط من الفترة (صافي + ",a.rewardPricing.supportFundPercent??15,"%). ",e.jsx("strong",{className:"text-[var(--adora-text)]",children:"مستوى الأداء"})," (ممتاز → سيء) يُبنى على أداء الحجوزات والتقييمات بالنسبة لباقي الموظفين، مع ",e.jsx("strong",{className:"text-[var(--adora-success)]",children:"مكافأة للحضور 26 يوم وأكثر"}),"، و",e.jsx("strong",{className:"text-[var(--adora-error)]",children:"تخفيض عند وجود خصم إداري أو خصم تقييم الفندق"}),". كلما كنت أقرب للأعلى وملتزماً بالحضور (وبلا خصم)، ارتفع مستوى أدائك إلى «ممتاز»."]})]})]}),e.jsx("div",{className:"px-6 py-3 border-t border-[var(--adora-border)] shrink-0 flex justify-end",children:e.jsx("button",{onClick:t,className:"px-4 py-2.5 rounded-lg text-sm font-bold text-[var(--adora-text)] hover:bg-[var(--adora-hover-bg)] transition-colors",children:"إغلاق"})})]})})}function Kn(){return typeof window>"u"?"/shared/conditions-content.json":((window.location.pathname||"").indexOf("/rewards")>=0?window.location.origin+"/rewards":window.location.origin)+"/shared/conditions-content.json"}const ct={turquoise:{wrap:"bg-[var(--adora-hover-bg)] rounded-xl p-4 border border-[var(--adora-focus-border)]",title:"text-[var(--adora-accent)]",bullet:"text-[var(--adora-accent)]"},amber:{wrap:"bg-[var(--adora-hover-bg)] rounded-xl p-4 border border-[var(--adora-focus-border)]",title:"text-[var(--adora-warning)]",bullet:"text-[var(--adora-warning)]"},yellow:{wrap:"bg-[var(--adora-hover-bg)] rounded-xl p-4 border border-[var(--adora-focus-border)]",title:"text-[var(--adora-warning)]",bullet:"text-[var(--adora-warning)]"},green:{wrap:"bg-[var(--adora-hover-bg)] rounded-xl p-4 border border-[var(--adora-focus-border)]",title:"text-[var(--adora-success)]",bullet:"text-[var(--adora-success)]"},orange:{wrap:"bg-[var(--adora-hover-bg)] rounded-xl p-4 border border-[var(--adora-focus-border)]",title:"text-[var(--adora-warning)]",bullet:"text-[var(--adora-warning)]"},red:{wrap:"rounded-xl p-4 border border-[var(--adora-border)] bg-[var(--adora-input-bg)]",title:"text-[var(--adora-error)]",bullet:"text-[var(--adora-error)]"}};function Oe(a,t){return a.replace(/\{\{rateMorning\}\}/g,String(t.rateMorning)).replace(/\{\{rateEvening\}\}/g,String(t.rateEvening)).replace(/\{\{rateNight\}\}/g,String(t.rateNight)).replace(/\{\{rateBooking\}\}/g,String(t.rateBooking)).replace(/\{\{rateContract\}\}/g,String(t.rateContract??200)).replace(/\{\{vipDescription\}\}/g,t.vipDescription??"حجوزات VIP — تُسعّر من خانات VIP (استقبال/بوكينج لكل غرفة)").replace(/\{\{rateEvalBooking\}\}/g,String(t.rateEvalBooking)).replace(/\{\{rateEvalGoogle\}\}/g,String(t.rateEvalGoogle)).replace(/\{\{minEvalCorniche\}\}/g,String(t.minEvalCorniche??8.7)).replace(/\{\{minEvalAndalus\}\}/g,String(t.minEvalAndalus??8.2)).replace(/\{\{minEvalGoogle\}\}/g,String(t.minEvalGoogle??4.3)).replace(/\{\{supportFundPercent\}\}/g,String(t.supportFundPercent??15))}function Wn(a,t){const n=a.rewardPricing,l=n.rateVipByBranch||{},s=n.rateVipDefault||{reception:0,booking:0},i=t.modalTitle,c=h=>h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");let b="<h1>"+c(i)+"</h1>";const u=(h,g,N,M)=>'<div class="'+h+'"'+(g?' style="'+g+'"':"")+"><h2>"+c(N)+"</h2><ul>"+M+"</ul></div>";return t.sections.forEach(h=>{if(h.id==="vip"){const _=Object.keys(l);if(_.length===0&&!(s.reception>0||s.booking>0))return;let A="";_.forEach(S=>{const w=l[S]||{},O=Object.keys(w);if(O.length===0)return;const T=O.map(E=>{const I=w[E];return"غرفة "+c(E)+" (استقبال: "+((I==null?void 0:I.reception)??0)+" ريال، بوكينج: "+((I==null?void 0:I.booking)??0)+" ريال)"});A+="<li><strong>"+c(S)+":</strong> "+T.join(" — ")+"</li>"}),(s.reception>0||s.booking>0)&&(A+="<li><strong>VIP افتراضي:</strong> استقبال: "+s.reception+" ريال، بوكينج: "+s.booking+" ريال لكل حجز</li>"),b+=u("section","background-color: rgba(245, 158, 11, 0.08); border-color: rgba(245, 158, 11, 0.4); border-right: 5px solid rgba(245, 158, 11, 0.6);",(h.icon||"")+" "+Oe(h.title||"",n),A);return}let g="";(h.items||[]).forEach(_=>{if(_.placeholder==="instructionsButton"){g+="<li>"+c(_.staticBefore||"")+".</li>";return}const A=_.template?Oe(_.template,n):_.static||"";g+="<li>"+(_.template&&_.template.includes("ريال")?"<strong>"+c(A)+"</strong>":c(A))+"</li>"});const N=h.theme==="orange"?"section":"section "+(h.theme==="turquoise"?"contracts":h.theme==="yellow"?"evaluations":h.theme==="green"?"attendance":h.theme==="red"?"discounts":""),M=h.theme==="orange"?"background-color: rgba(245, 158, 11, 0.08); border-color: rgba(245, 158, 11, 0.4); border-right: 5px solid rgba(245, 158, 11, 0.6);":h.theme==="amber"?"background-color: rgba(245, 158, 11, 0.06); border-color: rgba(245, 158, 11, 0.35); border-right: 5px solid rgba(245, 158, 11, 0.5);":"";b+=u(N,M,(h.icon||"")+" "+Oe(h.title||"",n),g)}),'<!DOCTYPE html><html dir="rtl" lang="ar"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>'+c(i)+'</title><style>@page { size: A4 portrait; margin: 10mm; } * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: "IBM Plex Sans Arabic", Arial, sans-serif; padding: 8px 12px; background: #fff; color: #111; line-height: 1.4; direction: rtl; font-size: 10px; } h1 { font-size: 16px; font-weight: 900; margin-bottom: 8px; text-align: center; border-bottom: 2px solid #0d9488; padding-bottom: 6px; } .section { margin-bottom: 8px; padding: 8px 12px; border-radius: 6px; border: 1px solid #e2e8f0; page-break-inside: avoid; } .section.contracts { background-color: rgba(59, 130, 246, 0.08); border-color: rgba(59, 130, 246, 0.35); border-right: 4px solid rgba(59, 130, 246, 0.6); } .section.evaluations { background-color: rgba(234, 179, 8, 0.08); border-color: rgba(234, 179, 8, 0.35); border-right: 4px solid rgba(234, 179, 8, 0.6); } .section.attendance { background-color: rgba(16, 185, 129, 0.08); border-color: rgba(16, 185, 129, 0.35); border-right: 4px solid rgba(16, 185, 129, 0.6); } .section.discounts { background-color: rgba(239, 68, 68, 0.08); border-color: rgba(239, 68, 68, 0.35); border-right: 4px solid rgba(239, 68, 68, 0.6); } h2 { font-size: 11px; font-weight: 800; margin: 0 0 6px 0; } ul { list-style: none; padding: 0; margin: 0; } li { font-size: 9.5px; font-weight: 600; margin: 4px 0; padding-right: 14px; position: relative; line-height: 1.4; text-align: right; } li::before { content: "•"; position: absolute; right: 0; top: 0; font-weight: 900; color: #0d9488; } @media print { body { padding: 4mm 6mm; } .conditions-one-page { page-break-after: avoid; page-break-inside: avoid; } }</style></head><body><div class="conditions-one-page">'+b+"</div></body></html>"}function Yn({config:a,onClose:t}){const[n,l]=y.useState(!1),[s,i]=y.useState(null),[c,b]=y.useState(!0),[u,h]=y.useState(null),g=a.rewardPricing,N=g.rateVipByBranch||{},M=g.rateVipDefault||{reception:0,booking:0},_=Object.keys(N);y.useEffect(()=>{let S=!1;return queueMicrotask(()=>{S||(b(!0),h(null))}),fetch(Kn()).then(w=>w.ok?w.json():Promise.reject(new Error("Not ok"))).then(w=>{S||(i(w),h(null))}).catch(w=>{S||h((w==null?void 0:w.message)||"تعذر تحميل محتوى الشروط. تأكد من توفر shared/conditions-content.json.")}).finally(()=>{S||b(!1)}),()=>{S=!0}},[]);const A=y.useCallback(()=>{if(!s)return;const S=Wn(a,s),w=window.open("","_blank");w&&(w.document.write(S),w.document.close(),w.focus(),setTimeout(()=>w.print(),300))},[a,s]);return c?e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/70 backdrop-blur-sm p-2 sm:p-4",onClick:t,children:e.jsx("div",{className:"bg-[var(--adora-modal-bg)] border border-[var(--adora-focus-border)] rounded-2xl max-w-2xl w-full p-8 text-center",onClick:S=>S.stopPropagation(),children:e.jsx("p",{className:"text-[var(--adora-text-secondary)]",children:"جاري تحميل الشروط..."})})}):u||!s?e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/70 backdrop-blur-sm p-2 sm:p-4",onClick:t,children:e.jsxs("div",{className:"bg-[var(--adora-modal-bg)] border border-[var(--adora-focus-border)] rounded-2xl max-w-2xl w-full p-8 text-center",onClick:S=>S.stopPropagation(),children:[e.jsx("p",{className:"text-[var(--adora-error)] py-4",children:u||"تعذر تحميل محتوى الشروط."}),e.jsx("button",{onClick:t,className:"px-4 py-2 rounded-lg text-sm font-bold text-[var(--adora-text-secondary)] bg-[var(--adora-hover-bg)]",children:"إغلاق"})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/70 backdrop-blur-sm p-2 sm:p-4",onClick:t,children:e.jsxs("div",{className:"bg-[var(--adora-modal-bg)] border border-[var(--adora-focus-border)] rounded-2xl modal-no-side-shadow max-w-2xl w-full max-h-[90vh] overflow-y-auto flex flex-col",onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-[var(--adora-border)] shrink-0 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-black text-[var(--adora-accent)] flex items-center gap-2",children:[e.jsx("span",{children:"📋"}),e.jsx("span",{children:s.modalTitle})]}),e.jsx("button",{onClick:t,className:"text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors text-2xl font-bold w-11 h-11 flex items-center justify-center rounded-lg hover:bg-[var(--adora-hover-bg)]",children:"×"})]}),e.jsx("div",{className:"px-6 py-5 space-y-4 text-sm text-[var(--adora-text-secondary)]",children:s.sections.map(S=>{if(S.id==="vip"){if(_.length===0&&!(M.reception>0||M.booking>0))return null;const T=ct[S.theme]||ct.amber;return e.jsxs("div",{className:T.wrap,children:[e.jsxs("h4",{className:"text-base font-bold mb-3 flex items-center gap-2 "+T.title,children:[e.jsx("span",{children:S.icon||""}),e.jsx("span",{children:Oe(S.title||"",g)})]}),e.jsxs("ul",{className:"space-y-2 list-none",children:[_.map(E=>{const I=N[E]||{},q=Object.keys(I);return q.length===0?null:e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:T.bullet+" font-bold",children:"•"}),e.jsxs("span",{children:[e.jsxs("strong",{className:"text-[var(--adora-warning)]",children:[E,":"]})," ",q.map(L=>{const z=I[L];return`غرفة ${L} (استقبال: ${(z==null?void 0:z.reception)??0} ريال، بوكينج: ${(z==null?void 0:z.booking)??0} ريال)`}).join(" — ")]})]},E)}),(M.reception>0||M.booking>0)&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:T.bullet+" font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{className:"text-[var(--adora-warning)]",children:"VIP افتراضي:"})," استقبال: ",M.reception," ريال، بوكينج: ",M.booking," ريال لكل حجز"]})]})]})]},S.id)}const w=ct[S.theme]||ct.turquoise,O=S.id==="points";return e.jsxs("div",{className:w.wrap,children:[e.jsxs("h4",{className:"text-base font-bold mb-3 flex items-center gap-2 "+w.title,children:[e.jsx("span",{children:S.icon||""}),e.jsx("span",{children:Oe(S.title||"",g)})]}),e.jsx("ul",{className:"space-y-2 list-none "+(O?"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-2":""),children:(S.items||[]).map((T,E)=>{if(T.placeholder==="instructionsButton")return e.jsxs("li",{className:"flex items-start gap-2 flex-wrap items-center",children:[e.jsx("span",{className:w.bullet+" font-bold",children:"•"}),e.jsx("span",{className:"text-[var(--adora-text-secondary)]",children:T.staticBefore}),e.jsx("button",{type:"button",onClick:L=>{L.stopPropagation(),l(!0)},className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-lg text-sm font-bold text-[var(--adora-accent)] bg-[var(--adora-hover-bg)] border border-[var(--adora-focus-border)] hover:bg-[var(--adora-active-bg)] transition-colors mt-1 sm:mt-0",children:"او اضغط هنا"})]},E);const I=T.template?Oe(T.template,g):T.static||"",q=T.template&&T.template.includes("ريال");return e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:w.bullet+" font-bold",children:"•"}),e.jsx("span",{children:q?e.jsx("strong",{className:"text-[var(--adora-text)]",children:I}):I})]},E)})})]},S.id)})}),e.jsxs("div",{className:"px-6 py-3 border-t border-[var(--adora-border)] shrink-0 flex justify-end gap-2",children:[e.jsxs("button",{type:"button",onClick:A,className:"px-4 py-2.5 rounded-lg text-sm font-bold text-[var(--adora-text-secondary)] hover:bg-[var(--adora-hover-bg)] transition-colors inline-flex items-center gap-2",children:[e.jsx(At,{className:"w-4 h-4"}),"طباعة الشروط"]}),e.jsx("button",{onClick:t,className:"px-4 py-2.5 rounded-lg text-sm font-bold text-[var(--adora-text-secondary)] hover:bg-[var(--adora-hover-bg)] transition-colors",children:"إغلاق"})]})]})}),n&&e.jsx(Qn,{onClose:()=>l(!1)})]})}function Jn(){if(typeof window>"u")return[];try{const a=localStorage.getItem("adora_rewards_discountTypes")||"[]",t=JSON.parse(a);return Array.isArray(t)?t.filter(n=>typeof n=="string"&&n.trim()!==""):[]}catch{return[]}}function Xn(a){return a.length===0?"":'<div class="bg-purple-500/10 rounded-xl p-4 border border-purple-500/30"><h4 class="text-purple-400 font-bold mb-2 text-base">أنواع خصم إضافية (أضافها المدير)</h4><p class="text-slate-400 text-sm mb-2">تظهر تلقائياً هنا عند إضافة المدير نوع خصم جديد من نافذة الخصومات.</p><ul class="space-y-2 text-slate-300 list-none">'+a.map(n=>'<li class="flex gap-2"><span class="text-purple-400">•</span><span>'+String(n).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")+"</span></li>").join("")+"</ul></div>"}function Zn(a,t){const n='<div class="space-y-5">'+a+(t||"")+"</div>",l=window.open("","_blank");if(!l)return;l.document.write('<!DOCTYPE html><html dir="rtl" lang="ar"><head><meta charset="UTF-8"><title>لائحة تعليمات وسياسات عمل موظفي الاستقبال</title><style>'+'@page{size:A4 portrait;margin:10mm}body{background:#fff!important;color:#111!important;padding:6mm 8mm;font-family:"IBM Plex Sans Arabic",Arial,sans-serif;font-size:10px;line-height:1.4}@media print{body{background:#fff!important;color:#111!important}.no-print{display:none!important}}'+'</style></head><body><h1 style="font-size:16px;font-weight:900;color:#111;margin-bottom:10px;text-align:center;border-bottom:2px solid #0d9488;padding-bottom:8px;">لائحة تعليمات وسياسات عمل موظفي الاستقبال</h1><div style="max-width:100%;margin:0 auto;font-size:10px;line-height:1.4;">'+n+"</div></body></html>"),l.document.close(),l.focus(),setTimeout(()=>{l.print()},400)}function Qn({onClose:a}){const t=Jn(),n=Xn(t),l=()=>{Zn(va,n)};return e.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/70 backdrop-blur-sm",onClick:a,children:e.jsxs("div",{className:"bg-[var(--adora-modal-bg)] border border-[var(--adora-border)] rounded-2xl modal-no-side-shadow max-w-2xl w-[95%] max-h-[90vh] flex flex-col overflow-hidden",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-[var(--adora-border)] bg-[var(--adora-modal-header-bg)] shrink-0 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-cyan-500/20 rounded-xl",children:e.jsx(Ea,{className:"w-5 h-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-[var(--adora-text)]",children:"لائحة تعليمات وسياسات عمل موظفي الاستقبال"}),e.jsx("p",{className:"text-[15px] text-[var(--adora-text-secondary)]",children:"لائحة موحدة — قائمة أنواع الخصم وطباعة اللائحة هنا"})]})]}),e.jsx("button",{onClick:a,className:"text-[var(--adora-text-secondary)] hover:text-[var(--adora-text)] transition-colors",children:e.jsx(Te,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"overflow-y-auto flex-1 px-6 py-5 space-y-6 text-base leading-relaxed max-w-3xl",children:[e.jsx("div",{className:"space-y-5",dangerouslySetInnerHTML:{__html:va}}),n?e.jsx("div",{className:"space-y-5",dangerouslySetInnerHTML:{__html:n}}):null]}),e.jsxs("div",{className:"px-6 py-3 border-t border-[var(--adora-border)] bg-[var(--adora-modal-header-bg)] shrink-0 flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("button",{onClick:l,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold text-cyan-400 bg-cyan-600/20 border border-cyan-500/30 hover:bg-cyan-600/30 transition-colors",children:[e.jsx(At,{className:"w-4 h-4"}),"طباعة اللائحة"]}),e.jsx("button",{onClick:a,className:"px-4 py-1.5 rounded-lg text-sm font-medium bg-cyan-600/20 text-cyan-300 hover:bg-cyan-600/30 border border-cyan-500/20 transition-colors",children:"فهمت"})]})]})})}const eo=["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"];function to(a){const t=a.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})[,\s]+(\d{1,2}):(\d{2})\s*(AM|PM)/i);if(!t)return"—";const n=parseInt(t[4],10),l=t[5],s=t[6].toUpperCase();let i=n;s==="PM"&&n!==12&&(i+=12),s==="AM"&&n===12&&(i=0);const c=new Date(parseInt(t[3]),parseInt(t[2])-1,parseInt(t[1])),b=eo[c.getDay()],u=i*60+parseInt(l);let h;u>=360&&u<960?h="صباح":u>=960?h="مساء":h="ليل";const g=`${n}:${l}`;return`${b} ${g} ${h}`}function ao({staffList:a,data:t,config:n,dateRange:l,logCreationShiftCounts:s}){const[i,c]=y.useState(!1),[b,u]=y.useState(!1),h=y.useMemo(()=>t.filter(o=>!o.isExcess),[t]),[g,N]=y.useState(null),[M,_]=y.useState("staffCount"),[A,S]=y.useState("desc"),w=y.useMemo(()=>{const o={};for(const[d,j]of Object.entries(n.branches))j.excluded||(o[d]=j.vipRooms);return o},[n]),O=y.useMemo(()=>{const o=new Set;for(const d of Object.values(n.branches))d.excluded||d.vipRooms.forEach(j=>o.add(j));return[...o].sort()},[n]),T=y.useCallback((o,d,j,f)=>{const p=h.filter(C=>C.employeeName===o&&C.branch===d);let m=[],v="";switch(j){case"استقبال":m=p.filter(C=>C.bookingSource==="استقبال"),v=`${o} — ${d} — استقبال`;break;case"بوكينج":m=p.filter(C=>C.bookingSource==="بوكينج"),v=`${o} — ${d} — بوكينج`;break;case"صباح":m=p.filter(C=>C.shift==="صباح"),v=`${o} — ${d} — صباح`;break;case"مساء":m=p.filter(C=>C.shift==="مساء"),v=`${o} — ${d} — مساء`;break;case"ليل":m=p.filter(C=>C.shift==="ليل"),v=`${o} — ${d} — ليل`;break;case"vip":m=p.filter(C=>{const k=_t(C.roomUnit),$=w[d]||[];return!k||!$.includes(k)?!1:f?k===f:!0}),v=`${o} — ${d} — VIP${f?" غ"+f:""}`;break;case"alert":m=p.filter(C=>C.priceShortfall>0),v=`${o} — ${d} — تنبيهات سعرية`;break;case"alertTotal":m=p.filter(C=>C.priceShortfall>0),v=`${o} — ${d} — تفاصيل النقص`;break;default:return}m.length!==0&&N({title:v,filterType:j,bookings:m.map(C=>({bookingNumber:C.bookingNumber,guestName:C.guestName,roomUnit:C.roomUnit,priceSAR:C.priceSAR,priceShortfall:C.priceShortfall,nights:C.nights,nightlyRate:C.nightlyRate,minPrice:C.minPrice,roomTypeLabel:C.roomTypeLabel,bookingSource:C.bookingSource,shift:C.shift,checkInTime:C.checkInTime,checkoutDateStr:C.checkoutDateStr,creationTime:C.creationTime,roomCategory:C.roomCategory,isMonthly:C.isMonthly,isMerged:C.isMerged,isRoomTransfer:C.isRoomTransfer}))})},[h]),E=y.useMemo(()=>{const o={};for(const f of a){const p=`${f.branch}|${f.name}`;o[p]=(o[p]||0)+f.bookingCount}const d={},j=(f,p,m)=>({name:f,branch:p,staffCount:m,counted:0,reportTotal:0,excess:0,استقبال:0,بوكينج:0,صباح:0,مساء:0,ليل:0,receptionMorning:0,receptionEvening:0,receptionNight:0,bookingRegular:0,vipRooms:Object.fromEntries(O.map(v=>[v,0])),vipTotal:0,vipBySource:{},vipMorning:0,vipEvening:0,vipNight:0,alertCount:0,alertTotal:0,mergedCount:0});for(const f of a){if(f.bookingCount===0)continue;const p=`${f.branch}|${f.name}`;d[p]||(d[p]=j(f.name,f.branch,o[p]||0))}for(const f of t){const p=`${f.branch}|${f.employeeName}`;d[p]||(d[p]=j(f.employeeName,f.branch,o[p]||0)),d[p].reportTotal++,f.isExcess&&d[p].excess++}for(const f of h){const p=`${f.branch}|${f.employeeName}`;if(!d[p])continue;const m=d[p],v=_t(f.roomUnit),C=w[f.branch]||[],k=!!(v&&C.includes(v));m.counted++,f.bookingSource==="استقبال"?m.استقبال++:f.bookingSource==="بوكينج"&&m.بوكينج++,f.shift==="صباح"?m.صباح++:f.shift==="مساء"?m.مساء++:m.ليل++,f.bookingSource==="استقبال"&&!k&&(f.shift==="صباح"?m.receptionMorning++:f.shift==="مساء"?m.receptionEvening++:m.receptionNight++),f.bookingSource==="بوكينج"&&!k&&m.bookingRegular++,k&&(m.vipTotal++,m.vipRooms[v]=(m.vipRooms[v]||0)+1,m.vipBySource[v]||(m.vipBySource[v]={reception:0,booking:0}),f.bookingSource==="استقبال"?m.vipBySource[v].reception++:f.bookingSource==="بوكينج"&&m.vipBySource[v].booking++,f.shift==="صباح"?m.vipMorning++:f.shift==="مساء"?m.vipEvening++:m.vipNight++),f.priceShortfall>0&&(m.alertCount++,m.alertTotal+=f.priceShortfall),f.isMerged&&m.mergedCount++}for(const f of Object.keys(d)){const p=d[f],m=p.staffCount,v=p.counted,C=s[f];if(C&&C.total>=m){let re=C.صباح,B=C.مساء,oe=C.ليل;if(C.total>m){const U=m/C.total;re=Math.round(C.صباح*U),B=Math.round(C.مساء*U),oe=m-re-B}if(p.صباح=re,p.مساء=B,p.ليل=oe,v<m){const U=p.استقبال;p.استقبال=Math.round(m*(U/v)),p.بوكينج=m-p.استقبال}continue}if(m<=0||v<=0||v===m)continue;const k=p.استقبال,$=p.صباح,F=p.مساء;p.استقبال=Math.round(m*(k/v)),p.بوكينج=m-p.استقبال,p.صباح=Math.round(m*($/v)),p.مساء=Math.round(m*(F/v)),p.ليل=m-p.صباح-p.مساء;const D=p.receptionMorning,K=p.receptionEvening,Y=p.receptionNight,te=p.bookingRegular,H=D+K+Y,Z=H+te;if(Z>0){const re=p.vipTotal,B=m-re;if(B>0){const oe=H/Z,U=Math.round(B*oe),J=B-U;H>0?(p.receptionMorning=Math.round(U*(D/H)),p.receptionEvening=Math.round(U*(K/H)),p.receptionNight=U-p.receptionMorning-p.receptionEvening):(p.receptionMorning=0,p.receptionEvening=0,p.receptionNight=U),p.bookingRegular=J}}}for(const f of Object.keys(d)){const p=d[f],m=p.staffCount;m<=0||(p.بوكينج=m-p.استقبال,p.ليل=m-p.صباح-p.مساء)}return Object.values(d)},[a,t,h,s,O,w]),I=y.useCallback(o=>{_(d=>d===o?(S(j=>j==="desc"?"asc":"desc"),o):(S("desc"),o))},[]),q=y.useMemo(()=>{const o=[...E],d=A==="desc"?-1:1;return o.sort((j,f)=>{let p,m;if(M==="name")return p=j.name,m=f.name,d*p.localeCompare(m,"ar");if(M==="branch")return p=j.branch,m=f.branch,d*p.localeCompare(m,"ar");if(M.startsWith("vip_")){const v=M.replace("vip_","");p=j.vipRooms[v]||0,m=f.vipRooms[v]||0}else p=j[M]??0,m=f[M]??0;return d*(p-m)}),o},[E,M,A]);if(!q.length)return null;const L=O.filter(o=>q.some(d=>(d.vipRooms[o]||0)>0)),z=()=>{c(!0),u(!1);const o={type:"ADORA_TRANSFER",rows:E.map(v=>({name:v.name,branch:v.branch,staffCount:v.staffCount,counted:v.counted,excess:v.excess,استقبال:v.استقبال,بوكينج:v.بوكينج,_reception:v.استقبال,_booking:v.بوكينج,صباح:v.صباح,مساء:v.مساء,ليل:v.ليل,_morning:v.صباح,_evening:v.مساء,_night:v.ليل,_receptionMorning:v.receptionMorning,_receptionEvening:v.receptionEvening,_receptionNight:v.receptionNight,_bookingRegular:v.bookingRegular,vipRooms:v.vipRooms,vipTotal:v.vipTotal,vipBySource:v.vipBySource,vipMorning:v.vipMorning,vipEvening:v.vipEvening,vipNight:v.vipNight,alertCount:v.alertCount,alertTotal:v.alertTotal,mergedCount:v.mergedCount})),rawBookings:h.map(v=>({employeeName:v.employeeName,branch:v.branch,bookingNumber:v.bookingNumber,guestName:v.guestName,roomUnit:v.roomUnit,priceSAR:v.priceSAR,priceShortfall:v.priceShortfall,nights:v.nights,nightlyRate:v.nightlyRate,minPrice:v.minPrice,roomTypeLabel:v.roomTypeLabel,bookingSource:v.bookingSource,shift:v.shift,checkInTime:v.checkInTime,checkoutDateStr:v.checkoutDateStr,creationTime:v.creationTime,roomCategory:v.roomCategory,isMonthly:v.isMonthly,isMerged:v.isMerged,isRoomTransfer:v.isRoomTransfer})),config:{branches:Object.fromEntries(Object.entries(n.branches).filter(([,v])=>!v.excluded).map(([v,C])=>[v,{vipRooms:C.vipRooms}])),rewardPricing:n.rewardPricing},activeVipRooms:L,period:l?{from:l.from,to:l.to}:null};try{localStorage.setItem("adora_transfer_payload",JSON.stringify(o))}catch(v){console.error("Failed to write transfer payload to localStorage:",v),c(!1),alert("خطأ في حفظ بيانات النقل. حاول مرة أخرى.");return}u(!0),setTimeout(()=>u(!1),3e3);const d=typeof window<"u"&&new URLSearchParams(window.location.search).get("admin")||"",j=Date.now(),f=d?`?admin=${encodeURIComponent(d)}&transfer=1&t=${j}`:`?transfer=1&t=${j}`,m=Math.max(150,400);setTimeout(()=>{window.location.href="/rewards/"+f},m)},G=E.reduce((o,d)=>{const j={staff:o.staff+d.staffCount,counted:o.counted+d.counted,excess:o.excess+d.excess,استقبال:o.استقبال+d.استقبال,بوكينج:o.بوكينج+d.بوكينج,صباح:o.صباح+d.صباح,مساء:o.مساء+d.مساء,ليل:o.ليل+d.ليل,vipTotal:o.vipTotal+d.vipTotal,vipRooms:{...o.vipRooms},alertCount:o.alertCount+d.alertCount,alertTotal:o.alertTotal+d.alertTotal};for(const f of L)j.vipRooms[f]=(j.vipRooms[f]||0)+(d.vipRooms[f]||0);return j},{staff:0,counted:0,excess:0,استقبال:0,بوكينج:0,صباح:0,مساء:0,ليل:0,vipTotal:0,vipRooms:Object.fromEntries(L.map(o=>[o,0])),alertCount:0,alertTotal:0});return e.jsxs("section",{className:"summary-section relative rounded-2xl overflow-hidden backdrop-blur-xl neon-glow table-section-no-side-shadow",children:[i&&e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70 backdrop-blur-md transition-opacity duration-300","aria-live":"polite",role:"status",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 rounded-2xl px-8 py-8 shadow-2xl border border-[var(--adora-focus-border)] bg-[var(--adora-card-bg)] min-w-[280px]",children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-[var(--adora-accent)] border-t-transparent animate-spin"}),e.jsx("p",{className:"text-[var(--adora-text)] font-bold text-base",children:"جاري التحويل إلى صفحة المكافآت..."}),e.jsx("p",{className:"text-[var(--adora-text-secondary)] text-sm",children:"سيتم فتح الصفحة خلال لحظات"})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/[0.03] via-transparent to-violet-500/[0.03] pointer-events-none"}),e.jsxs("div",{className:"relative px-5 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-sm font-bold text-[var(--adora-text)] flex items-center gap-2.5",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-gradient-to-br from-cyan-500/20 to-teal-500/20",children:e.jsx(Ls,{className:"w-4 h-4 text-[var(--adora-accent)]"})}),"ملخص المكافآت لكل موظف"]}),e.jsx("p",{className:"text-[15px] text-[var(--adora-text-secondary)] mt-1 mr-9",children:"فلتر مزدوج: تاريخ الإنشاء + تاريخ الدخول كلاهما داخل النطاق"})]}),e.jsx("button",{onClick:z,disabled:i,className:`flex items-center gap-2 px-7 py-3 rounded-xl text-sm font-bold transition-all duration-300 ${b?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 shadow-lg shadow-emerald-500/10":i?"bg-[var(--adora-active-bg)] text-[var(--adora-accent)] border border-[var(--adora-focus-border)] animate-pulse cursor-wait":"bg-[var(--adora-hover-bg)] text-[var(--adora-accent)] border border-[var(--adora-focus-border)] hover:bg-[var(--adora-active-bg)] hover:shadow-lg hover:scale-[1.02] active:scale-[0.98] cursor-pointer"}`,children:b?e.jsxs(e.Fragment,{children:[e.jsx(Mt,{className:"w-4 h-4"})," تم النقل"]}):i?e.jsxs(e.Fragment,{children:[e.jsx(ha,{className:"w-4 h-4 animate-bounce"})," جاري النقل..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ha,{className:"w-4 h-4"})," الانتقال إلى حساب المكافآت"]})})]}),e.jsx("div",{className:"relative overflow-x-auto",children:e.jsxs("table",{className:"text-sm w-full app-summary-table",children:[e.jsxs("thead",{children:[e.jsxs("tr",{children:[e.jsx("th",{colSpan:2,className:"py-2.5 bg-[var(--adora-table-header-bg)]"}),e.jsx("th",{colSpan:3,className:"py-2.5 text-center bg-[var(--adora-table-header-bg)] group-divider",children:e.jsx("span",{className:"inline-flex items-center gap-1.5 px-4 py-1 rounded-full text-[14px] font-bold tracking-wide badge-adora",children:"الحجوزات"})}),e.jsx("th",{colSpan:3,className:"py-2.5 text-center bg-[var(--adora-table-header-bg)] group-divider",children:e.jsx("span",{className:"inline-flex items-center gap-1.5 px-4 py-1 rounded-full text-[14px] font-bold tracking-wide badge-warning",children:"الشفتات"})}),L.length>0&&e.jsx("th",{colSpan:L.length,className:"py-2.5 text-center bg-[var(--adora-table-header-bg)] group-divider",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-4 py-1 rounded-full text-[14px] font-bold tracking-wide badge-warning",children:[e.jsx(Dt,{className:"w-3 h-3"}),"VIP"]})}),e.jsx("th",{colSpan:2,className:"py-2.5 text-center bg-[var(--adora-table-header-bg)] group-divider",children:e.jsx("span",{className:"inline-flex items-center gap-1 px-4 py-1 rounded-full text-[14px] font-bold tracking-wide badge-error",children:"تنبيهات"})})]}),e.jsxs("tr",{className:"border-b border-[var(--adora-border)]",children:[[{key:"name",label:"الموظف",cls:"px-3 py-2.5 text-right text-[15px] text-[var(--adora-text-secondary)] font-bold"},{key:"branch",label:"الفرع",cls:"px-3 py-2.5 text-right text-[15px] text-[var(--adora-text-secondary)] font-bold"},{key:"staffCount",label:"المرجع",cls:"px-3 py-2.5 text-center text-[15px] text-[var(--adora-accent)] font-bold bg-cyan-500/[0.04] group-divider-subtle"},{key:"استقبال",label:"استقبال",cls:"px-3 py-2.5 text-center text-[15px] text-[var(--adora-success)] font-medium bg-cyan-500/[0.04]"},{key:"بوكينج",label:"بوكينج",cls:"px-3 py-2.5 text-center text-[15px] text-[var(--adora-warning)] font-medium bg-cyan-500/[0.04]"},{key:"صباح",label:"صباح",cls:"px-3 py-2.5 text-center text-[15px] text-[var(--adora-warning)] font-medium bg-amber-500/[0.04] group-divider-subtle"},{key:"مساء",label:"مساء",cls:"px-3 py-2.5 text-center text-[15px] text-[var(--adora-text-secondary)] font-medium bg-amber-500/[0.04]"},{key:"ليل",label:"ليل",cls:"px-3 py-2.5 text-center text-[15px] text-[var(--adora-text-secondary)] font-medium bg-amber-500/[0.04]"}].map(o=>e.jsx("th",{onClick:()=>I(o.key),className:`${o.cls} cursor-pointer select-none hover:bg-[var(--adora-hover-bg)] transition-colors group/th`,children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.label,M===o.key?A==="desc"?e.jsx(Ee,{className:"w-3 h-3 opacity-80"}):e.jsx(dt,{className:"w-3 h-3 opacity-80"}):e.jsx(Ee,{className:"w-3 h-3 opacity-0 group-hover/th:opacity-30 transition-opacity"})]})},o.key)),L.map((o,d)=>e.jsx("th",{onClick:()=>I(`vip_${o}`),className:`px-2 py-2.5 text-center text-[15px] text-[var(--adora-warning)] font-bold bg-violet-500/[0.04] cursor-pointer select-none hover:bg-[var(--adora-hover-bg)] transition-colors group/th${d===0?" group-divider-subtle":""}`,children:e.jsxs("span",{className:"inline-flex items-center gap-0.5",children:[o,M===`vip_${o}`?A==="desc"?e.jsx(Ee,{className:"w-3 h-3 opacity-80"}):e.jsx(dt,{className:"w-3 h-3 opacity-80"}):e.jsx(Ee,{className:"w-3 h-3 opacity-0 group-hover/th:opacity-30 transition-opacity"})]})},o)),[{key:"alertCount",label:"تنبيه"},{key:"alertTotal",label:"نقص SAR"}].map((o,d)=>e.jsx("th",{onClick:()=>I(o.key),className:`px-2 py-2.5 text-center text-[15px] text-[var(--adora-error)] font-medium bg-red-500/[0.04] whitespace-nowrap cursor-pointer select-none hover:bg-[var(--adora-hover-bg)] transition-colors group/th${d===0?" group-divider-subtle":""}`,children:e.jsxs("span",{className:"inline-flex items-center gap-0.5",children:[o.label,M===o.key?A==="desc"?e.jsx(Ee,{className:"w-3 h-3 opacity-80"}):e.jsx(dt,{className:"w-3 h-3 opacity-80"}):e.jsx(Ee,{className:"w-3 h-3 opacity-0 group-hover/th:opacity-30 transition-opacity"})]})},o.key))]})]}),e.jsx("tbody",{children:q.map((o,d)=>e.jsxs("tr",{className:`group border-b border-white/[0.03] transition-all duration-200 hover:bg-white/[0.03] ${d%2===0?"":"bg-white/[0.01]"}`,children:[e.jsx("td",{className:"px-2 py-2 font-medium text-[var(--adora-text)] truncate text-sm",children:o.name}),e.jsx("td",{className:"px-2 py-2",children:e.jsx("span",{className:"inline-block px-2.5 py-0.5 rounded-full text-[14px] font-semibold badge-adora",children:o.branch})}),e.jsx("td",{className:"px-1.5 py-2 text-center bg-cyan-500/[0.03] group-divider-subtle",children:e.jsx("span",{className:"text-[var(--adora-accent)] font-mono font-bold text-sm",children:o.staffCount})}),e.jsx("td",{className:"px-1.5 py-2 text-center bg-cyan-500/[0.03]",children:o.استقبال>0?e.jsx("button",{onClick:()=>T(o.name,o.branch,"استقبال"),className:"font-mono text-[var(--adora-success)] hover:bg-[var(--adora-hover-bg)] px-1.5 py-0.5 rounded-md transition-all cursor-pointer text-sm",children:o.استقبال}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] font-mono text-sm",children:"0"})}),e.jsx("td",{className:"px-1.5 py-2 text-center bg-cyan-500/[0.03]",children:o.بوكينج>0?e.jsx("button",{onClick:()=>T(o.name,o.branch,"بوكينج"),className:"font-mono text-[var(--adora-warning)] hover:bg-[var(--adora-hover-bg)] px-1.5 py-0.5 rounded-md transition-all cursor-pointer text-sm",children:o.بوكينج}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] font-mono text-sm",children:"0"})}),e.jsx("td",{className:"px-1.5 py-2 text-center bg-amber-500/[0.03] group-divider-subtle",children:o.صباح>0?e.jsx("button",{onClick:()=>T(o.name,o.branch,"صباح"),className:"font-mono text-[var(--adora-warning)] hover:bg-[var(--adora-hover-bg)] px-1.5 py-0.5 rounded-md transition-all cursor-pointer text-sm",children:o.صباح}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] font-mono text-sm",children:"0"})}),e.jsx("td",{className:"px-1.5 py-2 text-center bg-amber-500/[0.03]",children:o.مساء>0?e.jsx("button",{onClick:()=>T(o.name,o.branch,"مساء"),className:"font-mono text-[var(--adora-accent)] hover:bg-[var(--adora-hover-bg)] px-1.5 py-0.5 rounded-md transition-all cursor-pointer text-sm",children:o.مساء}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] font-mono text-sm",children:"0"})}),e.jsx("td",{className:"px-1.5 py-2 text-center bg-amber-500/[0.03]",children:o.ليل>0?e.jsx("button",{onClick:()=>T(o.name,o.branch,"ليل"),className:"font-mono text-[var(--adora-text)] hover:bg-[var(--adora-hover-bg)] px-1.5 py-0.5 rounded-md transition-all cursor-pointer text-sm",children:o.ليل}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] font-mono text-sm",children:"0"})}),L.map((j,f)=>{const p=o.vipRooms[j]||0,v=(w[o.branch]||[]).includes(j);return e.jsx("td",{className:`px-1.5 py-2 text-center bg-violet-500/[0.03]${f===0?" group-divider-subtle":""}`,children:v?p>0?e.jsx("button",{onClick:()=>T(o.name,o.branch,"vip",j),className:"font-mono font-bold text-sm text-[var(--adora-warning)] hover:bg-[var(--adora-hover-bg)] px-2 py-0.5 rounded-md transition-all cursor-pointer",children:p}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] font-mono text-sm",children:"0"}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] text-sm",children:"—"})},j)}),e.jsx("td",{className:"px-1.5 py-2 text-center bg-red-500/[0.02] group-divider-subtle",children:o.alertCount>0?e.jsx("button",{onClick:()=>T(o.name,o.branch,"alert"),className:"font-mono font-bold text-sm text-[var(--adora-error)] hover:bg-[var(--adora-hover-bg)] px-1.5 py-0.5 rounded-md transition-all cursor-pointer",children:o.alertCount}):e.jsx("span",{className:"text-[var(--adora-success)] text-sm",children:"✓"})}),e.jsx("td",{className:"px-1.5 py-2 text-center bg-red-500/[0.02]",children:o.alertTotal>0?e.jsx("button",{onClick:()=>T(o.name,o.branch,"alertTotal"),className:"font-mono font-bold text-sm text-[var(--adora-error)] hover:bg-[var(--adora-hover-bg)] px-1.5 py-0.5 rounded-md transition-all cursor-pointer",children:Math.round(o.alertTotal).toLocaleString("en-SA")}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] text-sm",children:"—"})})]},`${o.branch}-${o.name}`))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-[var(--adora-table-header-bg)] backdrop-blur-sm",children:[e.jsx("td",{className:"px-2 py-2.5 text-[var(--adora-text)] text-sm font-bold",colSpan:2,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-[var(--adora-accent)] animate-pulse"}),"الإجمالي"]})}),e.jsx("td",{className:"px-1.5 py-2.5 text-center bg-cyan-500/[0.06] group-divider-subtle",children:e.jsx("span",{className:"text-[var(--adora-accent)] font-mono font-bold text-sm",children:G.staff})}),e.jsx("td",{className:"px-1.5 py-2.5 text-center bg-cyan-500/[0.06]",children:e.jsx("span",{className:"text-[var(--adora-success)] font-mono font-semibold text-sm",children:G.استقبال})}),e.jsx("td",{className:"px-1.5 py-2.5 text-center bg-cyan-500/[0.06]",children:e.jsx("span",{className:"text-[var(--adora-warning)] font-mono font-semibold text-sm",children:G.بوكينج})}),e.jsx("td",{className:"px-1.5 py-2.5 text-center bg-amber-500/[0.06] group-divider-subtle",children:e.jsx("span",{className:"text-[var(--adora-warning)] font-mono font-semibold text-sm",children:G.صباح})}),e.jsx("td",{className:"px-1.5 py-2.5 text-center bg-amber-500/[0.06]",children:e.jsx("span",{className:"text-[var(--adora-accent)] font-mono font-semibold text-sm",children:G.مساء})}),e.jsx("td",{className:"px-1.5 py-2.5 text-center bg-amber-500/[0.06]",children:e.jsx("span",{className:"text-[var(--adora-text)] font-mono font-semibold text-sm",children:G.ليل})}),L.map((o,d)=>e.jsx("td",{className:`px-1.5 py-2.5 text-center bg-violet-500/[0.06]${d===0?" group-divider-subtle":""}`,children:e.jsx("span",{className:"text-[var(--adora-warning)] font-mono font-bold text-sm",children:G.vipRooms[o]||0})},o)),e.jsx("td",{className:"px-1.5 py-2.5 text-center bg-red-500/[0.04] group-divider-subtle",children:G.alertCount>0?e.jsx("span",{className:"inline-flex items-center justify-center min-w-[24px] px-1.5 py-0.5 rounded-full text-sm font-bold badge-error",children:G.alertCount}):e.jsx("span",{className:"text-[var(--adora-success)] text-sm",children:"✓"})}),e.jsx("td",{className:"px-2 py-3.5 text-center bg-red-500/[0.04]",children:G.alertTotal>0?e.jsx("span",{className:"text-[var(--adora-error)] font-mono font-semibold text-sm",children:Math.round(G.alertTotal).toLocaleString("en-SA")}):e.jsx("span",{className:"text-[var(--adora-text-secondary)] text-sm",children:"—"})})]})})]})}),g&&(()=>{const o=g.bookings.reduce((m,v)=>m+v.priceSAR,0),d=g.bookings.reduce((m,v)=>m+v.priceShortfall,0),j=g.bookings.reduce((m,v)=>m+v.nights,0),f=g.bookings.some(m=>m.priceShortfall>0),p=g.bookings.some(m=>m.isRoomTransfer);return wr.createPortal(e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:()=>N(null),children:e.jsxs("div",{className:`bg-[var(--adora-modal-bg)] border border-[var(--adora-border)] rounded-2xl modal-no-side-shadow
                         max-w-3xl w-[95%] max-h-[80vh] flex flex-col overflow-hidden`,onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"px-5 py-3 border-b border-[var(--adora-border)] flex items-center justify-between shrink-0 bg-[var(--adora-modal-header-bg)]",children:[e.jsx("h3",{className:"text-sm font-semibold text-[var(--adora-text)]",children:g.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{const m=window.open("","_blank");if(!m)return;const v=g.bookings,C=Math.round(o).toLocaleString("en-SA"),k=Math.round(d).toLocaleString("en-SA"),$=v.filter(D=>D.priceShortfall>0),F=v.filter(D=>D.isRoomTransfer);m.document.write(`<!DOCTYPE html><html dir="rtl" lang="ar"><head><meta charset="utf-8">
                      <title>تقرير فروقات الأسعار — ${g.title}</title>
                      <style>
                        *{margin:0;padding:0;box-sizing:border-box}
                        body{font-family:'IBM Plex Sans Arabic','Segoe UI',Tahoma,sans-serif;font-size:11px;color:#111;padding:20px 30px;background:#fff;direction:rtl;line-height:1.35}
                        h1{font-size:16px;text-align:center;margin-bottom:8px;color:#0f172a;padding-bottom:6px;border-bottom:2px solid #0d9488}
                        .sub{text-align:center;color:#64748b;font-size:10px;margin-bottom:12px}
                        .summary{display:flex;gap:20px;justify-content:center;margin-bottom:14px;font-size:11px;flex-wrap:wrap}
                        .summary span{background:#f1f5f9;padding:3px 10px;border-radius:4px}
                        .summary .alert{background:#fef2f2;color:#dc2626}
                        .summary .transfer{background:#eff6ff;color:#2563eb}
                        table{width:100%;border-collapse:collapse;margin-bottom:14px}
                        th{background:#ccfbf1;border:1px solid #99f6e4;padding:4px 6px;text-align:right;font-size:10px;color:#0f766e;white-space:nowrap}
                        td{border:1px solid #e2e8f0;padding:3px 6px;font-size:10px;white-space:nowrap}
                        .mono{font-family:Consolas,'Courier New',monospace}
                        .num{text-align:left;direction:ltr}
                        .red{color:#dc2626;font-weight:700}
                        .green{color:#16a34a}
                        .blue{color:#2563eb}
                        .badge{display:inline-block;padding:1px 5px;border-radius:3px;font-size:9px;font-weight:700;margin-inline-start:3px}
                        .b-recv{background:#dcfce7;color:#166534}.b-book{background:#ffedd5;color:#9a3412}
                        .b-vip{background:#f3e8ff;color:#7c3aed}.b-merge{background:#cffafe;color:#0e7490}
                        .b-monthly{background:#fae8ff;color:#a21caf}.b-transfer{background:#dbeafe;color:#1d4ed8}
                        .row-alert{background:#fef2f2}.row-transfer{background:#eff6ff}
                        .footer{text-align:center;color:#94a3b8;font-size:9px;margin-top:20px;border-top:1px solid #e2e8f0;padding-top:8px}
                        @media print{body{padding:10px 15px}@page{size:A4 landscape;margin:10mm}thead{display:table-header-group}}
                      </style></head><body>
                      <h1>تقرير فروقات الأسعار</h1>
                      <div class="sub">${g.title} | ${new Date().toLocaleDateString("ar-SA")}</div>
                      <div class="summary">
                        <span><b>${v.length}</b> حجز</span>
                        <span><b>${j}</b> ليلة</span>
                        <span>إيجار: <b class="mono">${C}</b> ر.س</span>
                        ${$.length>0?`<span class="alert"><b>${$.length}</b> تنبيه | نقص: <b class="mono">${k}</b> ر.س</span>`:'<span class="green">✓ لا يوجد نقص</span>'}
                        ${F.length>0?`<span class="transfer">↔ ${F.length} نقل غرفة</span>`:""}
                      </div>
                      <table>
                        <thead><tr>
                          <th>#</th><th>رقم الحجز</th><th>العميل</th><th>الغرفة</th><th>التصنيف</th>
                          <th>المصدر</th><th>الوردية</th><th>الدخول</th><th>الخروج</th><th>ليالي</th>
                          <th>الإيجار</th><th>سعر/ل</th><th>حد أدنى/ل</th><th>المتوقع</th><th>النقص</th><th>ملاحظات</th>
                        </tr></thead>
                        <tbody>${v.map((D,K)=>{const Y=D.minPrice*D.nights,te=[];D.bookingSource==="استقبال"?te.push('<span class="badge b-recv">استقبال</span>'):D.bookingSource==="بوكينج"&&te.push('<span class="badge b-book">بوكينج</span>'),D.roomCategory==="VIP"&&te.push('<span class="badge b-vip">VIP</span>'),D.isMerged&&te.push('<span class="badge b-merge">دمج</span>'),D.isMonthly&&te.push('<span class="badge b-monthly">شهري</span>'),D.isRoomTransfer&&te.push('<span class="badge b-transfer">نقل غرفة</span>');const H=D.priceShortfall>0?"row-alert":D.isRoomTransfer?"row-transfer":"",W=D.isRoomTransfer?'<td class="blue">مستبعد</td>':D.priceShortfall>0?`<td class="num mono red">▼ ${Math.round(D.priceShortfall).toLocaleString("en-SA")}</td>`:'<td class="green">✓</td>',Z=D.isRoomTransfer?"نقل بين غرفتين — لا يمكن تقسيم السعر":D.priceShortfall>0?`${D.minPrice}×${D.nights}=${Y.toLocaleString("en-SA")} − ${D.priceSAR.toLocaleString("en-SA")} = ${Math.round(D.priceShortfall).toLocaleString("en-SA")}`:"";return`<tr class="${H}">
                            <td>${K+1}</td>
                            <td class="mono">${D.bookingNumber}</td>
                            <td>${D.guestName||"—"}</td>
                            <td>${D.roomUnit||"—"}</td>
                            <td>${D.roomTypeLabel||"—"} ${te.join("")}</td>
                            <td>${D.bookingSource}</td>
                            <td>${D.shift}</td>
                            <td class="mono">${D.checkInTime||"—"}</td>
                            <td class="mono">${D.checkoutDateStr||"—"}</td>
                            <td class="num mono">${D.nights}</td>
                            <td class="num mono">${D.priceSAR>0?D.priceSAR.toLocaleString("en-SA"):"—"}</td>
                            <td class="num mono">${D.nightlyRate>0?D.nightlyRate.toLocaleString("en-SA"):"—"}</td>
                            <td class="num mono">${D.minPrice>0?D.minPrice.toLocaleString("en-SA"):"—"}</td>
                            <td class="num mono">${Y>0?Y.toLocaleString("en-SA"):"—"}</td>
                            ${W}
                            <td style="font-size:9px;color:#64748b">${Z}</td>
                          </tr>`}).join("")}</tbody>
                        <tfoot><tr style="font-weight:700;background:#f8fafc">
                          <td colspan="9">الإجمالي</td>
                          <td class="num mono">${j}</td>
                          <td class="num mono">${C}</td>
                          <td colspan="3"></td>
                          <td class="num mono red">${d>0?k:"✓"}</td>
                          <td></td>
                        </tr></tfoot>
                      </table>
                      <div class="footer">
                        نظام Adora لتحليل الحجوزات | تم الإنشاء ${new Date().toLocaleString("ar-SA")} | هذا التقرير للأغراض المحاسبية الداخلية فقط
                      </div>
                    </body></html>`),m.document.close(),setTimeout(()=>m.print(),300)},className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm
                               bg-slate-700/50 text-slate-300 hover:bg-slate-600/50 hover:text-slate-100
                               border border-slate-600/30 transition-colors`,children:[e.jsx(At,{className:"w-3.5 h-3.5"}),"طباعة"]}),e.jsx("button",{onClick:()=>N(null),className:"text-slate-500 hover:text-slate-200 transition-colors",children:e.jsx(Te,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"px-5 py-2.5 border-b border-slate-800/50 shrink-0 flex flex-wrap gap-4 text-sm",children:[e.jsxs("span",{className:"text-slate-400",children:[e.jsx("span",{className:"text-slate-200 font-bold",children:g.bookings.length})," حجز"]}),e.jsxs("span",{className:"text-slate-400",children:[e.jsx("span",{className:"text-slate-200 font-bold",children:j})," ليلة"]}),e.jsxs("span",{className:"text-slate-400",children:["إجمالي الإيجار: ",e.jsx("span",{className:"text-emerald-400 font-bold font-mono",children:Math.round(o).toLocaleString("en-SA")})," ريال"]}),f&&e.jsxs("span",{className:"text-[var(--adora-error)]",children:["نقص: ",e.jsx("span",{className:"font-bold font-mono",children:Math.round(d).toLocaleString("en-SA")})," ريال"]}),p&&e.jsx("span",{className:"text-blue-400",children:"↔ نقل غرفة"})]}),e.jsx("div",{className:"overflow-y-auto flex-1 p-3 space-y-2",children:g.bookings.map((m,v)=>e.jsxs("div",{className:`rounded-xl border p-3 transition-colors ${m.priceShortfall>0?"bg-red-950/20 border-red-500/20":m.isRoomTransfer?"bg-blue-950/20 border-blue-500/20":"bg-slate-800/30 border-slate-700/30 hover:bg-slate-800/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-slate-600 text-sm w-5 shrink-0",children:v+1}),e.jsx("span",{className:"text-slate-100 font-mono font-bold text-sm",children:m.bookingNumber}),e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[14px] font-bold ${m.bookingSource==="استقبال"?"bg-emerald-500/15 text-emerald-400 border border-emerald-500/20":m.bookingSource==="بوكينج"?"bg-orange-500/15 text-orange-400 border border-orange-500/20":"bg-slate-500/15 text-slate-400 border border-slate-500/20"}`,children:m.bookingSource}),e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[14px] font-bold ${m.shift==="صباح"?"bg-amber-500/15 text-amber-400 border border-amber-500/20":m.shift==="مساء"?"bg-indigo-500/15 text-indigo-400 border border-indigo-500/20":"bg-slate-500/15 text-slate-400 border border-slate-500/20"}`,children:m.shift}),m.roomCategory==="VIP"&&e.jsxs("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold bg-violet-500/15 text-violet-400 border border-violet-500/20",children:[e.jsx(Dt,{className:"w-3 h-3 inline -mt-0.5 ml-0.5"}),"VIP"]}),m.isMerged&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold bg-cyan-500/15 text-cyan-400 border border-cyan-500/20",children:"دمج"}),m.isMonthly&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold bg-purple-500/15 text-purple-400 border border-purple-500/20",children:"شهري"}),m.isRoomTransfer&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[14px] font-bold bg-blue-500/15 text-blue-400 border border-blue-500/20",children:"↔ نقل غرفة"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-x-4 gap-y-1.5 text-sm mr-7",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"العميل"}),e.jsx("span",{className:"text-slate-300 truncate block",children:m.guestName||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"الغرفة"}),e.jsx("span",{className:"text-slate-300 truncate block",children:m.roomUnit||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"التصنيف"}),e.jsx("span",{className:"text-slate-300",children:m.roomTypeLabel||"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"الفترة"}),e.jsxs("span",{className:"text-slate-300 font-mono",children:[m.checkInTime||"—",m.checkoutDateStr?` → ${m.checkoutDateStr}`:""]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"وقت التسجيل"}),e.jsx("span",{className:"text-cyan-300 font-mono font-bold",children:to(m.creationTime)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"الليالي"}),e.jsx("span",{className:"text-slate-200 font-mono font-bold",children:m.nights})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"الإيجار الكلي"}),e.jsx("span",{className:"text-emerald-400 font-mono font-bold",children:m.priceSAR>0?m.priceSAR.toLocaleString("en-SA"):"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"سعر الليلة"}),e.jsx("span",{className:"text-slate-200 font-mono",children:m.nightlyRate>0?m.nightlyRate.toLocaleString("en-SA"):"—"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 block",children:"الحد الأدنى/ل"}),e.jsx("span",{className:"text-slate-400 font-mono",children:m.minPrice>0?m.minPrice.toLocaleString("en-SA"):"—"})]})]}),m.priceShortfall>0&&e.jsxs("div",{className:"mt-2 mr-7 px-2.5 py-1.5 rounded-lg bg-red-500/10 border border-red-500/15 flex items-center gap-2 text-sm",children:[e.jsx(mt,{className:"w-3.5 h-3.5 text-[var(--adora-error)] shrink-0"}),e.jsxs("span",{className:"text-red-300",children:["النقص: ",e.jsx("span",{className:"font-mono font-bold text-[var(--adora-error)]",children:Math.round(m.priceShortfall).toLocaleString("en-SA")})," ريال",e.jsxs("span",{className:"text-[var(--adora-error)]/60 mr-2",children:["(",m.minPrice," × ",m.nights," = ",(m.minPrice*m.nights).toLocaleString("en-SA")," − ",m.priceSAR.toLocaleString("en-SA")," = ",Math.round(m.priceShortfall).toLocaleString("en-SA"),")"]})]})]}),m.isRoomTransfer&&e.jsx("div",{className:"mt-2 mr-7 px-2.5 py-1.5 rounded-lg bg-blue-500/10 border border-blue-500/15 flex items-center gap-2 text-sm",children:e.jsx("span",{className:"text-blue-300",children:"↔ تم نقل النزيل بين غرفتين — التنبيه السعري مستبعد (لا يمكن تقسيم السعر بدقة)"})})]},`${m.bookingNumber}-${v}`))})]})}),document.body)})()]})}kr.createRoot(document.getElementById("root")).render(e.jsx(y.StrictMode,{children:e.jsx(Un,{})}));export{Vs as F};
